var DlhSoft;
"undefined" === typeof DlhSoft && (DlhSoft = {assemblies: [], buildReleaseDate: new Date(1, 0, 1)});
DlhSoft.assemblies.push({
  assembly: "DlhSoft.ProjectData.GanttChart.HTML.Controls",
  company: "DlhSoft",
  product: "Project Data Modern Library",
  version: "5.2.2.5",
  copyright: "Copyright \u00a9 2012-2014 DlhSoft",
  title: "Project Data Gantt Chart HTML Controls",
  description: "Project Data Gantt Chart related HTML client components"
});
DlhSoft.buildReleaseDate = function (I, L, P) {
  I = new Date(I, L - 1, P);
  return I > DlhSoft.buildReleaseDate ? I : DlhSoft.buildReleaseDate
}(2014, 3, 21);
var _0x5c25 = "Licensing{undefined{string{DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.{.{length{license{push{type{content{:{lastIndexOf{substr{buildReleaseDate{charCodeAt{pow{toUpperCase{DlhSoft Component Licensing Warning{http://DlhSoft.com/Purchase.aspx{?Assemblies={,{http://www.componentsource.com/features/dlhsoft{ (version {){This component is currently licensed to be used for testing purposes only{The component is part of this assembly{To purchase a standard license for a product that includes this assembly you can use the Purchase page{ownerDocument{div{createElement{style{position: absolute; left: 24px; top: 24px; width: 480px; display: block; z-index: 1; color: Black; background-color: #ffffc0; border: solid 1px Blue; overflow: auto{setAttribute{padding: 6px; padding-top: 8px; font-family: Arial; font-size: small{font-weight: bold; margin-bottom: 4px{appendChild{createTextNode{color: Red; margin-top: 2px; margin-bottom: 2px{margin-top: 4px{a{color: Blue; text-decoration: underline{href{target{_blank{Purchase license{margin-left: 4px; color: Blue; text-decoration: underline{javascript://{Continue trial{click{removeChild{addEventListener{\n\n{: {:\n".split("{");
void 0 == DlhSoft[_0x5c25[0]] && (DlhSoft[_0x5c25[0]] = function () {
  var I = _0x5c25[1], L = _0x5c25[2], P = [], T = [], ka = _0x5c25[3], ca = function (R, H) {
    if (typeof R !== L || typeof H !== L) return !1;
    if (H == ka) return !0;
    var S = H[_0x5c25[11]](_0x5c25[10]);
    if (0 <= S) {
      var M = H[_0x5c25[12]](0, S), z, E = M[_0x5c25[11]](_0x5c25[10]);
      if (0 <= E) try {
        z = new Date(parseInt(M[_0x5c25[12]](E + 1)))
      } catch (N) {
      }
      typeof z === I && (z = new Date(2013, 11, 31));
      if (DlhSoft[_0x5c25[13]] > z) return !1;
      M = M + _0x5c25[10] + R;
      for (i = z = 0; i < M[_0x5c25[5]]; i++) E = M[_0x5c25[14]](i), z = (z <<
        5) - z + E, z &= z;
      0 > z && (z = Math[_0x5c25[15]](2, 32) - z);
      M = z.toString(16)[_0x5c25[16]]();
      S = H[_0x5c25[12]](S + 1);
      if (M == S) return !0
    }
    return !1
  }, V = function (R, H, S, M, z) {
    var E = _0x5c25[17], N = _0x5c25[18],
      L = typeof ComponentSource === I || !ComponentSource ? N + _0x5c25[19] + M + _0x5c25[20] + z : _0x5c25[21],
      P = M + _0x5c25[22] + z + _0x5c25[23], h = _0x5c25[24], l = _0x5c25[25], k = _0x5c25[26];
    setTimeout(function () {
      var r = R[_0x5c25[27]], j = r[_0x5c25[29]](_0x5c25[28]);
      j[_0x5c25[32]](_0x5c25[30], _0x5c25[31]);
      var s = r[_0x5c25[29]](_0x5c25[28]);
      s[_0x5c25[32]](_0x5c25[30],
        _0x5c25[33]);
      var q = r[_0x5c25[29]](_0x5c25[28]);
      q[_0x5c25[32]](_0x5c25[30], _0x5c25[34]);
      s[_0x5c25[35]](q);
      q[_0x5c25[35]](r[_0x5c25[36]](E));
      s[_0x5c25[35]](r[_0x5c25[36]](h + _0x5c25[10]));
      q = r[_0x5c25[29]](_0x5c25[28]);
      q[_0x5c25[32]](_0x5c25[30], _0x5c25[37]);
      q[_0x5c25[35]](r[_0x5c25[36]](H));
      s[_0x5c25[35]](q);
      s[_0x5c25[35]](r[_0x5c25[36]](l + _0x5c25[10]));
      q = r[_0x5c25[29]](_0x5c25[28]);
      q[_0x5c25[32]](_0x5c25[30], _0x5c25[37]);
      q[_0x5c25[35]](r[_0x5c25[36]](P));
      s[_0x5c25[35]](q);
      s[_0x5c25[35]](r[_0x5c25[36]](k +
        _0x5c25[10]));
      q = r[_0x5c25[29]](_0x5c25[28]);
      q[_0x5c25[32]](_0x5c25[30], _0x5c25[38]);
      var w = r[_0x5c25[29]](_0x5c25[39]);
      w[_0x5c25[32]](_0x5c25[30], _0x5c25[40]);
      w[_0x5c25[32]](_0x5c25[41], L);
      w[_0x5c25[32]](_0x5c25[42], _0x5c25[43]);
      w[_0x5c25[35]](r[_0x5c25[36]](_0x5c25[44]));
      q[_0x5c25[35]](w);
      w = r[_0x5c25[29]](_0x5c25[39]);
      w[_0x5c25[32]](_0x5c25[30], _0x5c25[45]);
      w[_0x5c25[32]](_0x5c25[41], _0x5c25[46]);
      w[_0x5c25[35]](r[_0x5c25[36]](_0x5c25[47]));
      w[_0x5c25[50]](_0x5c25[48], function () {
          R[_0x5c25[49]](j);
          T[_0x5c25[7]](S)
        },
        !1);
      q[_0x5c25[35]](w);
      s[_0x5c25[35]](q);
      j[_0x5c25[35]](s);
      R[_0x5c25[35]](j)
    }, 0);
    setTimeout(function () {
      alert(E + _0x5c25[51] + h + _0x5c25[52] + H + _0x5c25[51] + l + _0x5c25[53] + P + _0x5c25[51] + k + _0x5c25[4])
    }, 6E5)
  };
  return {
    setLicense: function (L, H) {
      P[_0x5c25[7]]({type: L, content: H})
    }, validate: function (R, H, S, M, z, E, N) {
      for (var H = H + _0x5c25[4] + S, U = 0; U < T[_0x5c25[5]]; U++) if (T[U] == H) return;
      a:if (typeof E !== L && typeof N !== I && (N[_0x5c25[6]] !== I && (E = N[_0x5c25[6]]), typeof N === L && (E = N)), typeof E !== L) for (N = 0; N < P[_0x5c25[5]]; N++) if (U =
        P[N], U[_0x5c25[8]] == H && typeof U[_0x5c25[9]] === L) {
        E = U[_0x5c25[9]];
        break a
      }
      ca(H, E) ? R[_0x5c25[6]] = E : V(R, S, H, M, z)
    }
  }
}());
void 0 == DlhSoft.Controls && (DlhSoft.Controls = {});
void 0 == DlhSoft.Controls.GanttChartView && (DlhSoft.Controls.GanttChartView = function () {
  var I = ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],
    L = ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],
    P = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31], T = new Date(2592E5), ka = new Date(3155762592E5),
    ca = function (a, d, b, c) {
      if (typeof a.ownerDocument.createElementNS === "undefined" || typeof a.ownerDocument.addEventListener === "undefined") alert("The required HTML5 features are not supported by the application host. Some features will be unavailable. Consider upgrading.");
      else {
        var e = ["DlhSoft.Controls", "GanttChartView", "DlhSoft.ProjectData.GanttChart.HTML.Controls", "5", "validate", "Licensing"];
        DlhSoft[e[5]][e[4]](a, e[0], e[1], e[2], e[3], c, b);
        a.isInitializing = true;
        typeof a.settings !== "undefined" && typeof a.settings.toggleButtonAreaWidth !== "undefined" && delete a.settings.toggleButtonAreaWidth;
        if (typeof a.items !== "undefined") for (c = 0; c < a.items.length; c++) delete a.items[c].successors;
        typeof b !== "object" && (b = {});
        S(d, b);
        H(b, d, a);
        fc(a, d, b);
        c = b.columns;
        e = b.scales;
        gc(c, a, b);
        Ka(d,
          a);
        La(d, b, a);
        typeof b.visibilityFilter !== "undefined" && hc(d, b.visibilityFilter);
        var f = M(a, d, b), g = a.ownerDocument, m = g.createElement("div");
        m.setAttribute("style", "font-family: Arial; font-size: small; overflow: auto");
        var o = g.createElement("div");
        typeof b.containerClass !== "undefined" && o.setAttribute("class", b.containerClass);
        typeof b.containerStyle !== "undefined" && o.setAttribute("style", b.containerStyle);
        m.appendChild(o);
        var n = g.createElement("div");
        n.setAttribute("style", "border: solid 1px " + b.border +
          "; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; overflow: auto");
        o.appendChild(n);
        var p = g.createElement("div");
        p.setAttribute("style", "overflow: auto; float: left; border-right: solid 1px " + b.border + "; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; width: " + b.gridWidth);
        b.isGridVisible && n.appendChild(p);
        var h = g.createElement("div");
        h.setAttribute("style", "overflow: auto; float: right; width: " + b.chartWidth);
        n.appendChild(h);
        var C = g.createElement("div");
        C.setAttribute("style", "position: relative; opacity: 0; left: 0px; width: " + b.splitterWidth + "px; height: 0px; background: " + b.splitterBackground + "; -webkit-user-select: none; -moz-user-select: none; -ms-user-select: none; user-select: none; cursor: e-resize; -ms-touch-action: pinch-zoom");
        C.addEventListener("mouseover", function () {
            C.style.opacity = 1;
            C.isWaiting !== "undefined" && delete C.isWaiting
          },
          true);
        C.addEventListener("mouseout", function () {
          if (typeof C.isWaiting === "undefined") {
            C.isWaiting = true;
            setTimeout(function () {
              if (typeof C.isWaiting !== "undefined") {
                delete C.isWaiting;
                if (typeof C.x === "undefined") C.style.opacity = 0
              }
            }, 1E3)
          }
        }, true);
        C.addEventListener("mousedown", function (a) {
          if (a.button == 0) {
            C.style.opacity = 1;
            C.x = a.clientX;
            C.gridWidth = p.offsetWidth
          }
        }, true);
        g.addEventListener("mousemove", function (c) {
          if (typeof C.x !== "undefined" && !(a.offsetWidth <= 0)) {
            var c = C.gridWidth + (c.clientX - C.x), d = a.offsetWidth -
              c - 3, e = Math.max(1, b.minGridWidth), m = Math.max(1, b.minChartWidth);
            if (c < e) {
              d = d - (e - c);
              c = e
            } else if (d < m) {
              c = c - (m - d);
              d = m
            }
            c < 1 && (c = 1);
            d < 1 && (d = 1);
            typeof p.percent !== "undefined" && delete p.percent;
            c = Math.floor(c * 1E6 / a.offsetWidth) / 1E4;
            p.style.width = c + "%";
            h.style.width = 100 - c + "%";
            b.gridWidth = p.offsetWidth + "px";
            b.chartWidth = h.offsetWidth + "px";
            pa(C, p, b);
            typeof b.splitterPositionChangeHandler !== "undefined" && setTimeout(function () {
              b.splitterPositionChangeHandler(p.offsetWidth, h.offsetWidth)
            }, 0)
          }
        }, true);
        g.addEventListener("mouseup",
          function () {
            typeof C.x !== "undefined" && delete C.x;
            C.style.opacity = 0
          }, true);
        b.isGridVisible && b.isSplitterEnabled && n.appendChild(C);
        o = g.createElement("div");
        o.setAttribute("style", "float: right; background: " + b.headerBackground + "; width: 0px; height: " + b.headerHeight + "px");
        p.appendChild(o);
        n = g.createElement("div");
        n.setAttribute("style", "overflow: hidden; background: " + b.headerBackground + "; border-bottom: solid 1px " + b.border + "; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; height: " +
          b.headerHeight + "px");
        p.appendChild(n);
        var j = g.createElement("div");
        j.setAttribute("style", "float: right; background: " + b.headerBackground + "; width: 0px; height: " + b.headerHeight + "px");
        h.appendChild(j);
        var A = g.createElement("div");
        A.setAttribute("style", "overflow: hidden; background: " + b.headerBackground + "; border-bottom: solid 1px " + b.border + "; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; height: " + b.headerHeight + "px");
        h.appendChild(A);
        var k = g.createElement("div");
        k.setAttribute("style", "overflow-x: " + (typeof b.isExport === "undefined" || !b.isExport ? "scroll" : "hidden") + "; overflow-y: " + (typeof b.isExport === "undefined" || !b.isExport ? "auto" : "hidden") + "; height: " + f);
        p.appendChild(k);
        var q = g.createElement("div");
        q.setAttribute("style", "overflow-x: " + (typeof b.isExport === "undefined" || !b.isExport ? "scroll" : "hidden") + "; overflow-y: " + (typeof b.isExport === "undefined" || !b.isExport ? "auto" : "hidden") + "; height: " + f);
        h.appendChild(q);
        var l = Wa(c), f = g.createElement("div");
        f.setAttribute("style",
          "background: " + b.headerBackground + "; border-bottom: solid 1px " + b.border + "; -webkit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; width: " + l + "px; overflow: hidden; height: " + b.headerHeight + "px");
        n.appendChild(f);
        var s = g.createElement("div");
        s.setAttribute("style", "float: left; width: " + l + "px; overflow: auto");
        k.appendChild(s);
        if (typeof b.extraSpaceHeight !== "undefined") {
          var u = g.createElement("div");
          u.setAttribute("style", "overflow: hidden; width: " + l + "px; height: " + b.extraSpaceHeight +
            "px");
          k.appendChild(u)
        }
        var r = D(b.timelineFinish, b), w = g.createElement("div");
        w.setAttribute("style", "background: " + b.headerBackground + "; border-bottom: solid 1px " + b.border + "; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; width: " + r + "px; height: " + b.headerHeight + "px");
        A.appendChild(w);
        var t = g.createElement("div");
        t.setAttribute("style", "float: left; overflow: hidden; width: " + r + "px; height: 0px");
        q.appendChild(t);
        var v = g.createElementNS("http://www.w3.org/2000/svg",
          "svg");
        v.setAttribute("style", "width: " + r + "px; height: 0px");
        l = b.styleDefinitionTemplate();
        v.appendChild(l);
        v.chartAreaDefinitions = l;
        l = g.createElementNS("http://www.w3.org/2000/svg", "g");
        v.appendChild(l);
        t.chartAreaAlternativeRows = l;
        l = function () {
          setTimeout(function () {
            try {
              var a = t.chartArea, b = a.chartAreaDefinitions;
              a.removeChild(b);
              a.childNodes.length > 0 ? a.insertBefore(b, a.childNodes[0]) : a.appendChild(b)
            } catch (c) {
            }
          }, 0)
        };
        v.addEventListener("mousedown", l, true);
        v.addEventListener("mouseup", l, true);
        a.resetChartAreaDefinitions =
          l;
        t.appendChild(v);
        t.chartArea = v;
        if (typeof b.extraSpaceHeight !== "undefined") {
          g = g.createElement("div");
          g.setAttribute("style", "overflow: hidden; width: " + r + "px; height: " + b.extraSpaceHeight + "px");
          q.appendChild(g);
          q.chartExtraSpace = g
        }
        var B, x;
        setTimeout(function () {
          B = a.offsetWidth;
          x = a.clientHeight
        }, 0);
        typeof a.splitterUpdateTimer !== "undefined" && clearInterval(a.splitterUpdateTimer);
        a.splitterUpdateTimer = setInterval(function () {
          if (typeof C.x === "undefined" && !(a.offsetWidth <= 0)) {
            var c = a.offsetWidth, d = screen.deviceXDPI;
            if (c != B || d != screen.deviceXDPI) {
              var d = typeof p.percent !== "undefined" ? p.percent * c : p.offsetWidth, e = h.offsetWidth,
                m = Math.max(1, b.minGridWidth), f = Math.max(1, b.minChartWidth);
              if (d < m) {
                e = e - (m - d);
                d = m
              } else if (e < f) {
                d = d - (f - e);
                e = f
              }
              d < 1 && (d = 1);
              e < 1 && (e = 1);
              d = Math.floor(d * 1E6 / c) / 1E4;
              p.percent = d / 100;
              p.style.width = d + "%";
              h.style.width = 100 - d + "%";
              b.gridWidth = p.offsetWidth + "px";
              b.chartWidth = h.offsetWidth + "px";
              pa(C, p, b);
              if (typeof b.splitterPositionChangeHandler !== "undefined") {
                var o = p.offsetWidth, g = h.offsetWidth;
                o > 0 && g > 0 &&
                setTimeout(function () {
                  b.splitterPositionChangeHandler(o, g)
                }, 0)
              }
              B = c
            }
          }
        }, 100);
        typeof a.heightUpdateTimer !== "undefined" && clearInterval(a.heightUpdateTimer);
        a.heightUpdateTimer = setInterval(function () {
          if (!(a.clientHeight <= 0)) {
            var c = a.clientHeight;
            if (c != x) {
              var e = M(a, d, b);
              k.style.height = e;
              q.style.height = e;
              pa(C, p, b);
              Xa(t, q);
              ea(t, fa(d, b));
              la(d, q, b);
              x = c
            }
          }
        }, 100);
        s.container = k;
        t.container = q;
        f.container = n;
        w.container = A;
        a.gridContainer = p;
        a.chartContainer = h;
        a.gridContent = s;
        a.chartContent = t;
        a.gridContentContainer =
          k;
        a.chartContentContainer = q;
        a.gridHeader = f;
        a.chartHeader = w;
        a.gridHeaderContainer = n;
        a.chartHeaderContainer = A;
        a.splitter = C;
        q.isInitializing = true;
        g = z(d, b);
        ic(a, m);
        Xa(t, q);
        jc(f, c, b);
        Ya(w, v, e, b);
        kc(s, t, v, d, c, g, b);
        pa(C, p, b);
        q.isInitializing = false;
        la(d, q, b);
        q.scrollLeft = D(b.displayedTime, b);
        if (A.scrollLeft != q.scrollLeft) A.scrollLeft = q.scrollLeft;
        lc(a, k, p, n, o, s, q, A, h, j, t, C, d, b);
        var y = false, J = function (a, c) {
          typeof c === "undefined" && (c = 0);
          if (b.hourWidth != a) {
            y = true;
            var e = q.scrollLeft, m = c, f = b.hourWidth;
            b.hourWidth =
              a;
            typeof b.hourWidthChangeHandler !== "undefined" && setTimeout(function () {
              b.hourWidthChangeHandler(b.hourWidth)
            }, 0);
            r = D(b.timelineFinish, b);
            w.style.width = r + "px";
            t.style.width = r + "px";
            v.style.width = r + "px";
            if (typeof q.chartExtraSpace !== "undefined") q.chartExtraSpace.style.width = r + "px";
            var o;
            for (o = w.childNodes.length; o-- > 0;) w.removeChild(w.childNodes[o]);
            var g = [];
            for (o = v.childNodes.length; o-- > 1;) {
              var n = v.childNodes[o];
              if (n != t.chartAreaAlternativeRows) {
                n.tag != "Scale-Highlighting" && (n.tag != "Scale-Highlighting-CurrentTime" &&
                  n.tag != "Scale-Separator" && n.tag != "Scale-Separator-CurrentTime") && g.push(n);
                v.removeChild(n)
              }
            }
            Ya(w, v, b.scales, b);
            for (o = 0; o < d.length; o++) {
              n = d[o];
              n.isVirtuallyVisible && $(n.chartItem, n, b)
            }
            for (o = g.length; o-- > 0;) v.appendChild(g[o]);
            ea(t, fa(d, b));
            q.scrollLeft = m * (a / f) - (m - e);
            setTimeout(function () {
              y = false
            }, 200)
          }
        };
        if (typeof b.isMouseWheelZoomEnabled === "undefined" || b.isMouseWheelZoomEnabled) {
          c = function (b) {
            b.preventDefault();
            b.stopPropagation();
            if (!y) {
              var c = typeof b.wheelDelta !== "undefined" ? b.wheelDelta / 120 :
                  typeof b.detail !== "undefined" ? -b.detail / 3 : 0, d = a.settings, e = d.hourWidth,
                m = typeof d.isMouseWheelZoomEnabledMinHourWidth !== "undefined" ? d.isMouseWheelZoomEnabledMinHourWidth : 1;
              if (c < 0) e = e / (1.2 * -c); else if (c > 0) {
                e = e * 1.2 * c;
                c = typeof d.isMouseWheelZoomEnabledMaxHourWidth !== "undefined" ? d.isMouseWheelZoomEnabledMaxHourWidth : 20;
                e > c && (e = c)
              }
              e < m && (e = m);
              J(e, b.offsetX)
            }
          };
          v.addEventListener("mousewheel", c, false);
          v.addEventListener("DOMMouseScroll", c, false)
        }
        a.isInitializing = false;
        a.isInitialized = true;
        return a
      }
    }, V = function (a) {
      ca(a,
        a.items, a.settings, a.license)
    }, R = function (a) {
      if (typeof a.dateTimePickerType === "undefined") a.dateTimePickerType = "text";
      if (typeof a.useDatePicker === "undefined") a.useDatePicker = true;
      if (typeof a.useResourceSelector === "undefined") a.useResourceSelector = true;
      if (typeof a.dateFormatter === "undefined") a.dateFormatter = U;
      if (typeof a.dateTimeFormatter === "undefined") a.dateTimeFormatter = oa;
      if (typeof a.dateTimeParser === "undefined") a.dateTimeParser = l;
      if (typeof a.itemPropertyChangeHandler === "undefined") a.itemPropertyChangeHandler =
        function () {
        };
      if (typeof a.target === "undefined") a.target = "Standard";
      if (typeof a.theme === "undefined") a.theme = "Modern";
      if (typeof a.isGridVisible === "undefined") switch (a.target) {
        default:
          a.isGridVisible = true;
          break;
        case "Phone":
          a.isGridVisible = false
      }
      if (typeof a.isSplitterEnabled === "undefined") a.isSplitterEnabled = true;
      if (typeof a.isReadOnly === "undefined") a.isReadOnly = false;
      if (typeof a.isGridReadOnly === "undefined") a.isGridReadOnly = false;
      if (typeof a.isChartReadOnly === "undefined") a.isChartReadOnly = false;
      if (typeof a.isContentReadOnly ===
        "undefined") a.isContentReadOnly = false;
      if (typeof a.isAssignmentsContentReadOnly === "undefined") a.isAssignmentsContentReadOnly = false;
      if (typeof a.areTaskDependencyConstraintsEnabled === "undefined") a.areTaskDependencyConstraintsEnabled = false;
      if (typeof a.selectionMode === "undefined") a.selectionMode = "Focus";
      if (typeof a.isVirtualizing === "undefined") a.isVirtualizing = true
    }, H = function (a, d, b) {
      R(a);
      if (typeof a.gridWidth === "undefined") a.gridWidth = "35%";
      if (typeof a.chartWidth === "undefined") a.chartWidth = a.isGridVisible ?
        "65%" : "100%";
      if (typeof a.minGridWidth === "undefined") a.minGridWidth = 32;
      if (typeof a.minColumnWidth === "undefined") a.minColumnWidth = 32;
      if (typeof a.minChartWidth === "undefined") a.minChartWidth = 36;
      if (typeof a.border === "undefined") switch (a.theme) {
        default:
          a.border = "#e0e0e0";
          break;
        case "ModernBordered":
        case "Aero":
          a.border = "#9a9a9a"
      }
      if (typeof a.splitterWidth === "undefined") a.splitterWidth = 4;
      if (typeof a.splitterBackground === "undefined") a.splitterBackground = a.border;
      if (typeof a.indentationLevelWidth === "undefined") a.indentationLevelWidth =
        16;
      if (typeof a.itemHeight === "undefined") a.itemHeight = 21;
      if (typeof a.headerBackground === "undefined") a.headerBackground = "#f4f4f4";
      if (typeof a.headerHeight === "undefined") a.headerHeight = 42;
      if (typeof a.columns === "undefined") a.columns = j(d, a);
      if (typeof a.toggleButtonStyle === "undefined" && a.toggleButtonClass == null) a.toggleButtonStyle = "fill: Gray";
      if (typeof a.toggleButtonHoveringStyle === "undefined" && a.toggleButtonHoveringClass == null) a.toggleButtonHoveringStyle = "fill: Black";
      if (typeof a.collapsedToggleButtonTemplate ===
        "undefined") a.collapsedToggleButtonTemplate = lb(b, a);
      if (typeof a.expandedToggleButtonTemplate === "undefined") a.expandedToggleButtonTemplate = mb(b, a);
      if (typeof a.selectedItemStyle === "undefined" && a.selectedItemClass == null) switch (a.theme) {
        default:
          a.selectedItemStyle = "background-color: #f4f4f4; border-top: solid 1px White; margin-top: -1px; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box;";
          break;
        case "Aero":
          a.selectedItemStyle = "background-color: LightBlue; border-top: solid 1px White; margin-top: -1px; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box;"
      }
      if (typeof a.summaryItemStyle ===
        "undefined" && a.summaryItemClass == null) a.summaryItemStyle = "font-weight: bold";
      if (typeof a.daysOfWeek === "undefined") a.daysOfWeek = I;
      if (typeof a.months === "undefined") a.months = L;
      if (typeof a.weekStartDay === "undefined") a.weekStartDay = 0;
      if (typeof a.currentTime === "undefined") a.currentTime = new Date; else if (typeof a.currentTime === "string") try {
        a.currentTime = new Date(a.currentTime)
      } catch (c) {
        a.currentTime = new Date(parseInt(a.currentTime))
      }
      if (typeof a.displayedTime === "string") try {
        a.displayedTime = new Date(a.displayedTime)
      } catch (e) {
        a.displayedTime =
          new Date(parseInt(a.displayedTime))
      }
      if (typeof a.timelineStart === "string") try {
        a.timelineStart = new Date(a.timelineStart)
      } catch (f) {
        a.timelineStart = new Date(parseInt(a.timelineStart))
      }
      if (typeof a.timelineFinish === "string") try {
        a.timelineFinish = new Date(a.timelineFinish)
      } catch (g) {
        a.timelineFinish = new Date(parseInt(a.timelineFinish))
      }
      var m;
      if (typeof a.isRelativeToTimezone === "undefined" || a.isRelativeToTimezone) {
        a.currentTime = new Date(a.currentTime.valueOf() - a.currentTime.getTimezoneOffset() * 6E4);
        if (typeof a.displayedTime !==
          "undefined") a.displayedTime = new Date(a.displayedTime.valueOf() - a.displayedTime.getTimezoneOffset() * 6E4);
        if (typeof a.timelineStart !== "undefined") a.timelineStart = new Date(a.timelineStart.valueOf() - a.timelineStart.getTimezoneOffset() * 6E4);
        if (typeof a.timelineFinish !== "undefined") a.timelineFinish = new Date(a.timelineFinish.valueOf() - a.timelineFinish.getTimezoneOffset() * 6E4);
        if (typeof a.scales !== "undefined") for (m = 0; m < a.scales.length; m++) {
          var o = a.scales[m];
          if (typeof o.intervals !== "undefined") for (var n = 0; n <
          o.intervals.length; n++) {
            var p = o.intervals[n];
            if (typeof p.start !== "undefined") p.start = new Date(p.start.valueOf() - p.start.getTimezoneOffset() * 6E4);
            if (typeof p.finish !== "undefined") p.finish = new Date(p.finish.valueOf() - p.finish.getTimezoneOffset() * 6E4)
          }
        }
        a.isRelativeToTimezone = false
      }
      if (typeof a.schedule !== "undefined" && a.schedule != null) {
        if (a.schedule != a.previousSchedule || a.schedule.workingWeekStart != a.previousSchedule.workingWeekStart) a.workingWeekStart = a.schedule.workingWeekStart;
        if (a.schedule != a.previousSchedule ||
          a.schedule.workingWeekFinish != a.previousSchedule.workingWeekFinish) a.workingWeekFinish = a.schedule.workingWeekFinish;
        if (a.schedule != a.previousSchedule || a.schedule.workingDayStart != a.previousSchedule.workingDayStart) a.visibleDayStart = a.schedule.workingDayStart;
        if (a.schedule != a.previousSchedule || a.schedule.workingDayFinish != a.previousSchedule.workingDayFinish) a.visibleDayFinish = a.schedule.workingDayFinish;
        if (a.schedule != a.previousSchedule || a.schedule.specialNonworkingDays != a.previousSchedule.specialNonworkingDays) a.specialNonworkingDays =
          a.schedule.specialNonworkingDays
      }
      a.timelineStart = typeof a.timelineStart === "undefined" ? new Date(ma(a.currentTime, a.weekStartDay).valueOf() - 6048E5) : ma(a.timelineStart, a.weekStartDay);
      a.timelineFinish = typeof a.timelineFinish === "undefined" ? new Date(ma(a.currentTime, a.weekStartDay).valueOf() + 320544E5) : Za(a.timelineFinish, a.weekStartDay);
      if (typeof a.specialNonworkingDays !== "undefined") for (m = 0; m < a.specialNonworkingDays.length; m++) a.specialNonworkingDays[m] = W(new Date(a.specialNonworkingDays[m].valueOf() -
        a.specialNonworkingDays[m].getTimezoneOffset() * 6E4));
      if (typeof a.scales === "undefined") a.scales = nb(a);
      if (typeof a.updateScale === "undefined") a.updateScale = 9E5;
      if (typeof a.hourWidth === "undefined") a.hourWidth = 2.5;
      if (typeof a.displayedTime === "undefined") {
        a.displayedTime = a.currentTime;
        setTimeout(function () {
          var c = b.chartContentContainer.scrollLeft - a.hourWidth * 12;
          if (b.chartContentContainer.scrollLeft - c < b.chartContentContainer.clientWidth / 3) b.chartContentContainer.scrollLeft = Math.max(0, c)
        }, 0)
      }
      a.previousSchedule =
        a.schedule;
      if (typeof a.visibleDayStart === "undefined") a.visibleDayStart = 288E5;
      if (typeof a.visibleDayFinish === "undefined") a.visibleDayFinish = 576E5;
      if (a.visibleDayStart >= a.visibleDayFinish) {
        a.visibleWeekStart = 0;
        a.visibleWeekFinish = 864E5
      }
      if (typeof a.visibleWeekStart === "undefined") a.visibleWeekStart = 0;
      if (typeof a.visibleWeekFinish === "undefined") a.visibleWeekFinish = 6;
      if (a.visibleWeekStart > a.visibleWeekFinish) if (a.visibleWeekStart == a.visibleWeekFinish + 1) {
        a.visibleWeekStart = 0;
        a.visibleWeekFinish = 6
      } else a.visibleWeekFinish =
        a.visibleWeekStart;
      if (typeof a.workingWeekStart === "undefined") a.workingWeekStart = 1;
      if (typeof a.workingWeekFinish === "undefined") a.workingWeekFinish = 5;
      if (a.workingWeekStart > a.workingWeekFinish) if (a.workingWeekStart == a.workingWeekFinish + 1) {
        a.workingWeekStart = 0;
        a.workingWeekFinish = 6
      } else a.workingWeekFinish = a.workingWeekStart;
      a.workingDayStart = a.visibleDayStart;
      a.workingDayFinish = a.visibleDayFinish;
      if (typeof a.barMargin === "undefined") a.barMargin = a.itemHeight / 4;
      if (typeof a.barHeight === "undefined") a.barHeight =
        a.itemHeight - a.barMargin * 2;
      if (typeof a.barCornerRadius === "undefined") switch (a.theme) {
        default:
          a.barCornerRadius = 0;
          break;
        case "Aero":
          a.barCornerRadius = 3
      }
      if (typeof a.completedBarMargin === "undefined") a.completedBarMargin = a.barHeight / 2.5;
      if (typeof a.completedBarHeight === "undefined") a.completedBarHeight = a.barHeight - a.completedBarMargin * 2;
      if (typeof completedBarCornerRadius === "undefined") a.completedBarCornerRadius = 0;
      if (typeof a.styleDefinitionTemplate === "undefined") a.styleDefinitionTemplate = ob(b, a);
      if (typeof a.standardBarStyle ===
        "undefined" && a.standardBarClass == null) switch (a.theme) {
        default:
          a.standardBarStyle = "fill: #8abbed; fill-opacity: 0.8; stroke: #8abbed; stroke-width: 0.65px";
          break;
        case "ModernBordered":
          a.standardBarStyle = "fill: #8abbed; fill-opacity: 0.8; stroke: Blue; stroke-width: 0.65px";
          break;
        case "Aero":
          a.standardBarStyle = "fill: url(#BlueGradient); fill-opacity: 0.8; stroke: Blue"
      }
      if (typeof a.standardCompletedBarStyle === "undefined" && a.standardCompletedBarClass == null) switch (a.theme) {
        default:
          a.standardCompletedBarStyle =
            "fill: #3b87d9; stroke: #3b87d9; stroke-width: 0.65px";
          break;
        case "Aero":
          a.standardCompletedBarStyle = "fill: #808080; stroke: #202020; stroke-width: 0.65px"
      }
      if (typeof a.summaryBarStyle === "undefined" && a.summaryBarClass == null) switch (a.theme) {
        default:
          a.summaryBarStyle = "fill: #607080; stroke: #607080; stroke-width: 0.65px";
          break;
        case "ModernBordered":
          a.summaryBarStyle = "fill: #607080; stroke: #202020; stroke-width: 0.65px";
          break;
        case "Aero":
          a.summaryBarStyle = "fill: url(#BlackGradient); stroke: Black"
      }
      if (typeof a.collapsedSummaryLineStyle ===
        "undefined" && a.collapsedSummaryLineClass == null) a.collapsedSummaryLineStyle = "stroke: #3b87d9; stroke-width: 0.65px; stroke-dasharray: 2 2";
      if (typeof a.milestoneBarStyle === "undefined" && a.milestoneBarClass == null) switch (a.theme) {
        default:
          a.milestoneBarStyle = "fill: #607080; stroke: #607080; stroke-width: 0.65px";
          break;
        case "ModernBordered":
          a.milestoneBarStyle = "fill: #607080; stroke: #202020; stroke-width: 0.65px";
          break;
        case "Aero":
          a.milestoneBarStyle = "fill: url(#BlackGradient); stroke: Black"
      }
      if (typeof a.baselineBarStyle ===
        "undefined" && a.baselineBarClass == null) switch (a.theme) {
        default:
          a.baselineBarStyle = "fill: none; stroke: #3b87d9; stroke-width: 0.65px; stroke-dasharray: 2, 2";
          break;
        case "Aero":
          a.baselineBarStyle = "fill: none; stroke: Blue; stroke-dasharray: 2, 2"
      }
      if (typeof a.dependencyPointerStyle === "undefined" && a.dependencyPointerClass == null) switch (a.theme) {
        default:
          a.dependencyPointerStyle = "fill: #3b87d9; stroke: #3b87d9; stroke-width: 0.65px";
          break;
        case "Aero":
          a.dependencyPointerStyle = "fill: Blue; stroke: Blue"
      }
      if (typeof a.dependencyLineStyle ===
        "undefined" && a.dependencyLineClass == null) switch (a.theme) {
        default:
          a.dependencyLineStyle = "stroke: #3b87d9; stroke-width: 0.65px; fill: none; marker-end: url(#ArrowMarker)";
          break;
        case "Aero":
          a.dependencyLineStyle = "stroke: Blue; stroke-width: 0.65px; fill: none; marker-end: url(#ArrowMarker)"
      }
      if (typeof a.dependencyLineZoneStyle === "undefined" && a.dependencyLineZoneClass == null) a.dependencyLineZoneStyle = "stroke: White; stroke-opacity: 0; stroke-width: 4px; fill: none";
      if (typeof a.temporaryDependencyLineStyle ===
        "undefined" && a.temporaryDependencyLineClass == null) switch (a.theme) {
        default:
          a.temporaryDependencyLineStyle = "stroke: #3b87d9; stroke-width: 0.65px; stroke-dasharray: 2, 2; fill: none; marker-end: url(#ArrowMarker)";
          break;
        case "Aero":
          a.temporaryDependencyLineStyle = "stroke: Blue; stroke-width: 0.65px; stroke-dasharray: 2, 2; fill: none; marker-end: url(#ArrowMarker)"
      }
      if (typeof a.assignmentsStyle === "undefined" && a.assignmentsClass == null) a.assignmentsStyle = "stroke-width: 0.25px; font-size: x-small";
      if (typeof a.standardTaskTemplate ===
        "undefined") a.standardTaskTemplate = pb(d, b, a);
      if (typeof a.summaryTaskTemplate === "undefined") a.summaryTaskTemplate = qb(d, b, a);
      if (typeof a.milestoneTaskTemplate === "undefined") a.milestoneTaskTemplate = rb(d, b, a);
      if (typeof a.isTaskToolTipVisible === "undefined") switch (a.target) {
        default:
          a.isTaskToolTipVisible = true;
          break;
        case "Phone":
          a.isTaskToolTipVisible = false
      }
      if (typeof a.itemTemplate === "undefined") a.itemTemplate = sb(a);
      if (typeof a.areTaskAssignmentsVisible === "undefined") a.areTaskAssignmentsVisible = true;
      if (typeof a.assignmentsTemplate ===
        "undefined") a.assignmentsTemplate = tb(a);
      if (typeof a.isTaskCompletedEffortVisible === "undefined") a.isTaskCompletedEffortVisible = true;
      if (typeof a.areTaskDependenciesVisible === "undefined") a.areTaskDependenciesVisible = true;
      if (typeof a.dependencyLineTemplate === "undefined") a.dependencyLineTemplate = ub(d, a);
      if (typeof a.isDependencyToolTipVisible === "undefined") a.isDependencyToolTipVisible = a.isTaskToolTipVisible;
      if (typeof a.predecessorItemTemplate === "undefined") a.predecessorItemTemplate = vb(a);
      if (typeof a.isDraggingTaskStartEndsEnabled ===
        "undefined") a.isDraggingTaskStartEndsEnabled = true;
      if (typeof a.areTaskDependencyConstraintsEnabledWhileDragging === "undefined") a.areTaskDependencyConstraintsEnabledWhileDragging = false;
      if (typeof a.isTaskStartReadOnly === "undefined") a.isTaskStartReadOnly = false;
      if (typeof a.isTaskEffortReadOnly === "undefined") a.isTaskEffortReadOnly = false;
      if (typeof a.isTaskCompletionReadOnly === "undefined") a.isTaskCompletionReadOnly = false;
      if (typeof a.areTaskPredecessorsReadOnly === "undefined") a.areTaskPredecessorsReadOnly = false;
      if (typeof a.isBaselineVisible === "undefined") a.isBaselineVisible = true
    }, S = function (a, d) {
      for (var b = 0; b < a.length; b++) {
        var c = a[b];
        if (typeof c === "string") {
          c = {content: c};
          a[b] = c
        }
        if (typeof c.indentation === "string") c.indentation = parseInt(c.indentation);
        if (typeof c.isExpanded === "string") c.isExpanded = c.isExpanded.toLowerCase() == "true";
        if (typeof c.start === "string") {
          try {
            c.start = new Date(c.start)
          } catch (e) {
            c.start = new Date(parseInt(c.start))
          }
          if (typeof d.isRelativeToTimezone === "undefined" || d.isRelativeToTimezone) c.start =
            new Date(c.start.valueOf() + c.start.getTimezoneOffset() * 6E4);
          c.preferredStart = c.start
        }
        if (typeof c.finish === "string") {
          try {
            c.finish = new Date(c.finish)
          } catch (f) {
            c.finish = new Date(parseInt(c.finish))
          }
          if (typeof d.isRelativeToTimezone === "undefined" || d.isRelativeToTimezone) c.finish = new Date(c.finish.valueOf() + c.finish.getTimezoneOffset() * 6E4)
        }
        if (typeof c.completedFinish === "string") {
          try {
            c.completedFinish = new Date(c.completedFinish)
          } catch (g) {
            c.completedFinish = new Date(parseInt(c.completedFinish))
          }
          if (typeof d.isRelativeToTimezone ===
            "undefined" || d.isRelativeToTimezone) c.completedFinish = new Date(c.completedFinish.valueOf() + c.completedFinish.getTimezoneOffset() * 6E4)
        }
        if (typeof c.isMilestone === "string") c.isMilestone = c.isMilestone.toLowerCase() == "true";
        if (typeof c.baselineStart === "string") {
          try {
            c.baselineStart = new Date(c.baselineStart)
          } catch (m) {
            c.baselineStart = new Date(parseInt(c.baselineStart))
          }
          if (typeof d.isRelativeToTimezone === "undefined" || d.isRelativeToTimezone) c.baselineStart = new Date(c.baselineStart.valueOf() + c.baselineStart.getTimezoneOffset() *
            6E4)
        }
        if (typeof c.baselineFinish === "string") {
          try {
            c.baselineFinish = new Date(c.baselineFinish)
          } catch (o) {
            c.baselineFinish = new Date(parseInt(c.baselineFinish))
          }
          if (typeof d.isRelativeToTimezone === "undefined" || d.isRelativeToTimezone) c.baselineFinish = new Date(c.baselineFinish.valueOf() + c.baselineFinish.getTimezoneOffset() * 6E4)
        }
        if (typeof c.minStart === "string") {
          try {
            c.minStart = new Date(c.minStart)
          } catch (n) {
            c.minStart = new Date(parseInt(c.minStart))
          }
          if (typeof d.isRelativeToTimezone === "undefined" || d.isRelativeToTimezone) c.minStart =
            new Date(c.minStart.valueOf() + c.minStart.getTimezoneOffset() * 6E4)
        }
        if (typeof c.maxStart === "string") {
          try {
            c.maxStart = new Date(c.maxStart)
          } catch (p) {
            c.maxStart = new Date(parseInt(c.maxStart))
          }
          if (typeof d.isRelativeToTimezone === "undefined" || d.isRelativeToTimezone) c.maxStart = new Date(c.maxStart.valueOf() + c.maxStart.getTimezoneOffset() * 6E4)
        }
        if (typeof c.minFinish === "string") {
          try {
            c.minFinish = new Date(c.minFinish)
          } catch (h) {
            c.minFinish = new Date(parseInt(c.minFinish))
          }
          if (typeof d.isRelativeToTimezone === "undefined" ||
            d.isRelativeToTimezone) c.minFinish = new Date(c.minFinish.valueOf() + c.minFinish.getTimezoneOffset() * 6E4)
        }
        if (typeof c.maxFinish === "string") {
          try {
            c.maxFinish = new Date(c.maxFinish)
          } catch (C) {
            c.maxFinish = new Date(parseInt(c.maxFinish))
          }
          if (typeof d.isRelativeToTimezone === "undefined" || d.isRelativeToTimezone) c.maxFinish = new Date(c.maxFinish.valueOf() + c.maxFinish.getTimezoneOffset() * 6E4)
        }
        if (typeof c.predecessors !== "undefined") {
          if (typeof c.predecessors === "string") c.predecessors = c.predecessors.split(",");
          for (var j =
            0; j < c.predecessors.length; j++) {
            var A = c.predecessors[j];
            if (typeof A === "string") {
              A = {item: A};
              c.predecessors[j] = A
            }
            if (typeof A.item === "string") {
              var k = parseInt(A.item) - 1;
              A.item = k >= 0 && k < a.length ? a[k] : null
            }
            if (typeof A.lag === "string") A.lag = parseFloat(A.lag)
          }
        }
        if (typeof c.schedule !== "undefined" && typeof c.schedule.specialNonworkingDays !== "undefined") for (j = 0; j < c.schedule.specialNonworkingDays.length; j++) c.schedule.specialNonworkingDays[j] = W(new Date(c.schedule.specialNonworkingDays[j].valueOf() - c.schedule.specialNonworkingDays[j].getTimezoneOffset() *
          6E4))
      }
    }, M = function (a, d, b) {
      a = a.clientHeight - b.headerHeight - 2;
      a < 0 && (a = 0);
      var c = a + "px";
      a < b.itemHeight && (c = d.length > 0 ? "auto" : b.itemHeight + "px");
      return c
    }, z = function (a, d) {
      if (typeof d.toggleButtonAreaWidth !== "undefined") return d.toggleButtonAreaWidth;
      var b = 0;
      if (d.isGridVisible) for (var c = 0; c < a.length; c++) if (a[c].indentation > 0) {
        b = 16;
        break
      }
      return d.toggleButtonAreaWidth = b
    }, E = function (a, d) {
      var b = a.createElement("span");
      b.innerHTML = d;
      return b
    }, N = function (a, d) {
      return d == true ? a.createTextNode("\u2713") : a.createTextNode("")
    },
    U = function (a) {
      var d = a.getFullYear(), b = a.getMonth() + 1;
      b < 10 && (b = "0" + b);
      a = a.getDate();
      a < 10 && (a = "0" + a);
      return b + "/" + a + "/" + d
    }, oa = function (a) {
      var d = U(a), b = a.getHours();
      b < 10 && (b = "0" + b.toString());
      a = a.getMinutes();
      a < 10 && (a = "0" + a.toString());
      return d + " " + b + ":" + a
    }, h = function (a) {
      return new Date(a.valueOf() + a.getTimezoneOffset() * 6E4)
    }, l = function (a) {
      var d = new Date;
      if (a == null || a == "") return d;
      var b, c, e, f;
      e = a.indexOf(" ");
      if (e >= 0) {
        b = a.substr(0, e);
        f = a.substr(e + 1)
      } else {
        b = a;
        f = "0"
      }
      e = b.indexOf("/");
      if (e >= 0) {
        for (a = b.substr(0,
          e); a.length > 0 && a.substr(0, 1) == "0";) a = a.substr(1);
        a = parseInt(a) - 1;
        b = b.substr(e + 1);
        e = b.indexOf("/");
        if (e >= 0) {
          c = b.substr(0, e);
          for (e = b.substr(e + 1); e.length > 0 && e.substr(0, 1) == "0";) e = e.substr(1);
          b = parseInt(e)
        } else {
          c = b;
          b = d.getFullYear()
        }
        for (; c.length > 0 && c.substr(0, 1) == "0";) c = c.substr(1);
        c = parseInt(c)
      } else {
        for (; b.length > 0 && b.substr(0, 1) == "0";) b = b.substr(1);
        c = parseInt(b);
        a = d.getMonth();
        b = d.getFullYear()
      }
      var g;
      e = f.indexOf(":");
      if (e >= 0) {
        g = f.substr(0, e);
        f = f.substr(e + 1)
      } else {
        g = f;
        f = "0"
      }
      for (; g.length > 1 && g.substr(0,
        1) == "0";) g = g.substr(1);
      for (e = parseInt(g); f.length > 1 && f.substr(0, 1) == "0";) f = f.substr(1);
      f = parseInt(f);
      return isNaN(b) || isNaN(a) || isNaN(c) || b <= 0 || a < 0 || a >= 12 || c < 1 || c > P[a] + (a != 1 || !(b % 400 == 0 || (b % 100 == 0 ? 0 : b % 4 == 0)) ? 0 : 1) ? isNaN(e) || isNaN(f) || e < 0 || e >= 24 || f < 0 || f >= 60 ? d : new Date(d.getFullYear(), d.getMonth(), d.getDate(), e, f, 0, 0) : isNaN(e) || isNaN(f) || e < 0 || e >= 24 || f < 0 || f >= 60 ? new Date(b, a, c, 0, 0, 0, 0) : new Date(b, a, c, e, f, 0, 0)
    }, k = function (a) {
      return new Date(a.valueOf() - a.getTimezoneOffset() * 6E4)
    }, r = function (a, d) {
      var b =
        a.ownerDocument, c = b.createElementNS("http://www.w3.org/2000/svg", "svg");
      c.setAttribute("style", "width: 12px; height: 12px");
      c.setAttribute("focusable", "false");
      b = b.createElementNS("http://www.w3.org/2000/svg", "rect");
      b.setAttribute("id", "PART_Border");
      b.setAttribute("width", "12");
      b.setAttribute("height", "12");
      b.setAttribute("style", "fill: White; fill-opacity: 0");
      c.appendChild(b);
      a.setAttribute("id", "PART_Button");
      typeof d.toggleButtonClass !== "undefined" && a.setAttribute("class", d.toggleButtonClass);
      typeof d.toggleButtonStyle !== "undefined" && a.setAttribute("style", d.toggleButtonStyle);
      c.appendChild(a);
      return c
    }, j = function (a, d) {
      typeof d !== "object" && (d = {});
      R(d);
      var b = [{header: "", width: 32, isSelection: true}, {
        header: "Task",
        width: 140,
        isTreeView: true
      }, {header: "Start", width: 140}, {header: "Finish", width: 140}, {
        header: "Milestone",
        width: 80
      }, {header: "Completed", width: 80}, {header: "Assignments", width: 200}];
      b[0].cellTemplate = s(d, b[0], a);
      b[1].cellTemplate = x(d, b[1], a);
      b[1].exportCellTemplate = x(d, b[1], a, false);
      b[2].cellTemplate =
        J(d, b[2]);
      b[2].exportCellTemplate = J(d, b[2], false);
      b[3].cellTemplate = wb(d, b[3]);
      b[3].exportCellTemplate = wb(d, b[3], false);
      b[4].cellTemplate = v(d, b[4]);
      b[4].exportCellTemplate = v(d, b[4], false);
      b[5].cellTemplate = xb(d, b[5]);
      b[5].exportCellTemplate = xb(d, b[5], false);
      b[6].cellTemplate = yb(d, b[6]);
      b[6].exportCellTemplate = yb(d, b[6], false);
      d.selectionMode != "Single" && (d.selectionMode != "Extended" && d.selectionMode != "ExtendedFocus") && b.splice(0, 1);
      return b
    }, s = function (a, d, b) {
      return function (c) {
        return !d.isReadOnly ?
          q(c, a, b) : N(c.ganttChartView.ownerDocument, c.isSelected)
      }
    }, q = function (a, d) {
      var b = a.ganttChartView.ownerDocument, c;
      if (typeof a.selectionInput === "undefined") {
        c = b.createElement("input");
        a.selectionInput = c;
        c.type = "checkbox";
        c.setAttribute("style", "margin: 0px")
      } else c = a.selectionInput;
      if (a.isSelected) c.setAttribute("checked", true); else if (c.checked) c.checked = false;
      var e = function () {
        c.checked ? w(a, true, d.selectionMode) : w(a, false, d.selectionMode)
      };
      typeof c.changeEventListener !== "undefined" && c.removeEventListener("change",
        c.changeEventListener, true);
      c.addEventListener("change", e, true);
      c.changeEventListener = e;
      b = function (a) {
        if (a.keyCode == 13) {
          a.preventDefault();
          a.stopPropagation();
          e(a)
        }
      };
      typeof c.keyPressEventListener !== "undefined" && c.removeEventListener("keypress", c.keyPressEventListener, true);
      c.addEventListener("keypress", b, true);
      c.keyPressEventListener = b;
      return c
    }, w = function (a, d, b) {
      a.isSelected = d;
      u(a, "isSelected", true, true);
      zb(a);
      if (typeof a.ganttChartView != null) {
        a.ganttChartView.selectedItem = a;
        if (b != "Extended" && b !=
          "ExtendedFocus") a.ganttChartView.selectedItems = [a];
        var c;
        if (b != "Extended" && b != "ExtendedFocus") for (c = 0; c < a.ganttChartView.items.length; c++) {
          d = a.ganttChartView.items[c];
          if (d != a && d.isSelected) {
            d.isSelected = false;
            u(d, "isSelected", false, true);
            zb(d)
          }
        }
      }
      if (typeof a.ganttChartView != null && (b == "Extended" || b == "ExtendedFocus")) {
        b = [];
        for (c = 0; c < a.ganttChartView.items.length; c++) {
          d = a.ganttChartView.items[c];
          d.isSelected && b.push(d)
        }
        a.ganttChartView.selectedItems = b
      }
    }, t = function (a, d) {
      if (typeof a.ganttChartView != null) a.ganttChartView.currentItem =
        a;
      if (d.selectionMode == "Focus" || d.selectionMode == "ExtendedFocus") {
        if (typeof a.scheduleChartItem !== "undefined") a = a.scheduleChartItem;
        a.isSelected || w(a, true, d.selectionMode)
      }
    }, x = function (a, d, b, c) {
      var e = function (a) {
        return E(a.ganttChartView.ownerDocument, a.content)
      };
      return (typeof c === "undefined" || c) && !a.isReadOnly && !a.isGridReadOnly && !a.isContentReadOnly ? function (b) {
        return !d.isReadOnly && (typeof b.isReadOnly === "undefined" || !b.isReadOnly) ? y(b, Math.max(0, d.width - b.indentation * b.ganttChartView.settings.indentationLevelWidth -
          b.ganttChartView.settings.toggleButtonAreaWidth - 16), a) : e(b)
      } : e
    }, y = function (a, d, b) {
      var c = a.ganttChartView.ownerDocument, e;
      if (typeof a.contentInput === "undefined") {
        e = c.createElement("input");
        a.contentInput = e;
        e.type = "text";
        e.addEventListener("focus", function () {
          t(a, b)
        }, false);
        var f = function () {
          a.content = e.value;
          u(a, "content", true, true);
          ga(a)
        };
        typeof e.changeEventListener !== "undefined" && e.removeEventListener("change", e.changeEventListener, true);
        e.addEventListener("change", f, true);
        e.changeEventListener = f;
        c = function (a) {
          if (a.keyCode == 13) {
            a.preventDefault();
            a.stopPropagation();
            f(a)
          }
        };
        typeof e.keyPressEventListener !== "undefined" && e.removeEventListener("keypress", e.keyPressEventListener, true);
        e.addEventListener("keypress", c, true);
        e.keyPressEventListener = c;
        e.addEventListener("focus", function () {
          e.style.backgroundColor = "White"
        }, false);
        e.addEventListener("blur", function () {
          e.style.backgroundColor = "Transparent"
        }, false)
      } else e = a.contentInput;
      e.value = a.content;
      c = "";
      if (a.hasChildren && (typeof a.isSummaryEnabled ===
        "undefined" || a.isSummaryEnabled)) c = "; font-weight: bold";
      e.setAttribute("style", "background-color: Transparent; width: " + d + "px; border-width: 0px; padding: 0px" + c);
      return e
    }, J = function (a, d, b) {
      var c = function (b) {
        return typeof b.start === "undefined" || typeof b.isSummaryEnabled !== "undefined" && !b.isSummaryEnabled && typeof b.isBarVisible !== "undefined" && !b.isBarVisible ? b.ganttChartView.ownerDocument.createTextNode("") : b.ganttChartView.ownerDocument.createTextNode(a.dateTimeFormatter(h(b.start)))
      };
      return (typeof b ===
        "undefined" || b) && !a.isReadOnly && !a.isGridReadOnly ? function (b) {
        return !d.isReadOnly && (typeof b.isReadOnly === "undefined" || !b.isReadOnly) && !(typeof b.isSummaryEnabled !== "undefined" && !b.isSummaryEnabled && typeof b.isBarVisible !== "undefined" && !b.isBarVisible) ? mc(b, Math.max(0, d.width - 16), a) : c(b)
      } : c
    }, mc = function (a, d, b) {
      var c = a.ganttChartView.ownerDocument, e;
      if (typeof a.startInput === "undefined") {
        e = c.createElement("input");
        a.startInput = e;
        try {
          e.type = b.dateTimePickerType
        } catch (f) {
          e.type = "text"
        }
        e.addEventListener("focus",
          function () {
            t(a, b)
          }, false);
        e.addEventListener("focus", function () {
          e.style.backgroundColor = "White"
        }, false);
        e.addEventListener("blur", function () {
          e.style.backgroundColor = "Transparent"
        }, false)
      } else e = a.startInput;
      if (typeof a.start !== "undefined") e.value = b.dateTimeFormatter(h(a.start));
      DlhSoft.Controls.DatePicker && (b.dateTimePickerType == "text" && b.useDatePicker) && e.addEventListener("focus", function () {
        var a = DlhSoft.Controls.DatePicker.get(e);
        if (!a || !a.isOpen) {
          var c = 0, d = 0;
          try {
            c = e.selectionStart;
            d = e.selectionEnd
          } catch (f) {
          }
          a =
            DlhSoft.Controls.DatePicker.initialize(e, void 0, {
              isDropDownButtonVisible: false,
              defaultTimeOfDay: b.workingDayStart,
              dateTimeFormatter: b.dateTimeFormatter,
              dateTimeParser: b.dateTimeParser,
              popupStyle: "margin-top: 1px; background-color: White; border: 1px solid " + b.border
            }, "DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.");
          a.openDropDown();
          setTimeout(function () {
              try {
                e.selectionStart = c;
                e.selectionEnd = d;
                e.focus()
              } catch (a) {
              }
            },
            100)
        }
      }, true);
      c = "";
      if (a.hasChildren && (typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled)) c = "; font-weight: bold";
      e.setAttribute("style", "background-color: Transparent; width: " + d + "px; border-width: 0px; padding: 0px" + c);
      a.hasChildren && (typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled) ? e.setAttribute("disabled", "true") : e.removeAttribute("disabled");
      var g = function () {
        if (!a.hasChildren || !(typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled)) {
          var c = a.completedFinish > a.start;
          a.start = F(k(b.dateTimeParser(e.value)), b, true, a.isMilestone, a.schedule);
          a.preferredStart = a.start;
          u(a, "start", true, true);
          if (a.finish < a.start) {
            a.finish = a.start;
            u(a, "finish", false, true)
          }
          if (a.completedFinish < a.start || !c) {
            a.completedFinish = a.start;
            u(a, "completedFinish", false, true)
          } else if (a.completedFinish > a.finish) {
            a.completedFinish = a.finish;
            u(a, "completedFinish", false, true)
          }
          if (typeof a.completedInput !== "undefined") {
            c = a.completedInput;
            typeof c.changeEventListener !== "undefined" && c.removeEventListener("change",
              c.changeEventListener, true);
            delete a.completedInput
          }
        }
        X(a)
      };
      typeof e.changeEventListener !== "undefined" && e.removeEventListener("change", e.changeEventListener, true);
      e.addEventListener("change", g, true);
      e.changeEventListener = g;
      d = function (a) {
        if (a.keyCode == 13) {
          a.preventDefault();
          a.stopPropagation();
          g(a)
        }
      };
      typeof e.keyPressEventListener !== "undefined" && e.removeEventListener("keypress", e.keyPressEventListener, true);
      e.addEventListener("keypress", d, true);
      e.keyPressEventListener = d;
      return e
    }, wb = function (a, d, b) {
      var c =
        function (b) {
          return typeof b.finish === "undefined" || typeof b.isMilestone !== "undefined" && b.isMilestone == true && typeof b.start !== "undefined" && b.finish.valueOf() == b.start.valueOf() || typeof b.isSummaryEnabled !== "undefined" && !b.isSummaryEnabled && typeof b.isBarVisible !== "undefined" && !b.isBarVisible ? b.ganttChartView.ownerDocument.createTextNode("") : b.ganttChartView.ownerDocument.createTextNode(a.dateTimeFormatter(h(b.finish)))
        };
      return (typeof b === "undefined" || b) && !a.isReadOnly && !a.isGridReadOnly ? function (b) {
        return !d.isReadOnly &&
        (typeof b.isReadOnly === "undefined" || !b.isReadOnly) && !(typeof b.isSummaryEnabled !== "undefined" && !b.isSummaryEnabled && typeof b.isBarVisible !== "undefined" && !b.isBarVisible) ? nc(b, Math.max(0, d.width - 16), a) : c(b)
      } : c
    }, nc = function (a, d, b) {
      var c = a.ganttChartView.ownerDocument, e;
      if (typeof a.finishInput === "undefined") {
        e = c.createElement("input");
        a.finishInput = e;
        try {
          e.type = b.dateTimePickerType
        } catch (f) {
          e.type = "text"
        }
        e.addEventListener("focus", function () {
          t(a, b)
        }, false);
        e.addEventListener("focus", function () {
          e.style.backgroundColor =
            "White"
        }, false);
        e.addEventListener("blur", function () {
          e.style.backgroundColor = "Transparent"
        }, false)
      } else e = a.finishInput;
      if (typeof a.finish !== "undefined") e.value = b.dateTimeFormatter(h(a.finish));
      DlhSoft.Controls.DatePicker && (b.dateTimePickerType == "text" && b.useDatePicker) && e.addEventListener("focus", function () {
        var a = DlhSoft.Controls.DatePicker.get(e);
        if (!a || !a.isOpen) {
          var c = 0, d = 0;
          try {
            c = e.selectionStart;
            d = e.selectionEnd
          } catch (m) {
          }
          a = DlhSoft.Controls.DatePicker.initialize(e, void 0, {
            isDropDownButtonVisible: false,
            defaultTimeOfDay: b.workingDayFinish,
            dateTimeFormatter: b.dateTimeFormatter,
            dateTimeParser: b.dateTimeParser,
            popupStyle: "margin-top: 1px; background-color: White; border: 1px solid " + b.border
          }, "DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.");
          a.openDropDown();
          setTimeout(function () {
            try {
              e.selectionStart = c;
              e.selectionEnd = d;
              e.focus()
            } catch (a) {
            }
          }, 100)
        }
      }, true);
      c = "";
      typeof a.isMilestone !== "undefined" && a.isMilestone == true &&
      (c = "; visibility: hidden");
      var g = "";
      if (a.hasChildren && (typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled)) g = "; font-weight: bold";
      e.setAttribute("style", "background-color: Transparent; width: " + d + "px; border-width: 0px; padding: 0px" + c + g);
      a.hasChildren && (typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled) ? e.setAttribute("disabled", "true") : e.removeAttribute("disabled");
      var m = function () {
        if (!a.hasChildren || !(typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled)) {
          var c = k(b.dateTimeParser(e.value));
          e.value.length > 0 && (e.value.indexOf(" ") < 0 && ba(c) == 0) && (c = Y(c));
          a.finish = F(c, b, a.isMilestone, true, a.schedule);
          if (a.finish < a.start) a.finish = a.start;
          u(a, "finish", true, true);
          if (a.completedFinish < a.start) {
            a.completedFinish = a.start;
            u(a, "completedFinish", false, true)
          } else if (a.completedFinish > a.finish) {
            a.completedFinish = a.finish;
            u(a, "completedFinish", false, true)
          }
          if (typeof a.completedInput !== "undefined") {
            c = a.completedInput;
            typeof c.changeEventListener !== "undefined" && c.removeEventListener("change", c.changeEventListener,
              true);
            delete a.completedInput
          }
        }
        X(a)
      };
      typeof e.changeEventListener !== "undefined" && e.removeEventListener("change", e.changeEventListener, true);
      e.addEventListener("change", m, true);
      e.changeEventListener = m;
      d = function (a) {
        if (a.keyCode == 13) {
          a.preventDefault();
          a.stopPropagation();
          m(a)
        }
      };
      typeof e.keyPressEventListener !== "undefined" && e.removeEventListener("keypress", e.keyPressEventListener, true);
      e.addEventListener("keypress", d, true);
      e.keyPressEventListener = d;
      return e
    }, v = function (a, d, b) {
      var c = function (a) {
        return typeof a.isMilestone ===
        "undefined" || typeof a.isSummaryEnabled !== "undefined" && !a.isSummaryEnabled && typeof a.isBarVisible !== "undefined" && !a.isBarVisible ? a.ganttChartView.ownerDocument.createTextNode("") : N(a.ganttChartView.ownerDocument, a.isMilestone)
      };
      return (typeof b === "undefined" || b) && !a.isReadOnly && !a.isGridReadOnly ? function (b) {
        return !d.isReadOnly && (typeof b.isReadOnly === "undefined" || !b.isReadOnly) && !(typeof b.isSummaryEnabled !== "undefined" && !b.isSummaryEnabled && typeof b.isBarVisible !== "undefined" && !b.isBarVisible) ? G(b,
          a) : c(b)
      } : c
    }, G = function (a, d) {
      var b = a.ganttChartView.ownerDocument, c;
      if (typeof a.milestoneInput === "undefined") {
        c = b.createElement("input");
        a.milestoneInput = c;
        c.type = "checkbox";
        c.setAttribute("style", "margin: 0px; margin-left: 2px; margin-right: 2px");
        c.addEventListener("focus", function () {
          t(a, d)
        }, false)
      } else c = a.milestoneInput;
      (!a.hasChildren || !(typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled)) && typeof a.isMilestone !== "undefined" && a.isMilestone ? c.setAttribute("checked", true) : c.removeAttribute("checked");
      if (!a.hasChildren || !(typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled)) {
        var e = function () {
          if (c.checked) {
            a.isMilestone = true;
            u(a, "isMilestone", true, true);
            if (a.finish > a.start) {
              a.finish = a.start;
              u(a, "finish", false, true)
            }
            if (a.completedFinish > a.start) {
              a.completedFinish = a.start;
              u(a, "completedFinish", false, true)
            }
          } else {
            a.isMilestone = false;
            u(a, "isMilestone", true, true)
          }
          X(a)
        };
        typeof c.changeEventListener !== "undefined" && c.removeEventListener("change", c.changeEventListener, true);
        c.addEventListener("change",
          e, true);
        c.changeEventListener = e;
        b = function (a) {
          if (a.keyCode == 13) {
            a.preventDefault();
            a.stopPropagation();
            e(a)
          }
        };
        typeof c.keyPressEventListener !== "undefined" && c.removeEventListener("keypress", c.keyPressEventListener, true);
        c.addEventListener("keypress", b, true);
        c.keyPressEventListener = b
      } else c.setAttribute("style", "visibility: hidden");
      return c
    }, yb = function (a, d, b) {
      var c = function (a) {
        return typeof a.assignmentsContent === "undefined" || typeof a.isSummaryEnabled !== "undefined" && !a.isSummaryEnabled && typeof a.isBarVisible !==
        "undefined" && !a.isBarVisible ? a.ganttChartView.ownerDocument.createTextNode("") : E(a.ganttChartView.ownerDocument, a.assignmentsContent)
      };
      return (typeof b === "undefined" || b) && !a.isReadOnly && !a.isGridReadOnly && !a.isAssignmentsContentReadOnly ? function (b) {
        return !d.isReadOnly && (typeof b.isReadOnly === "undefined" || !b.isReadOnly) && !(typeof b.isSummaryEnabled !== "undefined" && !b.isSummaryEnabled && typeof b.isBarVisible !== "undefined" && !b.isBarVisible) ? Q(b, Math.max(0, d.width - 16), a) : c(b)
      } : c
    }, Q = function (a, d, b) {
      var c =
        a.ganttChartView, e = c.ownerDocument, f;
      if (typeof a.assignmentsContentInput === "undefined") {
        f = e.createElement("input");
        a.assignmentsContentInput = f;
        f.type = "text";
        f.addEventListener("focus", function () {
          t(a, b)
        }, false);
        var g = function () {
          a.assignmentsContent = f.value;
          u(a, "assignmentsContent", true, true);
          ha(a);
          var b = null;
          DlhSoft.Controls.MultiSelectorComboBox && (b = DlhSoft.Controls.MultiSelectorComboBox.get(f));
          if (b != null && b.availableChoices.length > 0) var c = setInterval(function () {
              if (!b.isOpen) {
                clearInterval(c);
                X(a)
              }
            },
            100); else X(a)
        };
        typeof f.changeEventListener !== "undefined" && f.removeEventListener("change", f.changeEventListener, true);
        f.addEventListener("change", function (a) {
          f.dontAutoFocus = true;
          g(a)
        }, true);
        f.changeEventListener = g;
        e = function (a) {
          if (a.keyCode == 13) {
            a.preventDefault();
            a.stopPropagation();
            typeof f.dontAutoFocus !== "undefined" && delete f.dontAutoFocus;
            g(a)
          }
        };
        typeof f.keyPressEventListener !== "undefined" && f.removeEventListener("keypress", f.keyPressEventListener, true);
        f.addEventListener("keypress", e, true);
        f.keyPressEventListener = e;
        f.addEventListener("focus", function () {
          f.style.backgroundColor = "White"
        }, false);
        f.addEventListener("blur", function () {
          f.style.backgroundColor = "Transparent"
        }, false)
      } else f = a.assignmentsContentInput;
      if (typeof a.assignmentsContent !== "undefined") f.value = a.assignmentsContent;
      DlhSoft.Controls.MultiSelectorComboBox && b.useResourceSelector && f.addEventListener("focus", function () {
        var a = DlhSoft.Controls.MultiSelectorComboBox.get(f);
        if (!a || !a.isOpen && a.availableChoices.length > 0) {
          a = b.assignableResources;
          if (typeof a === "undefined") {
            a = xa(c.items);
            b.assignableResources = a
          }
          var d = 0, e = 0;
          try {
            d = f.selectionStart;
            e = f.selectionEnd
          } catch (g) {
          }
          a = DlhSoft.Controls.MultiSelectorComboBox.initialize(f, a, void 0, {
            autoAppendAvailableChoices: b.autoAppendAssignableResources,
            isDropDownButtonVisible: false,
            popupStyle: "margin-top: 1px; background-color: White; color: Black; border: 1px solid " + b.border + "; font-size: small; max-height: 188px; overflow-y: auto"
          }, "DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.");
          a.openDropDown();
          setTimeout(function () {
            try {
              f.selectionStart = d;
              f.selectionEnd = e;
              f.focus()
            } catch (a) {
            }
          }, 100)
        }
      }, true);
      e = "";
      if (a.hasChildren && (typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled)) e = "; font-weight: bold";
      f.setAttribute("style", "background-color: Transparent; width: " + d + "px; border-width: 0px; padding: 0px" + e);
      return f
    }, xb = function (a, d, b) {
      var c = function (a) {
        return typeof a.start === "undefined" || typeof a.finish === "undefined" || a.finish.valueOf() == a.start.valueOf() || typeof a.isSummaryEnabled !==
        "undefined" && !a.isSummaryEnabled && typeof a.isBarVisible !== "undefined" && !a.isBarVisible ? a.ganttChartView.ownerDocument.createTextNode("") : N(a.ganttChartView.ownerDocument, a.ganttChartView.isItemCompleted(a))
      };
      return (typeof b === "undefined" || b) && !a.isReadOnly && !a.isGridReadOnly ? function (b) {
        return !d.isReadOnly && (typeof b.isReadOnly === "undefined" || !b.isReadOnly) && (!b.hasChildren || !(typeof b.isSummaryEnabled === "undefined" || b.isSummaryEnabled)) && !(typeof b.isSummaryEnabled !== "undefined" && !b.isSummaryEnabled &&
          typeof b.isBarVisible !== "undefined" && !b.isBarVisible) ? oc(b, a) : c(b)
      } : c
    }, oc = function (a, d) {
      var b = a.ganttChartView.ownerDocument, c;
      if (typeof a.completedInput === "undefined") {
        c = b.createElement("input");
        a.completedInput = c;
        c.type = "checkbox";
        c.setAttribute("style", "margin: 0px; margin-left: 2px; margin-right: 2px");
        c.addEventListener("focus", function () {
          t(a, d)
        }, false)
      } else c = a.completedInput;
      a.isSetAsCompleted || (!a.hasChildren || !(typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled)) && a.completedFinish >=
      a.finish && a.finish > a.start && (typeof a.isMilestone === "undefined" || !a.isMilestone) ? c.setAttribute("checked", true) : c.removeAttribute("checked");
      a.hasChildren && (typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled) && c.setAttribute("style", "visibility: hidden");
      var e = function () {
        if (c.checked) {
          if (a.completedFinish < a.finish) {
            a.completedFinish = a.finish;
            u(a, "completedFinish", true, true)
          }
          if (a.isMilestone || a.finish.valueOf() <= a.start.valueOf()) a.isSetAsCompleted = true
        } else {
          if (a.completedFinish > a.start) {
            a.completedFinish =
              a.start;
            u(a, "completedFinish", true, true)
          }
          if (a.isMilestone || a.finish.valueOf() <= a.start.valueOf()) a.isSetAsCompleted = false
        }
        X(a)
      };
      typeof c.changeEventListener !== "undefined" && c.removeEventListener("change", c.changeEventListener, true);
      c.addEventListener("change", e, true);
      c.changeEventListener = e;
      b = function (a) {
        if (a.keyCode == 13) {
          a.preventDefault();
          a.stopPropagation();
          e(a)
        }
      };
      typeof c.keyPressEventListener !== "undefined" && c.removeEventListener("keypress", c.keyPressEventListener, true);
      c.addEventListener("keypress",
        b, true);
      c.keyPressEventListener = b;
      return c
    }, Wa = function (a) {
      for (var d = 0, b = 0; b < a.length; b++) d = d + a[b].width;
      return d
    }, gc = function (a, d, b) {
      for (var c = z(d.items, b), e = 0; e < a.length; e++) {
        var f = a[e];
        f.ganttChartView = d;
        if (typeof f.width === "undefined") f.width = 100;
        if (typeof f.minWidth === "undefined") f.minWidth = Math.min(f.width, b.minColumnWidth + (f.isTreeView ? c : 0));
        if (typeof f.maxWidth === "undefined") f.maxWidth = b.maxColumnWidth;
        if (typeof f.cellTemplate === "undefined") f.cellTemplate = function (a) {
          return E(a.ganttChartView.ownerDocument,
            a.content)
        }
      }
    }, jc = function (a, d, b) {
      var c = a.ownerDocument, e = c.createElement("div");
      typeof b.columnHeaderClass !== "undefined" && e.setAttribute("class", b.columnHeaderClass);
      typeof b.columnHeaderStyle !== "undefined" && e.setAttribute("style", b.columnHeaderStyle);
      for (var f = 0; f < d.length; f++) e.appendChild(pc(c, d[f], b));
      a.appendChild(e)
    }, pc = function (a, d, b) {
      var c = a.createElement("div");
      c.setAttribute("style", "overflow-y: hidden; vertical-align: middle; display: table-cell; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; height: " +
        b.headerHeight + "px");
      var e = a.createElement("div");
      e.setAttribute("style", "padding-left: 2px; padding-right: 2px; overflow-x: hidden; -wekbit-box-sizing: border-box; -moz-box-sizing: border-box; box-sizing: border-box; width: " + d.width + "px");
      var f = a.createElement("div");
      typeof d.headerClass !== "undefined" && f.setAttribute("class", d.headerClass);
      typeof d.headerStyle !== "undefined" && f.setAttribute("style", d.headerStyle);
      f.appendChild(E(a, d.header));
      e.appendChild(f);
      c.appendChild(e);
      if (d.width >= 1 && (typeof b.allowUserToResizeColumns ===
        "undefined" || b.allowUserToResizeColumns) && (typeof d.allowUserToResize === "undefined" || d.allowUserToResize)) {
        c.isGripperVisible = false;
        var g = d.ganttChartView, m = function (a) {
          c.isGripperVisible = a;
          c.style.cursor = a ? "e-resize" : "default";
          c.style.borderRight = a ? "solid 1px " + b.border : "";
          e.style.width = d.width - (a ? 1 : 0) + "px"
        }, o = b.splitterWidth;
        c.addEventListener("mouseover", function (a) {
          if (!DlhSoft.Controls.GanttChartView.isGripperDragging && !(c.isGripperDragging || typeof a.offsetX === "undefined" && a.currentTarget != c)) m((typeof a.offsetX !==
          "undefined" ? a.offsetX : a.layerX - a.currentTarget.offsetLeft) >= d.width - o)
        }, true);
        c.addEventListener("mousemove", function (a) {
          if (!DlhSoft.Controls.GanttChartView.isGripperDragging && !(c.isGripperDragging || typeof a.offsetX === "undefined" && a.currentTarget != c)) m((typeof a.offsetX !== "undefined" ? a.offsetX : a.layerX - a.currentTarget.offsetLeft) >= d.width - o)
        }, true);
        e.addEventListener("mouseover", function (a) {
          !DlhSoft.Controls.GanttChartView.isGripperDragging && (!c.isGripperDragging && !(typeof a.offsetX !== "undefined" ||
            a.currentTarget != e)) && m(a.layerX - a.currentTarget.offsetLeft >= d.width - o)
        }, false);
        e.addEventListener("mousemove", function (a) {
          !DlhSoft.Controls.GanttChartView.isGripperDragging && (!c.isGripperDragging && !(typeof a.offsetX !== "undefined" || a.currentTarget != e)) && m(a.layerX - a.currentTarget.offsetLeft >= d.width - o)
        }, false);
        c.addEventListener("mousedown", function (a) {
          if (!(a.button != 0 || !c.isGripperVisible || DlhSoft.Controls.GanttChartView.isGripperDragging)) {
            DlhSoft.Controls.GanttChartView.isGripperDragging = true;
            c.isGripperDragging = true;
            c.initialGripperDraggingX = a.clientX;
            c.initialColumnWidth = d.width
          }
        }, true);
        a.addEventListener("mousemove", function (a) {
          if (c.isGripperDragging) {
            d.width = Math.max(d.minWidth, c.initialColumnWidth + (a.clientX - c.initialGripperDraggingX));
            if (typeof d.maxWidth !== "undefined" && d.width > d.maxWidth) d.width = d.maxWidth;
            e.style.width = d.width - 1 + "px";
            typeof b.columnWidthChangeHandler !== "undefined" && setTimeout(function () {
              b.columnWidthChangeHandler(d, d.width)
            }, 0);
            if (!g.isWaitingToRefreshColumns) {
              g.isWaitingToRefreshColumns =
                true;
              setTimeout(function () {
                var a = Wa(b.columns);
                g.gridHeader.style.width = a + "px";
                g.gridContent.style.width = a + "px";
                delete g.isWaitingToRefreshColumns;
                g.refreshGridItems()
              }, 0)
            }
          }
        }, true);
        a.addEventListener("mouseup", function () {
          if (c.isGripperDragging) {
            delete c.isGripperDragging;
            delete c.initialGripperDraggingX;
            delete c.initialColumnWidth;
            m(false);
            delete DlhSoft.Controls.GanttChartView.isGripperDragging
          }
        }, true);
        c.addEventListener("mouseout", function () {
          c.isGripperDragging || m(false)
        }, false)
      }
      return c
    }, Ka = function (a,
                      d) {
      for (var b = -1, c = null, e = null, f = [], g = 0; g < a.length; g++) {
        var m = a[g];
        if (typeof m.isSelected === "undefined") m.isSelected = false;
        if (m.isSelected) {
          e == null && (e = m);
          f.push(m)
        }
        if (typeof m.indentation === "undefined") m.indentation = 0;
        if (g == 0 && m.indentation != 0) {
          m.indentation = 0;
          u(m, "indentation", false, true)
        }
        if (typeof m.isExpanded === "undefined") m.isExpanded = true;
        if (c != null) {
          var o = c.indentation + 1;
          if (m.indentation > o) {
            m.indentation = o;
            u(m, "indentation", false, true)
          }
          c.hasChildren = m.indentation > c.indentation;
          if (c.hasChildren &&
            typeof c.isMilestone !== "undefined" && c.isMilestone) {
            c.isMilestone = false;
            u(c, "isMilestone", false, true)
          }
        }
        m.isVisible = b < 0 || m.indentation <= b;
        if (!m.isExpanded && b < 0) b = m.indentation;
        m.isExpanded && m.indentation == b && (b = -1);
        c = m
      }
      if (c != null) c.hasChildren = false;
      d.selectedItem = e;
      d.selectedItems = f
    }, La = function (a, d, b) {
      b.isTimingInformationInitialized = false;
      b.isBasicTimingInformationInitialized = false;
      var c = W(d.currentTime), e = [], f, g, m;
      for (g = 0; g < a.length; g++) {
        f = a[g];
        f.index = g;
        var o = null;
        for (e.length > 0 && (o = e[e.length -
        1]); o != null && f.indentation <= o.indentation;) {
          e.pop();
          o = e[e.length - 1]
        }
        f.parent = o;
        f.children = [];
        o != null && o.children.push(f);
        if (!f.hasChildren || !(typeof f.isSummaryEnabled === "undefined" || f.isSummaryEnabled)) {
          m = f.start;
          var n = f.finish, p = f.completedFinish;
          if (typeof f.start === "undefined") {
            f.start = c;
            f.preferredStart = f.start
          }
          if (typeof f.finish === "undefined") f.finish = typeof f.isMilestone === "undefined" || !f.isMilestone ? Y(c) : f.start;
          if (typeof f.isSetAsCompleted === "undefined") f.isSetAsCompleted = typeof f.completedFinish !==
            "undefined" && f.completedFinish.valueOf() == f.finish.valueOf();
          if (typeof f.completedFinish === "undefined") f.completedFinish = f.start;
          if (typeof f.isRelativeToTimezone === "undefined" || f.isRelativeToTimezone) {
            f.start = new Date(f.start.valueOf() - f.start.getTimezoneOffset() * 6E4);
            f.preferredStart = f.start;
            f.finish = new Date(f.finish.valueOf() - f.finish.getTimezoneOffset() * 6E4);
            f.completedFinish = typeof f.completedFinish === "number" ? K(f.start, f.completedFinish * O(f.start, f.finish, d, f.schedule), d, f.schedule) : new Date(f.completedFinish.valueOf() -
              f.completedFinish.getTimezoneOffset() * 6E4);
            if (typeof f.baselineStart !== "undefined") f.baselineStart = new Date(f.baselineStart.valueOf() - f.baselineStart.getTimezoneOffset() * 6E4);
            if (typeof f.baselineFinish !== "undefined") f.baselineFinish = new Date(f.baselineFinish.valueOf() - f.baselineFinish.getTimezoneOffset() * 6E4);
            if (typeof f.minStart !== "undefined") f.minStart = new Date(f.minStart.valueOf() - f.minStart.getTimezoneOffset() * 6E4);
            if (typeof f.maxStart !== "undefined") f.maxStart = new Date(f.maxStart.valueOf() - f.maxStart.getTimezoneOffset() *
              6E4);
            if (typeof f.minFinish !== "undefined") f.minFinish = new Date(f.minFinish.valueOf() - f.minFinish.getTimezoneOffset() * 6E4);
            if (typeof f.maxFinish !== "undefined") f.maxFinish = new Date(f.maxFinish.valueOf() - f.maxFinish.getTimezoneOffset() * 6E4);
            f.isRelativeToTimezone = false
          } else if (typeof f.completedFinish === "number") f.completedFinish = K(f.start, f.completedFinish * O(f.start, f.finish, d, f.schedule), d, f.schedule);
          if (typeof f.minStart !== "undefined" && f.start < f.minStart) f.start = f.minStart; else if (typeof f.maxStart !==
            "undefined" && f.start > f.maxStart) f.start = f.maxStart;
          if (typeof f.maxFinish !== "undefined" && f.finish > f.maxFinish) f.finish = f.maxFinish; else if (typeof f.minFinish !== "undefined" && f.finish < f.minFinish) f.finish = f.minFinish;
          if (f.finish < f.start) f.finish = f.start;
          if (f.completedFinish < f.start) f.completedFinish = f.start; else if (f.completedFinish > f.finish) f.completedFinish = f.finish;
          if (typeof f.loadChartItem === "undefined") f.start = F(f.start, d, true, typeof f.isMilestone !== "undefined" && f.isMilestone, f.schedule);
          typeof f.dependsOf !==
          "undefined" && delete f.dependsOf;
          f.preferredStart = f.start;
          if (typeof f.loadChartItem === "undefined") {
            f.finish = F(f.finish, d, typeof f.isMilestone !== "undefined" && f.isMilestone, true, f.schedule);
            f.completedFinish = F(f.completedFinish, d, typeof f.isMilestone !== "undefined" && f.isMilestone, true, f.schedule)
          }
          if (f.finish < f.start) f.finish = f.start;
          if (typeof f.isMilestone === "undefined") f.isMilestone = !(f.hasChildren && (typeof f.isSummaryEnabled === "undefined" || f.isSummaryEnabled)) && f.finish.valueOf() == f.start.valueOf();
          if (f.completedFinish < f.start) f.completedFinish = f.start;
          if (f.completedFinish > f.finish) f.completedFinish = f.finish;
          if (typeof f.isSetAsCompleted !== "undefined" && (!f.isMilestone || f.completedFinish.valueOf() < f.finish.valueOf())) f.isSetAsCompleted = false;
          (typeof m === "undefined" || f.start.valueOf() != m.valueOf()) && u(f, "start", false, true);
          (typeof n === "undefined" || f.finish.valueOf() != n.valueOf()) && u(f, "finish", false, true);
          (typeof p === "undefined" || f.completedFinish.valueOf() != p.valueOf()) && u(f, "completedFinish",
            false, true)
        }
        for (m = 0; m < e.length; m++) {
          n = e[m];
          if (typeof n.start === "undefined" || n.start > f.start) {
            n.start = f.start;
            u(n, "start", false, true)
          }
          if (typeof n.finish === "undefined" || n.finish < f.finish) {
            n.finish = f.finish;
            u(n, "finish", false, true)
          }
          if (typeof n.completedFinish === "undefined" || n.completedFinish.valueOf() != n.start.valueOf()) {
            n.completedFinish = n.start;
            u(n, "completedFinish", false, true)
          }
        }
        (o == null || f.indentation > o.indentation) && e.push(f)
      }
      b.isBasicTimingInformationInitialized = true;
      for (g = a.length; g-- > 0;) {
        f = a[g];
        f.hasChildren && (typeof f.isSummaryEnabled === "undefined" || f.isSummaryEnabled) && Ma(f)
      }
      if (d.areTaskDependencyConstraintsEnabled) for (g = 0; g < a.length; g++) {
        f = a[g];
        typeof f.predecessors !== "undefined" && (f.predecessors != null && f.predecessors.length > 0) && ya(f, a, d, b)
      }
      b.isTimingInformationInitialized = true
    }, Ma = function (a, d) {
      if (!(a.children.length <= 0 || typeof a.isSummaryEnabled !== "undefined" && !a.isSummaryEnabled)) {
        typeof d === "undefined" && (d = true);
        var b = a.start, c = a.finish, e = a.completedFinish;
        delete a.start;
        delete a.finish;
        delete a.completedFinish;
        for (var f = 0; f <= 1; f++) {
          for (var g = 0; g < a.children.length; g++) {
            var m = a.children[g];
            if (!(typeof m.isParentSummarizationEnabled !== "undefined" && !m.isParentSummarizationEnabled && f < 1)) {
              if (typeof a.start === "undefined" || a.start > m.start) a.start = m.start;
              if (typeof a.finish === "undefined" || a.finish < m.finish) a.finish = m.finish
            }
          }
          if (typeof a.start !== "undefined" && typeof a.finish !== "undefined") break
        }
        a.completedFinish = a.start;
        (typeof b === "undefined" || a.start.valueOf() != b.valueOf()) && u(a, "start",
          false, d);
        (typeof c === "undefined" || a.finish.valueOf() != c.valueOf()) && u(a, "finish", false, d);
        (typeof e === "undefined" || a.completedFinish.valueOf() != e.valueOf()) && u(a, "completedFinish", false, d)
      }
    }, za = function (a, d) {
      var b = a.parent;
      return b == null ? false : (typeof b.isSummaryEnabled === "undefined" || b.isSummaryEnabled) && b == d ? true : za(b, d)
    }, Na = function (a, d) {
      if (typeof a.predecessors === "undefined") return false;
      for (var b = 0; b < a.predecessors.length; b++) if (a.predecessors[b].item == d) return true;
      return false
    }, W = function (a) {
      return new Date(Math.floor(a.valueOf() /
        864E5) * 864E5)
    }, ba = function (a) {
      return a.valueOf() - W(a).valueOf()
    }, da = function (a) {
      return Math.floor((a.valueOf() - 2592E5) / 864E5) % 7
    }, ma = function (a, d) {
      W(a);
      return new Date(Math.floor((a.valueOf() - 2592E5) / 6048E5) * 6048E5 + 2592E5 + d * 864E5)
    }, Za = function (a, d) {
      var b = ma(a, d);
      return Math.abs(b.valueOf() - a.valueOf()) <= 36E5 ? b : new Date(b.valueOf() + 6048E5)
    }, Oa = function (a) {
      return a.hourWidth * (a.visibleDayFinish - a.visibleDayStart) / 36E5
    }, D = function (a, d) {
      var b = Oa(d), c = Oa(d) * (d.visibleWeekFinish - d.visibleWeekStart + 1), e =
          ma(a, d.weekStartDay),
        e = Math.floor((e - d.timelineStart) / 6048E5) * c - Math.max(0, d.weekStartDay - d.visibleWeekStart) * b,
        c = da(a),
        e = c <= d.visibleWeekStart ? e + 0 : c > d.visibleWeekFinish ? e + (d.visibleWeekFinish - d.visibleWeekStart + 1) * b : e + (c - d.visibleWeekStart) * b,
        b = ba(a);
      c >= d.visibleWeekStart && c <= d.visibleWeekFinish && (e = b <= d.visibleDayStart ? e + 0 : b >= d.visibleDayFinish ? e + (d.visibleDayFinish - d.visibleDayStart) / 36E5 * d.hourWidth : e + (b - d.visibleDayStart) / 36E5 * d.hourWidth);
      return e
    }, Aa = function (a, d) {
      for (var b = d.timelineStart.valueOf(),
             c = Oa(d), e = Oa(d) * (d.visibleWeekFinish - d.visibleWeekStart + 1); a > e;) {
        b = b + 6048E5;
        a = a - e
      }
      for (b = b + Math.max(0, d.visibleWeekStart - d.weekStartDay) * 864E5; a > c;) {
        b = b + 864E5;
        a = a - c
      }
      b = b + d.visibleDayStart;
      b = b + a / d.hourWidth * 36E5;
      return new Date(b)
    }, nb = function (a) {
      switch (a.theme) {
        default:
          return [{
            scaleType: "NonworkingTime",
            isHeaderVisible: false,
            isHighlightingVisible: true,
            highlightingStyle: "stroke-width: 0; fill: #f4f4f4; fill-opacity: 0.65"
          }, {scaleType: "Weeks", headerTextFormat: "Date", headerStyle: "padding: 2.25px"}, {
            scaleType: "Days",
            headerTextFormat: "DayOfWeekAbbreviation", headerStyle: "padding: 2.25px"
          }, {
            scaleType: "CurrentTime",
            isHeaderVisible: false,
            isSeparatorVisible: true,
            separatorStyle: "stroke: #8bbf8a; stroke-width: 0.5px"
          }];
        case "ModernBordered":
          return [{
            scaleType: "NonworkingTime",
            isHeaderVisible: false,
            isHighlightingVisible: true,
            highlightingStyle: "stroke-width: 0; fill: #f4f4f4; fill-opacity: 0.65"
          }, {
            scaleType: "Weeks",
            headerTextFormat: "Date",
            headerStyle: "padding: 2.25px; border-right: solid 1px White; border-bottom: solid 1px White",
            isSeparatorVisible: true,
            separatorStyle: "stroke: #c8bfe7; stroke-width: 0.5px"
          }, {
            scaleType: "Days",
            headerTextFormat: "DayOfWeekAbbreviation",
            headerStyle: "padding: 2.25px; border-right: solid 1px White"
          }, {
            scaleType: "CurrentTime",
            isHeaderVisible: false,
            isSeparatorVisible: true,
            separatorStyle: "stroke: #8bbf8a; stroke-width: 1px"
          }];
        case "Aero":
          return [{
            scaleType: "NonworkingTime",
            isHeaderVisible: false,
            isHighlightingVisible: true,
            highlightingStyle: "stroke-width: 0; fill: #f4f4f4; fill-opacity: 0.65"
          }, {
            scaleType: "Weeks",
            headerTextFormat: "Date",
            headerStyle: "padding: 2.25px; border-right: solid 1px #c8bfe7; border-bottom: solid 1px #c8bfe7",
            isSeparatorVisible: true,
            separatorStyle: "stroke: #c8bfe7; stroke-width: 0.5px"
          }, {
            scaleType: "Days",
            headerTextFormat: "DayOfWeekAbbreviation",
            headerStyle: "padding: 2.25px; border-right: solid 1px #c8bfe7"
          }, {
            scaleType: "CurrentTime",
            isHeaderVisible: false,
            isSeparatorVisible: true,
            separatorStyle: "stroke: Black; stroke-width: 1px"
          }]
      }
    }, ia = function (a, d) {
      return new Date(Math.floor((a - 2592E5).valueOf() /
        d.updateScale) * d.updateScale + 2592E5)
    }, Ya = function (a, d, b, c, e) {
      typeof e === "undefined" && (e = false);
      var f = a.ownerDocument, g = 0, m, o;
      for (m = 0; m < b.length; m++) {
        o = b[m];
        (typeof o.isHeaderVisible === "undefined" || o.isHeaderVisible) && g++
      }
      var n = c.headerHeight;
      g > 0 && (n = c.headerHeight / g);
      for (m = 0; m < b.length; m++) {
        o = b[m];
        if (!e || !(o.scaleType != "CurrentTime" && o.scaleType != "FutureTime")) {
          g = qc(o, c);
          if (typeof g !== "undefined") {
            g.length == 0 && g.push({start: c.timelineStart, finish: c.timelineFinish});
            var p = n;
            if (typeof o.headerHeight !==
              "undefined") p = o.headerHeight;
            for (var h = c.timelineStart, C = 0; C < g.length; C++) {
              var j = g[C], A = j.start, k = j.finish;
              if (o.scaleType != "CurrentTime" && o.scaleType != "FutureTime" && o.scaleType != "NonworkingTime") {
                if (A > h && (typeof o.isHeaderVisible === "undefined" || o.isHeaderVisible)) A = h;
                A < h && (A = h);
                if (A < c.timelineStart) A = c.timelineStart;
                if (k > c.timelineFinish) k = c.timelineFinish;
                k < A && (k = A);
                if (C == g.length - 1 && k < c.timelineFinish && (typeof o.isHeaderVisible === "undefined" || o.isHeaderVisible)) k = c.timelineFinish;
                j.start = A;
                h = j.finish =
                  k
              }
              var A = D(A, c), k = D(k, c), q = k - A;
              if (!(q <= 0)) {
                if (typeof o.isHeaderVisible === "undefined" || o.isHeaderVisible) {
                  var j = rc(o, j, c), l = f.createElement("div");
                  l.setAttribute("style", "float: left; overflow: hidden; width: " + q + "px; height: " + p + "px");
                  var s = f.createElement("div");
                  s.setAttribute("class", o.headerClass);
                  s.setAttribute("style", o.headerStyle);
                  s.appendChild(E(f, j));
                  l.appendChild(s);
                  a.appendChild(l)
                }
                j = false;
                if (typeof o.isHighlightingVisible !== "undefined") j = o.isHighlightingVisible;
                if (j) {
                  j = f.createElementNS("http://www.w3.org/2000/svg",
                    "rect");
                  j.setAttribute("x", A - 1);
                  j.setAttribute("y", 0);
                  j.setAttribute("width", q);
                  j.setAttribute("height", 0);
                  j.setAttribute("class", o.highlightingClass);
                  j.setAttribute("style", o.highlightingStyle);
                  j.tag = "Scale-Highlighting" + (o.scaleType != "CurrentTime" && o.scaleType != "FutureTime" ? "" : "-CurrentTime");
                  d.appendChild(j)
                }
                A = false;
                if (typeof o.isSeparatorVisible !== "undefined") A = o.isSeparatorVisible;
                if (A) {
                  A = f.createElementNS("http://www.w3.org/2000/svg", "line");
                  A.setAttribute("x1", k - 0.75);
                  A.setAttribute("y1", 0);
                  A.setAttribute("x2", k - 0.75);
                  A.setAttribute("y2", 0);
                  A.setAttribute("class", o.separatorClass);
                  A.setAttribute("style", o.separatorStyle);
                  A.tag = "Scale-Separator" + (o.scaleType != "CurrentTime" && o.scaleType != "FutureTime" ? "" : "-CurrentTime");
                  d.appendChild(A)
                }
              }
            }
          }
        }
      }
    }, qc = function (a, d) {
      var b = "Custom", c;
      if (typeof a.scaleType !== "undefined") b = a.scaleType;
      switch (b) {
        case "CurrentTime":
          return [{start: d.timelineStart, finish: d.currentTime}];
        case "FutureTime":
          return [{start: d.currentTime, finish: d.timelineFinish}];
        case "Years":
          b =
            [];
          c = new Date(d.timelineStart.valueOf());
          var e = c.getTimezoneOffset();
          c.setMonth(0, 1);
          var f = c.getTimezoneOffset();
          for (c = new Date(c.valueOf() - (f - e) * 6E4 - (f > 0 ? 864E5 : 0)); nd = sc(c), c < d.timelineFinish; c = nd) b.push({
            start: c,
            finish: nd
          });
          return b;
        case "Months":
          b = [];
          c = new Date(d.timelineStart.valueOf());
          e = c.getTimezoneOffset();
          c.setDate(1);
          f = c.getTimezoneOffset();
          for (c = new Date(c.valueOf() - (f - e) * 6E4 - (f > 0 ? 864E5 : 0)); nd = tc(c), c < d.timelineFinish; c = nd) b.push({
            start: c,
            finish: nd
          });
          return b;
        case "Weeks":
          b = [];
          c = d.timelineStart;
          e = d.weekStartDay;
          for (f = d.visibleWeekStart; da(c) != e;) c = Ba(c);
          for (; da(c) < f;) c = Y(c);
          for (c = new Date(c.valueOf()); nd = new Date(c.valueOf() + 6048E5), c < d.timelineFinish; c = nd) b.push({
            start: c,
            finish: nd
          });
          return b;
        case "Days":
          b = [];
          for (c = d.timelineStart; nd = Y(c), c < d.timelineFinish; c = nd) b.push({start: c, finish: nd});
          return b;
        case "Hours":
          b = [];
          for (c = new Date(W(d.timelineStart).valueOf() + d.visibleDayStart); nd = uc(new Date(c.valueOf() + 36E5), d.visibleDayFinish, d.visibleDayStart), c < d.timelineFinish; c = nd) b.push({
            start: c,
            finish: nd
          });
          return b;
        case "NonworkingTime":
          b = [];
          c = d.timelineStart;
          for (e = d.workingWeekFinish; da(c) != e;) c = Ba(c);
          e = c = Y(c);
          for (f = d.workingWeekStart; da(e) != f;) e = Y(e);
          for (nd = new Date(e.valueOf()); c < d.timelineFinish; c = new Date(c.valueOf() + 6048E5), nd = new Date(nd.valueOf() + 6048E5)) b.push({
            start: c,
            finish: nd
          });
          if (typeof d.specialNonworkingDays !== "undefined") for (e = 0; e < d.specialNonworkingDays.length; e++) {
            c = d.specialNonworkingDays[e];
            nd = Y(c);
            b.push({start: c, finish: nd})
          }
          return b;
        default:
          return a.intervals
      }
    }, uc =
      function (a, d, b) {
        if (ba(a) > d) {
          a = Y(a);
          return new Date(W(a).valueOf() + b)
        }
        return new Date(a.valueOf())
      }, Y = function (a) {
      return new Date(a.valueOf() + 864E5)
    }, Ba = function (a) {
      return new Date(a.valueOf() - 864E5)
    }, tc = function (a) {
      var d = a.getTimezoneOffset(), a = new Date(a.valueOf() + (d > 0 ? 864E5 : 0)), b = a.getMonth() + 1;
      if (b >= 12) {
        b = 0;
        a.setFullYear(a.getFullYear() + 1)
      }
      a.setMonth(b, 1);
      b = a.getTimezoneOffset();
      return new Date(a.valueOf() - (b - d) * 6E4 - (b > 0 ? 864E5 : 0))
    }, sc = function (a) {
      var d = a.getTimezoneOffset(), a = new Date(a.valueOf() +
        (d > 0 ? 864E5 : 0));
      a.setFullYear(a.getFullYear() + 1);
      a.setMonth(0, 1);
      var b = a.getTimezoneOffset();
      return new Date(a.valueOf() - (b - d) * 6E4 - (b > 0 ? 864E5 : 0))
    }, Ab = function (a, d) {
      if (typeof d === "undefined") return false;
      for (var b = a.valueOf(), c = 0; c < d.length; c++) if (d[c].valueOf() == b) return true;
      return false
    }, rc = function (a, d, b) {
      var c = "Date";
      if (typeof a.headerTextFormat !== "undefined") c = a.headerTextFormat;
      a = d.start;
      if (a < b.timelineStart) a = b.timelineStart;
      switch (c) {
        case "Localized":
          return a.toLocaleString();
        case "DateTime":
          return b.dateTimeFormatter(h(a));
        case "Date":
          return b.dateFormatter(h(a));
        case "Hour":
          a = new Date(a.valueOf() + a.getTimezoneOffset() * 6E4);
          return (a.getHours() < 10 ? "0" : "") + a.getHours();
        case "DayOfWeek":
          return b.daysOfWeek[da(a)];
        case "DayOfWeekAbbreviation":
          d = b.daysOfWeek[da(a)];
          return d.length > 0 ? d[0].toUpperCase() : "";
        case "Day":
          a = new Date(a.valueOf() + a.getTimezoneOffset() * 6E4);
          return (a.getDate() < 10 ? "0" : "") + a.getDate();
        case "Month":
          return b.months[(new Date(a.valueOf() + a.getTimezoneOffset() * 6E4)).getMonth()];
        case "MonthAbbreviation":
          d =
            b.months[(new Date(a.valueOf() + a.getTimezoneOffset() * 6E4)).getMonth()];
          return d.length <= 0 ? "" : d[0].toUpperCase() + (d.length > 1 ? d.substr(1, Math.min(3, d.length) - 1) : "");
        case "Year":
          return (new Date(a.valueOf() + a.getTimezoneOffset() * 6E4)).getFullYear();
        default:
          return d.headerText
      }
    }, kc = function (a, d, b, c, e, f, g) {
      for (var m = 0, o = 0; o < c.length; o++) {
        var n = c[o];
        g.isGridVisible && typeof n.displayRowIndex === "undefined" && a.appendChild(Bb(n, c, e, d, f, g));
        var p = m;
        typeof n.displayRowIndex !== "undefined" && (p = n.displayRowIndex *
          g.itemHeight);
        b.appendChild(Cb(n, p, g));
        n.isVisible && !(typeof n.isHidden !== "undefined" && n.isHidden) && (m = Math.max(m, p + g.itemHeight));
        n.itemTop = p
      }
      ea(d, m);
      setTimeout(function () {
        Pa(c, d, g)
      }, 0)
    }, fa = function (a, d) {
      for (var b = 0, c = 0; c < a.length; c++) {
        var e = a[c];
        e.isVisible && !(typeof e.isHidden !== "undefined" && e.isHidden) && (b = typeof e.displayRowIndex === "undefined" ? b + d.itemHeight : Math.max(b, e.itemTop + d.itemHeight))
      }
      return b
    }, qa = function (a, d, b) {
      var c;
      if (typeof a.displayRowIndex !== "undefined") {
        c = a.displayRowIndex * b.itemHeight;
        return a.itemTop = c
      }
      for (var e = c = 0; e < d.length; e++) {
        var f = d[e];
        if (f == a) break;
        f.isVisible && (!(typeof f.isHidden !== "undefined" && f.isHidden) && typeof f.displayRowIndex === "undefined") && (c = c + b.itemHeight)
      }
      return a.itemTop = c
    }, Pa = function (a, d, b) {
      if (!(typeof b.alternativeItemClass === "undefined" && typeof b.alternativeItemStyle === "undefined")) {
        var c = d.chartAreaAlternativeRows, e, f = 0;
        c.count = f;
        for (e = 0; e < a.length; e++) {
          var g = a[e];
          if (g.isVisible && typeof g.alternativeContentContainer !== "undefined") {
            g = g.alternativeContentContainer;
            if (f % 2 == 1) {
              typeof b.alternativeItemClass !== "undefined" && g.setAttribute("class", b.alternativeItemClass);
              typeof b.alternativeItemStyle !== "undefined" && g.setAttribute("style", b.alternativeItemStyle);
              if (typeof c.count === "undefined" || f > c.count) {
                g = document.createElementNS("http://www.w3.org/2000/svg", "rect");
                g.setAttribute("x", 0);
                g.setAttribute("y", f * b.itemHeight);
                g.setAttribute("width", d.clientWidth);
                g.setAttribute("height", b.itemHeight);
                typeof b.alternativeChartItemClass !== "undefined" && g.setAttribute("class",
                  b.alternativeChartItemClass);
                typeof b.alternativeChartItemStyle !== "undefined" && g.setAttribute("style", b.alternativeChartItemStyle);
                g.index = f;
                c.appendChild(g)
              }
              c.count = f
            } else {
              g.setAttribute("class", "");
              g.setAttribute("style", "")
            }
            f++
          }
        }
        for (e = c.childNodes.length; e-- > 0;) {
          a = c.childNodes[e];
          a.index > c.count && c.removeChild(a)
        }
      }
    }, Bb = function (a, d, b, c, e, f) {
      var g = a.ganttChartView.ownerDocument, m = g.createElement("div");
      typeof f.itemClass !== "undefined" && m.setAttribute("class", f.itemClass);
      typeof f.itemStyle !== "undefined" &&
      m.setAttribute("style", f.itemStyle);
      var o = g.createElement("div");
      a.alternativeContentContainer = o;
      var n = g.createElement("div");
      try {
        n.addEventListener("mousedown", function () {
          t(a, f)
        }, false);
        n.addEventListener("mouseup", function () {
          t(a, f)
        }, false)
      } catch (p) {
      }
      if (a.isSelected) {
        typeof f.selectedItemClass !== "undefined" && n.setAttribute("class", f.selectedItemClass);
        typeof f.selectedItemStyle !== "undefined" && n.setAttribute("style", f.selectedItemStyle)
      }
      var h = g.createElement("div");
      typeof a["class"] !== "undefined" &&
      h.setAttribute("class", a["class"]);
      typeof a.style !== "undefined" && h.setAttribute("style", a.style);
      var C = g.createElement("div");
      if (a.hasChildren && (typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled)) {
        typeof f.summaryItemClass !== "undefined" && C.setAttribute("class", f.summaryItemClass);
        typeof f.summaryItemStyle !== "undefined" && C.setAttribute("style", f.summaryItemStyle)
      } else if (a.isMilestone) {
        typeof f.milestoneItemClass !== "undefined" && C.setAttribute("class", f.milestoneItemClass);
        typeof f.milestoneItemStyle !==
        "undefined" && C.setAttribute("style", f.milestoneItemStyle)
      } else {
        typeof f.standardItemClass !== "undefined" && C.setAttribute("class", f.standardItemClass);
        typeof f.standardItemStyle !== "undefined" && C.setAttribute("style", f.standardItemStyle)
      }
      g = g.createElement("div");
      a.gridItem = g;
      a.gridItemContent = C;
      a.gridItemSelectionContainer = n;
      var j = f.itemHeight;
      if (!a.isVisible || typeof a.isHidden !== "undefined" && a.isHidden) j = 0;
      g.setAttribute("style", "overflow: hidden; height: " + j + "px");
      na(g, a, d, b, c, e, f);
      C.appendChild(g);
      h.appendChild(C);
      n.appendChild(h);
      o.appendChild(n);
      m.appendChild(o);
      a.gridItemContainer = m;
      (typeof f.isGridRowClickTimeScrollingEnabled === "undefined" || f.isGridRowClickTimeScrollingEnabled) && m.addEventListener("mouseup", function () {
        var b;
        if (typeof a.ganttChartItems === "undefined") b = a.start; else {
          b = null;
          for (var d = 0; d < a.ganttChartItems.length; d++) if (b == null || a.ganttChartItems[d].start < b) b = a.ganttChartItems[d].start;
          b = b == null ? a.start : b
        }
        b = D(b, f);
        d = b - f.hourWidth * 8;
        b - d >= c.container.clientWidth / 2.5 && (d = b);
        c.container.scrollLeft =
          Math.max(0, d)
      }, true);
      return m
    }, na = function (a, d, b, c, e, f, g) {
      var m = d.ganttChartView.ownerDocument;
      (!g.isVirtualizing || typeof d.isVirtuallyVisible !== "undefined" && d.isVirtuallyVisible) && setTimeout(function () {
        if (typeof d.gridItemSelectionContainer !== "undefined") {
          var o = d.gridItemSelectionContainer;
          typeof g.selectedItemClass !== "undefined" && o.setAttribute("class", d.isSelected ? g.selectedItemClass : null);
          typeof g.selectedItemStyle !== "undefined" && o.setAttribute("style", d.isSelected ? g.selectedItemStyle : null)
        }
        if (typeof d.gridItemContent !==
          "undefined") {
          o = d.gridItemContent;
          o.setAttribute("class", "");
          o.setAttribute("style", "");
          if (d.hasChildren && (typeof d.isSummaryEnabled === "undefined" || d.isSummaryEnabled)) {
            typeof g.summaryItemClass !== "undefined" && o.setAttribute("class", g.summaryItemClass);
            typeof g.summaryItemStyle !== "undefined" && o.setAttribute("style", g.summaryItemStyle)
          } else if (d.isMilestone) {
            typeof g.milestoneItemClass !== "undefined" && o.setAttribute("class", g.milestoneItemClass);
            typeof g.milestoneItemStyle !== "undefined" && o.setAttribute("style",
              g.milestoneItemStyle)
          } else {
            typeof g.standardItemClass !== "undefined" && o.setAttribute("class", g.standardItemClass);
            typeof g.standardItemStyle !== "undefined" && o.setAttribute("style", g.standardItemStyle)
          }
        }
        var o = [], n = null;
        try {
          n = m.activeElement
        } catch (p) {
        }
        for (; n != null && n != d.gridItem;) {
          o.push(n);
          n = n.parentNode
        }
        for (var h = -1, n = a.childNodes.length; n-- > 0;) if (o.indexOf(a.childNodes[n]) >= 0) {
          h = n;
          break
        }
        for (n = a.childNodes.length; n-- > 0;) a.removeChild(a.childNodes[n]);
        for (n = 0; n < c.length; n++) a.appendChild(Db(d, b, c[n],
          e, f, g));
        typeof d.ganttChartView.draggingItem === "undefined" && h >= 0 && setTimeout(function () {
          try {
            for (var b = a.childNodes[h]; b.nodeName != "input" && b.nodeName != "textarea" && b.nodeName != "label" && b.nodeName != "select" && b.nodeName != "button" && b.childNodes.length > 0;) b = b.childNodes[0];
            b && b.dontAutoFocus ? delete b.dontAutoFocus : setTimeout(function () {
              try {
                b.focus()
              } catch (a) {
              }
            }, 0)
          } catch (c) {
          }
        }, 0)
      }, 0)
    }, Ca = function (a) {
      if (typeof a.isWaitingToRefreshGridItem === "undefined") {
        a.isWaitingToRefreshGridItem = true;
        setTimeout(function () {
          typeof a.gridItem !==
          "undefined" && na(a.gridItem, a, a.ganttChartView.items, a.ganttChartView.settings.columns, a.ganttChartView.chartContent, a.ganttChartView.settings.toggleButtonAreaWidth, a.ganttChartView.settings);
          delete a.isWaitingToRefreshGridItem
        }, 0)
      }
    }, vc = function (a, d, b, c, e, f, g) {
      var m = d.ganttChartView.ownerDocument;
      (!g.isVirtualizing || typeof d.isVirtuallyVisible !== "undefined" && d.isVirtuallyVisible) && setTimeout(function () {
        if (typeof d.gridItemSelectionContainer !== "undefined") {
          var o = d.gridItemSelectionContainer;
          typeof g.selectedItemClass !==
          "undefined" && o.setAttribute("class", d.isSelected ? g.selectedItemClass : null);
          typeof g.selectedItemStyle !== "undefined" && o.setAttribute("style", d.isSelected ? g.selectedItemStyle : null)
        }
        var o = [], n = null;
        try {
          n = m.activeElement
        } catch (p) {
        }
        for (; n != null && n != d.gridItem;) {
          o.push(n);
          n = n.parentNode
        }
        for (var h = -1, n = a.childNodes.length; n-- > 0;) if (a.childNodes[n].isSelection && o.indexOf(a.childNodes[n]) >= 0) {
          h = n;
          break
        }
        for (n = a.childNodes.length; n-- > 0;) a.childNodes[n].isSelection && a.removeChild(a.childNodes[n]);
        for (n = 0; n <
        c.length; n++) c[n].isSelection && n < a.childNodes.length && a.insertBefore(Db(d, b, c[n], e, f, g), a.childNodes[n]);
        typeof d.ganttChartView.draggingItem === "undefined" && h >= 0 && setTimeout(function () {
          try {
            for (var b = a.childNodes[h]; b.nodeName != "input" && b.nodeName != "textarea" && b.nodeName != "label" && b.nodeName != "select" && b.nodeName != "button" && b.childNodes.length > 0;) b = b.childNodes[0];
            b && b.dontAutoFocus ? delete b.dontAutoFocus : setTimeout(function () {
              try {
                b.focus()
              } catch (a) {
              }
            }, 0)
          } catch (c) {
          }
        }, 0)
      }, 0)
    }, zb = function (a) {
      typeof a.gridItem !==
      "undefined" && vc(a.gridItem, a, a.ganttChartView.items, a.ganttChartView.settings.columns, a.ganttChartView.chartContent, a.ganttChartView.settings.toggleButtonAreaWidth, a.ganttChartView.settings)
    }, Db = function (a, d, b, c, e, f) {
      var g = a.ganttChartView.ownerDocument, m = g.createElement("div"), o = 0;
      b.isTreeView == true && (o = f.indentationLevelWidth * a.indentation);
      m.setAttribute("style", "overflow: hidden; vertical-align: middle; display: table-cell; margin: 0px; padding: 0px; width: " + (b.width - o) + "px; height: " + f.itemHeight +
        "px; padding-left: " + o + "px");
      var n = g.createElement("div");
      typeof b.cellClass !== "undefined" ? n.setAttribute("class", b.cellClass) : typeof f.cellClass !== "undefined" && n.setAttribute("class", f.cellClass);
      typeof b.cellStyle !== "undefined" ? n.setAttribute("style", b.cellStyle) : typeof f.cellStyle !== "undefined" && n.setAttribute("style", f.cellStyle);
      var p = g.createElement("div");
      p.setAttribute("style", "white-space: nowrap; overflow: hidden; margin: 0px; padding: 0px; width: " + (b.width - o - e) + "px");
      if (b.isTreeView ==
        true) {
        o = g.createElement("div");
        o.setAttribute("style", "display: inline-block; width: " + e + "px");
        if (a.hasChildren) {
          e = g.createElement("div");
          e.setAttribute("style", "cursor: default; padding: 2px; font-size: 12px; display: inline-block");
          g = f.collapsedToggleButtonTemplate;
          if (a.isExpanded) g = f.expandedToggleButtonTemplate;
          g = g();
          e.appendChild(g);
          Eb(e, a, d, g, c, null, null, f);
          o.appendChild(e)
        }
        p.appendChild(o)
      }
      a = b.cellTemplate(a);
      p.appendChild(a);
      n.appendChild(p);
      m.appendChild(n);
      m.isSelection = b.isSelection;
      return m
    },
    lb = function (a, d) {
      return function () {
        var b = a.ownerDocument.createElementNS("http://www.w3.org/2000/svg", "polygon");
        b.setAttribute("points", "3.5,2.5 3.5,11.5 10.5,6.5");
        return r(b, d)
      }
    }, mb = function (a, d) {
      return function () {
        var b = a.ownerDocument.createElementNS("http://www.w3.org/2000/svg", "polygon");
        b.setAttribute("points", "2.5,3.5 11.5,3.5 6.5,10.5");
        return r(b, d)
      }
    }, Eb = function (a, d, b, c, e, f, g, m) {
      if (typeof f === "undefined" || f == null) f = c.querySelector("#PART_Button");
      f != null && Fb(f, f, m);
      if (typeof g === "undefined" ||
        g == null) g = c.querySelector("#PART_Border");
      g != null && Fb(g, f, m);
      b = {toggleButton: a, item: d, items: b, content: c, chartContent: e, settings: m};
      if (f != null) {
        f.tag = b;
        (typeof m.isExport === "undefined" || !m.isExport) && f.addEventListener("mouseup", $a, true)
      }
      if (g != null) {
        g.tag = b;
        (typeof m.isExport === "undefined" || !m.isExport) && g.addEventListener("mouseup", $a, true)
      }
      a.tag = b;
      f == null && (g == null && (typeof m.isExport === "undefined" || !m.isExport)) && a.addEventListener("mouseup", $a, true);
      c.addEventListener("keypress", function (a) {
        if (a.keyCode ==
          32) {
          a.preventDefault();
          a.stopPropagation();
          aa(d, !d.isExpanded, true)
        }
      }, true);
      d.toggleButton = a
    }, Fb = function (a, d, b) {
      if (!(typeof b.isExport !== "undefined" && b.isExport)) {
        a.addEventListener("mouseover", function () {
          typeof b.toggleButtonHoveringClass !== "undefined" && d.setAttribute("class", b.toggleButtonHoveringClass);
          typeof b.toggleButtonHoveringStyle !== "undefined" && d.setAttribute("style", b.toggleButtonHoveringStyle)
        }, true);
        a.addEventListener("mouseout", function () {
          d.setAttribute("class", b.toggleButtonClass);
          d.setAttribute("style", b.toggleButtonStyle)
        }, true)
      }
    }, $a = function (a) {
      a.stopPropagation();
      a = a.target.tag.item;
      aa(a, !a.isExpanded, true)
    }, aa = function (a, d, b, c) {
      if (a.isExpanded != d) {
        a.isExpanded = d;
        (typeof c === "undefined" || c) && u(a, "isExpanded", b, true);
        Gb(a)
      }
    }, Gb = function (a, d) {
      if (typeof a.toggleButton === "undefined") (typeof d === "undefined" || d) && setTimeout(function () {
        Gb(a, false)
      }, 0); else {
        var b = a.toggleButton, c = b.tag, e = c.settings, f = e.expandedToggleButtonTemplate,
          g = e.collapsedToggleButtonTemplate;
        a.isExpanded &&
        (g = f);
        var f = g(), g = f.querySelector("#PART_Button"), m = f.querySelector("#PART_Border");
        b.replaceChild(f, c.content);
        c.content = f;
        var o = c.items, c = c.chartContent;
        Eb(b, a, o, f, c, g, m, e);
        a.isVisible && !(typeof a.isHidden !== "undefined" && a.isHidden) && wc(o, a, c, e);
        ha(a);
        Pa(o, c, e)
      }
    }, wc = function (a, d, b, c) {
      for (var e = -1, f = false, g = false, m = false, o = 0, n, p = 0; p < a.length; p++) {
        var h = a[p];
        if (h == d) {
          f = h.isExpanded;
          e = h.indentation
        } else h.indentation <= e && (m = true);
        var j = h.chartItem;
        if (g && !m) {
          if (f) {
            n = true;
            for (var k = h.parent; k != null;) {
              if (!k.isVisible ||
                !k.isExpanded) {
                n = false;
                break
              }
              k = k.parent
            }
          } else n = false;
          if (h.isVisible != n) {
            h.isVisible = f;
            u(h, "isVisible", false, true);
            n = c.itemHeight;
            if (!h.isVisible || typeof h.isHidden !== "undefined" && h.isHidden) n = 0;
            if (typeof h.gridItem !== "undefined") h.gridItem.style.height = n + "px";
            n = "visible";
            if (!h.isVisible || typeof h.isHidden !== "undefined" && h.isHidden) n = "hidden";
            j.setAttribute("style", "visibility: " + n)
          }
        }
        if (typeof h.displayRowIndex === "undefined") {
          j.setAttribute("transform", "translate(0, " + o + ")");
          ra(h, o)
        }
        h == d && (g = true);
        n = c.itemHeight;
        if (!h.isVisible || typeof h.isHidden !== "undefined" && h.isHidden) n = 0;
        h.itemTop = o;
        typeof h.displayRowIndex === "undefined" && (o = o + n)
      }
      ea(b, o);
      sa(a, d);
      la(a, b.container, c)
    }, ra = function (a, d) {
      if (!(typeof a.parts === "undefined" || a.parts.length <= 0)) {
        for (var b = 0; b < a.parts.length; b++) {
          var c = a.parts[b];
          c.itemTop = d;
          if (typeof c.chartItem !== "undefined") {
            c.chartItem.setAttribute("transform", "translate(0, " + d + ")");
            c.chartItem.style.visibility = a.chartItem.style.visibility
          }
        }
        setTimeout(function () {
          for (var b = 0; b <
          a.parts.length; b++) {
            var c = a.parts[b];
            c.itemTop = d;
            c.chartItem.setAttribute("transform", "translate(0, " + d + ")");
            c.chartItem.style.visibility = a.chartItem.style.visibility
          }
        }, 0)
      }
    }, ea = function (a, d) {
      if (d < a.availableHeight) d = a.availableHeight;
      a.style.height = d + "px";
      var b = a.chartArea;
      b.style.height = d + "px";
      for (var c = 0; c < b.childNodes.length; c++) {
        var e = b.childNodes[c];
        if (typeof e.tag !== "undefined") switch (e.tag) {
          case "Scale-Highlighting":
          case "Scale-Highlighting-CurrentTime":
            e.setAttribute("height", d);
            break;
          case "Scale-Separator":
          case "Scale-Separator-CurrentTime":
            e.setAttribute("y2",
              d)
        }
      }
    }, sa = function (a, d) {
      var b = [], c, e, f, g;
      if (typeof d.successors === "undefined") {
        d.successors = [];
        for (e = 0; e < a.length; e++) {
          c = a[e];
          if (!(c == d || typeof c.predecessors === "undefined" || c.predecessors.length == 0)) for (f = 0; f < c.predecessors.length; f++) if (c.predecessors[f].item == d) {
            d.successors.push(c);
            break
          }
        }
      }
      for (e = 0; e < d.successors.length; e++) {
        var m = d.successors[e];
        if (typeof m.predecessors !== "undefined" && m.predecessors.length > 0) for (f = 0; f < m.predecessors.length; f++) {
          var o = m.predecessors[f].item;
          if (typeof o !== "undefined") {
            c =
              true;
            for (g = 0; g < b; g++) if (o == b[g]) {
              c = false;
              break
            }
            if (c) {
              $(o.chartItem, o, o.ganttChartView.settings);
              b.push(o)
            }
          }
        }
        if (typeof m.predecessors !== "undefined" && m.predecessors.length > 0) {
          c = true;
          for (g = 0; g < b; g++) if (typeof m !== "undefined" && m == b[g]) {
            c = false;
            break
          }
          if (c) {
            $(m.chartItem, m, m.ganttChartView.settings);
            b.push(m)
          }
        }
      }
    }, Cb = function (a, d, b) {
      var c = a.ganttChartView.ownerDocument.createElementNS("http://www.w3.org/2000/svg", "g");
      a.chartItem = c;
      var e = "visible";
      if (!a.isVisible || typeof a.isHidden !== "undefined" && a.isHidden) e =
        "hidden";
      c.setAttribute("style", "visibility: " + e + "; -ms-touch-action: pinch-zoom");
      c.setAttribute("transform", "translate(0, " + d + ")");
      ra(a, d);
      $(c, a, b);
      try {
        c.addEventListener("mousedown", function () {
          t(a, b)
        }, false);
        c.addEventListener("mouseup", function () {
          t(a, b)
        }, false)
      } catch (f) {
      }
      return c
    }, $ = function (a, d, b) {
      for (var c = a.childNodes.length; c-- > 0;) a.removeChild(a.childNodes[c]);
      if (!(b.isVirtualizing && (typeof d.isVirtuallyVisible === "undefined" || !d.isVirtuallyVisible) || typeof d.isBarVisible !== "undefined" &&
        !d.isBarVisible)) {
        c = b.standardTaskTemplate;
        if (typeof d.standardTaskTemplate !== "undefined") c = d.standardTaskTemplate;
        if (d.hasChildren && (typeof d.isSummaryEnabled === "undefined" || d.isSummaryEnabled)) {
          c = b.summaryTaskTemplate;
          if (typeof d.summaryTaskTemplate !== "undefined") c = d.summaryTaskTemplate
        } else if (d.isMilestone) {
          c = b.milestoneTaskTemplate;
          if (typeof d.milestoneTaskTemplate !== "undefined") c = d.milestoneTaskTemplate
        }
        if (typeof d.taskTemplate !== "undefined") c = d.taskTemplate;
        c = c(d);
        a.appendChild(c);
        if (typeof b.internalExtraTaskTemplate !==
          "undefined") {
          var e = b.internalExtraTaskTemplate(d);
          e != null && a.appendChild(e)
        }
        if (typeof b.extraTaskTemplate !== "undefined") {
          e = b.extraTaskTemplate(d);
          e != null && a.appendChild(e)
        }
        if (b.areTaskAssignmentsVisible) {
          e = b.assignmentsTemplate(d);
          c.appendChild(e)
        }
        if (b.isTaskToolTipVisible) {
          e = b.itemTemplate;
          if (typeof d.template !== "undefined") e = d.template;
          c.appendChild(e(d))
        }
        if (b.areTaskDependenciesVisible && typeof d.predecessors !== "undefined") for (c = 0; c < d.predecessors.length; c++) {
          e = d.predecessors[c];
          if (!((typeof d.ganttChartView ===
            "undefined" || d.ganttChartView.items.indexOf(e.item)) < 0 || !e.item.isVisible || typeof e.item.isHidden !== "undefined" && e.item.isHidden || typeof e.item.isBarVisible !== "undefined" && !e.item.isBarVisible)) {
            var f = b.dependencyLineTemplate(d, e);
            f.predecessorIndex = c;
            !b.isReadOnly && (!b.isChartReadOnly && !b.areTaskPredecessorsReadOnly && (typeof d.isReadOnly === "undefined" || !d.isReadOnly)) && f.addEventListener("contextmenu", function (a) {
              if (confirm("Are you sure you want to remove the predecessor?")) {
                for (var c = [], e = 0; e <
                d.predecessors.length; e++) if (e != this.predecessorIndex) {
                  var f = d.predecessors[e];
                  delete f.item.successors;
                  c.push(f)
                }
                d.predecessors = c;
                u(d, "predecessors", true, true);
                $(d.chartItem, d, b);
                sa(d.ganttChartView.items, d)
              }
              a.preventDefault()
            }, false);
            a.appendChild(f);
            if (b.isDependencyToolTipVisible) {
              var g = b.predecessorItemTemplate;
              if (typeof e.template !== "undefined") g = e.template;
              f.appendChild(g(d, e))
            }
          }
        }
      }
    }, Ea = function (a) {
      for (var d = 0; d < a.length; d++) Da(a[d])
    }, ha = function (a) {
      if (a.isVirtuallyVisible && typeof a.isWaitingToRefreshChartItem ===
        "undefined") {
        a.isWaitingToRefreshChartItem = true;
        setTimeout(function () {
          $(a.chartItem, a, a.ganttChartView.settings);
          var d = qa(a, a.ganttChartView.items, a.ganttChartView.settings);
          a.chartItem.setAttribute("transform", "translate(0, " + d + ")");
          ra(a, d);
          delete a.isWaitingToRefreshChartItem
        }, 0)
      }
    }, ga = function (a) {
      if (a.isVirtuallyVisible) if (typeof a.isWaitingToRefreshGridItem !== "undefined" || typeof a.isWaitingToRefreshChartItem !== "undefined") {
        typeof a.isWaitingToRefreshGridItem === "undefined" && Ca(a);
        typeof a.isWaitingToRefreshChartItem ===
        "undefined" && ha(a)
      } else {
        a.isWaitingToRefreshGridItem = true;
        a.isWaitingToRefreshChartItem = true;
        setTimeout(function () {
          typeof a.gridItem !== "undefined" && na(a.gridItem, a, a.ganttChartView.items, a.ganttChartView.settings.columns, a.ganttChartView.chartContent, a.ganttChartView.settings.toggleButtonAreaWidth, a.ganttChartView.settings);
          $(a.chartItem, a, a.ganttChartView.settings);
          var d = qa(a, a.ganttChartView.items, a.ganttChartView.settings);
          a.chartItem.setAttribute("transform", "translate(0, " + d + ")");
          ra(a, d);
          delete a.isWaitingToRefreshGridItem;
          delete a.isWaitingToRefreshChartItem
        }, 0)
      }
    }, ja = function (a) {
      if (a.isVirtuallyVisible && typeof a.isWaitingToRefreshPredecessorItems === "undefined") {
        a.isWaitingToRefreshPredecessorItems = true;
        setTimeout(function () {
          sa(a.ganttChartView.items, a);
          delete a.isWaitingToRefreshPredecessorItems
        }, 0)
      }
    }, Da = function (a) {
      if (a.isVirtuallyVisible) if (typeof a.isWaitingToRefreshGridItem !== "undefined" || typeof a.isWaitingToRefreshChartItem !== "undefined" || typeof a.isWaitingToRefreshPredecessorItems !== "undefined") {
        typeof a.isWaitingToRefreshGridItem ===
        "undefined" && Ca(a);
        typeof a.isWaitingToRefreshChartItem === "undefined" && ha(a);
        typeof a.isWaitingToRefreshPredecessorItems === "undefined" && ja(a)
      } else {
        a.isWaitingToRefreshGridItem = true;
        a.isWaitingToRefreshChartItem = true;
        a.isWaitingToRefreshPredecessorItems = true;
        setTimeout(function () {
          typeof a.gridItem !== "undefined" && na(a.gridItem, a, a.ganttChartView.items, a.ganttChartView.settings.columns, a.ganttChartView.chartContent, a.ganttChartView.settings.toggleButtonAreaWidth, a.ganttChartView.settings);
          $(a.chartItem,
            a, a.ganttChartView.settings);
          var d = qa(a, a.ganttChartView.items, a.ganttChartView.settings);
          a.chartItem.setAttribute("transform", "translate(0, " + d + ")");
          ra(a, d);
          sa(a.ganttChartView.items, a);
          delete a.isWaitingToRefreshGridItem;
          delete a.isWaitingToRefreshChartItem;
          delete a.isWaitingToRefreshPredecessorItems
        }, 0)
      }
    }, X = function (a) {
      Da(a);
      for (a = a.parent; a != null;) {
        Ma(a);
        Da(a);
        a = a.parent
      }
    }, Fa = function (a, d, b, c) {
      S(d, c);
      Ka(d, b);
      La(d, c, b);
      b = a.index - 1;
      b >= 0 && X(d[b]);
      X(a);
      b = a.index + 1;
      b < d.length && X(d[b])
    }, Qa = function (a,
                      d) {
      var b = d.toggleButtonAreaWidth;
      delete d.toggleButtonAreaWidth;
      z(a, d);
      return d.toggleButtonAreaWidth != b
    }, Hb = function (a, d, b, c, e) {
      d.ganttChartView = b;
      for (d.isVirtuallyVisible = true; a > 0 && c[a - 1].isPart;) a--;
      var f = a < c.length ? c[a] : null;
      if (f == null || f.isPart) {
        f = a > 0 ? c[a - 1] : null;
        f = f != null ? f.indentation + 1 : 0;
        if (d.indentation > f) d.indentation = f
      } else if (typeof d.indentation === "undefined" || d.indentation < f.indentation - 1 || d.indentation > f.indentation) d.indentation = f.indentation;
      S([d], e);
      c.splice(a, 0, d);
      Ka(c, b);
      La(c,
        e, b);
      var g;
      if (e.isGridVisible && typeof d.displayRowIndex === "undefined") {
        var m = null;
        if (a < c.length - 1) {
          f = c[a + 1];
          if (!f.isPart) {
            g = f.itemTop;
            if (typeof f.gridItemContainer !== "undefined") m = f.gridItemContainer
          }
        }
        b.gridContent.insertBefore(Bb(d, c, e.columns, b.chartContent, e.toggleButtonAreaWidth, e), m)
      }
      typeof g === "undefined" && (g = fa(c, e) - e.itemHeight);
      m = g;
      typeof d.displayRowIndex !== "undefined" && (m = d.displayRowIndex * e.itemHeight);
      b.chartContent.chartArea.appendChild(Cb(d, m, e));
      d.isVisible && !(typeof d.isHidden !==
        "undefined" && d.isHidden) && (g = Math.max(g, m + e.itemHeight));
      d.itemTop = m;
      if (typeof d.displayRowIndex === "undefined") for (f = a + 1; f < c.length; f++) {
        var o = c[f], m = g;
        typeof o.displayRowIndex !== "undefined" && (m = o.displayRowIndex * e.itemHeight);
        o.isVisible && !(typeof o.isHidden !== "undefined" && o.isHidden) && (g = Math.max(g, m + e.itemHeight));
        o.itemTop = m;
        ha(o)
      }
      for (f = a + 1; f < c.length; f++) Ca(c[f]);
      ea(b.chartContent, fa(c, e));
      Pa(c, b.chartContent, e);
      Qa(c, e) && Ea(c);
      Fa(d, c, b, e);
      la(c, b.chartContentContainer, e)
    }, ob = function (a, d) {
      return function () {
        var b =
            a.ownerDocument, c = b.createElementNS("http://www.w3.org/2000/svg", "defs"),
          e = b.createElementNS("http://www.w3.org/2000/svg", "linearGradient");
        e.setAttribute("id", "BlueGradient");
        e.setAttribute("x1", "0%");
        e.setAttribute("y1", "0%");
        e.setAttribute("x2", "0%");
        e.setAttribute("y2", "100%");
        var f = b.createElementNS("http://www.w3.org/2000/svg", "stop");
        f.setAttribute("offset", "0%");
        f.setAttribute("style", "stop-color: White");
        var g = b.createElementNS("http://www.w3.org/2000/svg", "stop");
        g.setAttribute("offset",
          "25%");
        g.setAttribute("style", "stop-color: LightBlue");
        var m = b.createElementNS("http://www.w3.org/2000/svg", "stop");
        m.setAttribute("offset", "100%");
        m.setAttribute("style", "stop-color: Blue");
        e.appendChild(f);
        e.appendChild(g);
        e.appendChild(m);
        c.appendChild(e);
        e = b.createElementNS("http://www.w3.org/2000/svg", "linearGradient");
        e.setAttribute("id", "BlackGradient");
        e.setAttribute("x1", "0%");
        e.setAttribute("y1", "0%");
        e.setAttribute("x2", "0%");
        e.setAttribute("y2", "100%");
        f = b.createElementNS("http://www.w3.org/2000/svg",
          "stop");
        f.setAttribute("offset", "0%");
        f.setAttribute("style", "stop-color: Black");
        g = b.createElementNS("http://www.w3.org/2000/svg", "stop");
        g.setAttribute("offset", "10%");
        g.setAttribute("style", "stop-color: White");
        m = b.createElementNS("http://www.w3.org/2000/svg", "stop");
        m.setAttribute("offset", "20%");
        m.setAttribute("style", "stop-color: Gray");
        var o = b.createElementNS("http://www.w3.org/2000/svg", "stop");
        o.setAttribute("offset", "60%");
        o.setAttribute("style", "stop-color: Black");
        e.appendChild(f);
        e.appendChild(g);
        e.appendChild(m);
        e.appendChild(o);
        c.appendChild(e);
        e = b.createElementNS("http://www.w3.org/2000/svg", "marker");
        e.setAttribute("id", "ArrowMarker");
        e.setAttribute("viewBox", "0 0 10 10");
        e.setAttribute("refX", "0");
        e.setAttribute("refY", "5");
        e.setAttribute("markerUnits", "strokeWidth");
        e.setAttribute("markerWidth", "5");
        e.setAttribute("markerHeight", "4");
        e.setAttribute("orient", "auto");
        b = b.createElementNS("http://www.w3.org/2000/svg", "path");
        switch (d.theme) {
          default:
            b.setAttribute("fill", "#3b87d9");
            break;
          case "Aero":
            b.setAttribute("fill", "Blue")
        }
        b.setAttribute("d", "M 0 0 L 10 5 L 0 10 z");
        e.appendChild(b);
        c.appendChild(e);
        return c
      }
    }, sb = function () {
      return function (a) {
        var d = a.ganttChartView.ownerDocument, b = d.createElementNS("http://www.w3.org/2000/svg", "title");
        b.appendChild(E(d, a.content));
        return b
      }
    }, tb = function (a) {
      return function (d) {
        var b = d.ganttChartView.ownerDocument, c = b.createElementNS("http://www.w3.org/2000/svg", "text"),
          e = D(d.finish, a);
        if (d.isMilestone || d.hasChildren && (typeof d.isSummaryEnabled ===
          "undefined" || d.isSummaryEnabled)) e = e + a.barHeight / 2;
        c.setAttribute("x", e + 7);
        c.setAttribute("y", a.barMargin + a.barHeight - 1);
        d = a.target != "Phone" ? d.assignmentsContent : d.content;
        typeof d === "undefined" && (d = "");
        c.appendChild(b.createTextNode(d));
        typeof a.assignmentsClass !== "undefined" ? c.setAttribute("class", a.assignmentsClass) : typeof a.assignmentsStyle !== "undefined" && c.setAttribute("style", a.assignmentsStyle);
        return c
      }
    }, ab = function (a) {
      var d = a.ganttChartView.ownerDocument;
      if (typeof a.chartItemArea === "undefined") a.chartItemArea =
        d.createElementNS("http://www.w3.org/2000/svg", "g");
      for (d = a.chartItemArea.childNodes.length; d-- > 0;) a.chartItemArea.removeChild(a.chartItemArea.childNodes[d]);
      return a.chartItemArea
    }, pb = function (a, d, b) {
      return function (c) {
        var e = c.ganttChartView.ownerDocument, f = ab(c);
        if (b.isBaselineVisible && typeof c.baselineStart !== "undefined" && typeof c.baselineFinish !== "undefined") {
          var g = D(c.baselineStart, b), m = Math.max(D(c.baselineFinish, b), g + 4),
            o = e.createElementNS("http://www.w3.org/2000/svg", "rect");
          o.setAttribute("x",
            g);
          o.setAttribute("y", b.barMargin / 2);
          o.setAttribute("width", Math.max(0, m - g - 1));
          o.setAttribute("height", b.barHeight);
          o.setAttribute("rx", b.barCornerRadius);
          o.setAttribute("ry", b.barCornerRadius);
          g = b.baselineBarClass;
          if (typeof c.baselineBarClass !== "undefined") g = c.baselineBarClass;
          if (typeof g !== "undefined") o.setAttribute("class", g); else {
            g = b.baselineBarStyle;
            if (typeof c.baselineBarStyle !== "undefined") g = c.baselineBarStyle;
            typeof g !== "undefined" && o.setAttribute("style", g)
          }
          f.appendChild(o)
        }
        var g = D(c.start,
            b), o = Math.max(D(c.finish, b), g + 4), m = D(c.completedFinish, b),
          n = e.createElementNS("http://www.w3.org/2000/svg", "rect");
        n.setAttribute("x", g);
        n.setAttribute("y", b.barMargin);
        n.setAttribute("width", Math.max(0, o - g - 1));
        n.setAttribute("height", b.barHeight);
        n.setAttribute("rx", b.barCornerRadius);
        n.setAttribute("ry", b.barCornerRadius);
        var p = b.standardBarClass;
        if (typeof c.standardBarClass !== "undefined") p = c.standardBarClass;
        if (typeof c.barClass !== "undefined") p = c.barClass;
        if (typeof p !== "undefined") n.setAttribute("class",
          p); else {
          p = b.standardBarStyle;
          if (typeof c.standardBarStyle !== "undefined") p = c.standardBarStyle;
          if (typeof c.barStyle !== "undefined") p = c.barStyle;
          typeof p !== "undefined" && n.setAttribute("style", p)
        }
        f.appendChild(n);
        if (b.isTaskCompletedEffortVisible) {
          n = e.createElementNS("http://www.w3.org/2000/svg", "rect");
          n.setAttribute("x", g);
          n.setAttribute("y", b.barMargin + b.completedBarMargin);
          n.setAttribute("width", Math.max(0, m - g - 1));
          n.setAttribute("height", b.completedBarHeight);
          n.setAttribute("rx", b.completedBarCornerRadius);
          n.setAttribute("ry", b.completedBarCornerRadius);
          p = b.standardCompletedBarClass;
          if (typeof c.standardCompletedBarClass !== "undefined") p = c.standardCompletedBarClass;
          if (typeof c.completedBarClass !== "undefined") p = c.completedBarClass;
          if (typeof p !== "undefined") n.setAttribute("class", p); else {
            p = b.standardCompletedBarStyle;
            if (typeof c.standardCompletedBarStyle !== "undefined") p = c.standardCompletedBarStyle;
            if (typeof c.completedBarStyle !== "undefined") p = c.completedBarStyle;
            typeof p !== "undefined" && n.setAttribute("style",
              p)
          }
          f.appendChild(n)
        }
        if (!b.isReadOnly && !b.isChartReadOnly && (typeof c.isReadOnly === "undefined" || !c.isReadOnly) && (typeof c.isBarReadOnly === "undefined" || !c.isBarReadOnly)) {
          n = e.createElementNS("http://www.w3.org/2000/svg", "rect");
          n.setAttribute("x", g);
          n.setAttribute("y", b.barMargin);
          n.setAttribute("width", Math.max(0, o - g - 1));
          n.setAttribute("height", b.barHeight);
          n.setAttribute("style", "fill: White; fill-opacity: 0; cursor: move");
          b.isTaskStartReadOnly || f.appendChild(n);
          p = e.createElementNS("http://www.w3.org/2000/svg",
            "rect");
          p.setAttribute("x", g - 4);
          p.setAttribute("y", b.barMargin);
          p.setAttribute("width", 4);
          p.setAttribute("height", b.barHeight);
          p.setAttribute("style", "fill: White; fill-opacity: 0; cursor: e-resize");
          b.isDraggingTaskStartEndsEnabled && !b.isTaskStartReadOnly && f.appendChild(p);
          var h = e.createElementNS("http://www.w3.org/2000/svg", "rect");
          h.setAttribute("x", m - 2);
          h.setAttribute("y", b.barMargin);
          h.setAttribute("width", 2);
          h.setAttribute("height", b.barHeight);
          h.setAttribute("style", "fill: White; fill-opacity: 0; cursor: e-resize");
          if (!b.isTaskCompletionReadOnly) {
            f.appendChild(h);
            var j = e.createElementNS("http://www.w3.org/2000/svg", "title");
            j.appendChild(E(e, "%"));
            h.appendChild(j)
          }
          j = e.createElementNS("http://www.w3.org/2000/svg", "rect");
          j.setAttribute("x", o - 4);
          j.setAttribute("y", b.barMargin);
          j.setAttribute("width", 4);
          j.setAttribute("height", b.barHeight);
          j.setAttribute("style", "fill: White; fill-opacity: 0; cursor: e-resize");
          b.isTaskEffortReadOnly || f.appendChild(j);
          bb(n, p, j, h, c, g, o, m, a, d, b);
          if (b.areTaskDependenciesVisible &&
            !b.areTaskPredecessorsReadOnly && !c.isPart) {
            e = e.createElementNS("http://www.w3.org/2000/svg", "circle");
            e.setAttribute("cx", o - 2);
            e.setAttribute("cy", b.barMargin + b.barHeight / 2);
            e.setAttribute("r", b.barHeight / 4);
            e.setAttribute("style", "fill: White; fill-opacity: 0; cursor: pointer");
            f.appendChild(e);
            Ra(e, f, c, b.barMargin + b.barHeight / 2, o - 2, a, d, b)
          }
        }
        return f
      }
    }, qb = function (a, d, b) {
      return function (c) {
        var e = c.ganttChartView.ownerDocument, f = ab(c), g = D(c.start, b), m = D(c.finish, b),
          o = b.barHeight * 2.15 / 3, n = e.createElementNS("http://www.w3.org/2000/svg",
            "rect");
        n.setAttribute("x", g);
        n.setAttribute("y", b.barMargin);
        n.setAttribute("width", Math.max(0, m - g - 1));
        n.setAttribute("height", o);
        var p = b.summaryBarClass;
        if (typeof c.summaryBarClass !== "undefined") p = c.summaryBarClass;
        if (typeof c.barClass !== "undefined") p = c.barClass;
        if (typeof p !== "undefined") n.setAttribute("class", p); else {
          var h = b.summaryBarStyle;
          if (typeof c.summaryBarStyle !== "undefined") h = c.summaryBarStyle;
          if (typeof c.barStyle !== "undefined") h = c.barStyle;
          typeof h !== "undefined" && n.setAttribute("style",
            h)
        }
        f.appendChild(n);
        if (!c.isExpanded) {
          n = e.createElementNS("http://www.w3.org/2000/svg", "line");
          n.setAttribute("x1", g);
          n.setAttribute("y1", b.barMargin + o + 2.5);
          n.setAttribute("x2", m - 1);
          n.setAttribute("y2", b.barMargin + o + 2.5);
          var j = b.collapsedSummaryLineClass;
          if (typeof c.collapsedSummaryLineClass !== "undefined") j = c.collapsedSummaryLineClass;
          if (typeof j !== "undefined") n.setAttribute("class", j); else {
            j = b.collapsedSummaryLineStyle;
            if (typeof c.collapsedSummaryLineStyle !== "undefined") j = c.collapsedSummaryLineStyle;
            typeof j !== "undefined" && n.setAttribute("style", j)
          }
          f.appendChild(n)
        }
        var j = e.createElementNS("http://www.w3.org/2000/svg", "polygon"), n = b.barMargin - 0.25, o = o + 1.5,
          k = b.barHeight * 3 / 4, A = b.barHeight / 4, g = g - 1 - b.barHeight / 3;
        j.setAttribute("points", g + "," + n + " " + g + "," + (n + o) + " " + (g + k / 2) + "," + (n + o + A) + " " + (g + k) + "," + (n + o) + " " + (g + k) + "," + n);
        typeof p !== "undefined" && j.setAttribute("class", p);
        typeof h !== "undefined" && j.setAttribute("style", h);
        f.appendChild(j);
        j = e.createElementNS("http://www.w3.org/2000/svg", "polygon");
        g = m +
          b.barHeight / 3;
        j.setAttribute("points", g + "," + n + " " + g + "," + (n + o) + " " + (g - k / 2) + "," + (n + o + A) + " " + (g - k) + "," + (n + o) + " " + (g - k) + "," + n);
        typeof p !== "undefined" && j.setAttribute("class", p);
        typeof h !== "undefined" && j.setAttribute("style", h);
        f.appendChild(j);
        if (!b.isReadOnly && !b.isChartReadOnly && (typeof c.isReadOnly === "undefined" || !c.isReadOnly) && (typeof c.isBarReadOnly === "undefined" || !c.isBarReadOnly) && b.areTaskDependenciesVisible && !b.areTaskPredecessorsReadOnly && !c.isPart) {
          e = e.createElementNS("http://www.w3.org/2000/svg",
            "circle");
          e.setAttribute("cx", m - 0.5);
          e.setAttribute("cy", b.barMargin + b.barHeight / 2);
          e.setAttribute("r", 2.5);
          e.setAttribute("style", "fill: White; fill-opacity: 0; cursor: pointer");
          f.appendChild(e);
          Ra(e, f, c, b.barMargin + b.barHeight / 2, m - 1.5, a, d, b)
        }
        return f
      }
    }, rb = function (a, d, b) {
      return function (c) {
        var e = c.ganttChartView.ownerDocument, f = ab(c);
        if (b.isBaselineVisible && typeof c.baselineStart !== "undefined") {
          var g = D(c.baselineStart, b), m = e.createElementNS("http://www.w3.org/2000/svg", "polygon"), o = b.barMargin -
            1, n = b.barHeight + 1;
          m.setAttribute("points", g + "," + o + " " + (g - n / 2) + "," + (o + n / 2) + " " + g + "," + (o + n) + " " + (g + n / 2) + "," + (o + n / 2));
          g = b.baselineBarClass;
          if (typeof c.baselineBarClass !== "undefined") g = c.baselineBarClass;
          if (typeof g !== "undefined") m.setAttribute("class", g); else {
            var p = b.baselineBarStyle;
            if (typeof c.baselineBarStyle !== "undefined") p = c.baselineBarStyle
          }
          m.setAttribute("style", p);
          f.appendChild(m)
        }
        m = D(c.start, b);
        p = e.createElementNS("http://www.w3.org/2000/svg", "polygon");
        m = m - 1;
        o = b.barMargin;
        g = b.barHeight + 1;
        p.setAttribute("points",
          m + "," + o + " " + (m - g / 2) + "," + (o + g / 2) + " " + m + "," + (o + g) + " " + (m + g / 2) + "," + (o + g / 2));
        o = b.milestoneBarClass;
        if (typeof c.milestoneBarClass !== "undefined") o = c.milestoneBarClass;
        if (typeof c.barClass !== "undefined") o = c.barClass;
        if (typeof o !== "undefined") p.setAttribute("class", o); else {
          o = b.milestoneBarStyle;
          if (typeof c.milestoneBarStyle !== "undefined") o = c.milestoneBarStyle;
          if (typeof c.barStyle !== "undefined") o = c.barStyle;
          typeof o !== "undefined" && p.setAttribute("style", o)
        }
        f.appendChild(p);
        if (!b.isReadOnly && !b.isChartReadOnly &&
          (typeof c.isReadOnly === "undefined" || !c.isReadOnly) && (typeof c.isBarReadOnly === "undefined" || !c.isBarReadOnly)) {
          p = e.createElementNS("http://www.w3.org/2000/svg", "rect");
          p.setAttribute("x", m - g / 2);
          p.setAttribute("y", b.barMargin);
          p.setAttribute("width", g);
          p.setAttribute("height", g);
          p.setAttribute("style", "fill: White; fill-opacity: 0; cursor: move");
          f.appendChild(p);
          bb(p, null, null, null, c, m, m, m, a, d, b);
          if (b.areTaskDependenciesVisible && !b.areTaskPredecessorsReadOnly && !c.isPart) {
            e = e.createElementNS("http://www.w3.org/2000/svg",
              "circle");
            e.setAttribute("cx", m);
            e.setAttribute("cy", b.barMargin + b.barHeight / 2);
            e.setAttribute("r", b.barHeight / 4);
            e.setAttribute("style", "fill: White; fill-opacity: 0; cursor: pointer");
            f.appendChild(e);
            Ra(e, f, c, b.barMargin + b.barHeight / 2, m, a, d, b)
          }
        }
        return f
      }
    }, ub = function (a, d) {
      return function (b, c) {
        var e = b.ganttChartView.ownerDocument, f = e.createElementNS("http://www.w3.org/2000/svg", "g"), g;
        g = "M ";
        var m, o, n, p, h = d.itemHeight, j = h / 2, k = h / 3.5, A = 2, q = false;
        if (typeof c.dependencyType !== "undefined" && (c.dependencyType ==
          "StartStart" || c.dependencyType == "SS" || c.dependencyType == "StartFinish" || c.dependencyType == "SF")) {
          m = D(c.item.start, d);
          c.item.hasChildren && (typeof c.item.isSummaryEnabled === "undefined" || c.item.isSummaryEnabled) ? m = m - (h / 5 + 0.25) : c.item.isMilestone && (m = m - h / 4);
          o = m - k
        } else {
          m = D(c.item.finish, d) - 1;
          if (c.item.hasChildren && (typeof c.item.isSummaryEnabled === "undefined" || c.item.isSummaryEnabled)) m = m + (h / 5 + 0.25); else if (c.item.isMilestone) m = m + h / 4; else {
            n = D(c.item.start, d) + 4 - 1;
            m < n && (m = n)
          }
          o = m + k
        }
        p = qa(c.item, a, d) - qa(b, a,
          d) + 0.5;
        g = g + (m + " " + (p + j) + " L " + o + " " + (p + j));
        if (typeof c.dependencyType !== "undefined" && (c.dependencyType == "FinishFinish" || c.dependencyType == "FF" || c.dependencyType == "StartFinish" || c.dependencyType == "SF")) {
          m = D(b.finish, d) - 1;
          if (typeof c.dependencyType !== "undefined" && (c.dependencyType == "FinishFinish" || c.dependencyType == "FF")) {
            q = true;
            if (b.hasChildren && (typeof b.isSummaryEnabled === "undefined" || b.isSummaryEnabled)) m = m + (h / 5 + 1); else if (b.isMilestone) m = m + (h / 4 + 1); else {
              n = D(b.start, d) + 4 - 1;
              m < n && (m = n)
            }
            n = m + k
          } else if (b.isMilestone) n =
            m; else {
            n = D(b.start, d) + 4;
            m < n && (m = n);
            n = m - 2.5
          }
        } else {
          m = D(b.start, d);
          if (typeof c.dependencyType !== "undefined" && (c.dependencyType == "StartStart" || c.dependencyType == "SS")) {
            q = true;
            b.hasChildren && (typeof b.isSummaryEnabled === "undefined" || b.isSummaryEnabled) ? m = m - (h / 5 + 1) : b.isMilestone && (m = m - (h / 4 + 1));
            n = m - k
          } else if (b.isMilestone) n = m - 1; else {
            n = m + 1.5;
            var l = D(b.finish, d);
            n < o && (l - o > k * 2 && b.start >= c.item.finish) && (n = o)
          }
        }
        if (typeof c.dependencyType !== "undefined" && (c.dependencyType == "StartStart" || c.dependencyType == "SS" ||
          c.dependencyType == "StartFinish" || c.dependencyType == "SF")) {
          if (n > o) {
            p = p - k / 6;
            p = p <= 0 ? p + j : p - j;
            g = g + (" " + o + " " + (p + j))
          }
        } else if (n < o) {
          p = p - k / 6;
          p = p <= 0 ? p + j : p - j;
          g = g + (" " + o + " " + (p + j))
        }
        g = g + (" " + n + " " + (p + j));
        p = q ? j + 0.5 : p <= 0 ? h / 4 - 1 - A : h - h / 4 + 1 + A;
        if (q) {
          n > m - A && (A = -A);
          m = m - A
        }
        g = g + (" " + n + " " + p);
        q && (g = g + (" " + m + " " + p));
        m = e.createElementNS("http://www.w3.org/2000/svg", "path");
        m.setAttribute("d", g);
        typeof d.dependencyLineZoneClass !== "undefined" && m.setAttribute("class", d.dependencyLineZoneClass);
        typeof d.dependencyLineZoneStyle !==
        "undefined" && m.setAttribute("style", d.dependencyLineZoneStyle);
        f.appendChild(m);
        e = e.createElementNS("http://www.w3.org/2000/svg", "path");
        e.setAttribute("d", g);
        g = d.dependencyLineClass;
        if (typeof c.dependencyLineClass !== "undefined") g = c.dependencyLineClass;
        if (typeof g !== "undefined") e.setAttribute("class", g); else {
          g = d.dependencyLineStyle;
          if (typeof c.dependencyLineStyle !== "undefined") g = c.dependencyLineStyle;
          typeof g !== "undefined" && e.setAttribute("style", g)
        }
        f.appendChild(e);
        return f
      }
    }, vb = function () {
      return function (a,
                       d) {
        var b = a.ganttChartView.ownerDocument, c = b.createElementNS("http://www.w3.org/2000/svg", "title");
        c.appendChild(E(b, d.item.content + " - " + a.content));
        return c
      }
    }, u = function (a, d, b, c) {
      if (typeof a.ganttChartView !== "undefined") {
        var e = a.ganttChartView, f = e.settings;
        if (d == "start" || d == "minStart" || d == "maxStart") {
          if (typeof a.minStart !== "undefined" && a.start < a.minStart) {
            a.start = a.minStart;
            if (typeof a.loadChartItem === "undefined") a.start = F(a.start, f, true, typeof a.isMilestone !== "undefined" && a.isMilestone, a.schedule);
            if (b) a.preferredStart = a.start
          } else if (typeof a.maxStart !== "undefined" && a.start > a.maxStart) {
            a.start = a.maxStart;
            if (typeof a.loadChartItem === "undefined") a.start = F(a.start, f, true, typeof a.isMilestone !== "undefined" && a.isMilestone, a.schedule);
            if (b) a.preferredStart = a.start
          }
          if (a.finish < a.start) {
            a.finish = a.start;
            u(a, "finish", false, true)
          }
          if (a.completedFinish < a.start) {
            a.completedFinish = a.start;
            u(a, "completedFinish", false, true)
          } else if (a.completedFinish > a.finish) {
            a.completedFinish = a.finish;
            u(a, "completedFinish",
              false, true)
          }
        } else if (d == "finish" || d == "minFinish" || d == "maxFinish") {
          if (typeof a.maxFinish !== "undefined" && a.finish > a.maxFinish) {
            a.finish = a.maxFinish;
            if (typeof a.loadChartItem === "undefined") a.finish = F(a.finish, f, typeof a.isMilestone !== "undefined" && a.isMilestone, true, a.schedule)
          } else if (typeof a.minFinish !== "undefined" && a.finish < a.minFinish) {
            a.finish = a.minFinish;
            if (typeof a.loadChartItem === "undefined") a.finish = F(a.finish, f, typeof a.isMilestone !== "undefined" && a.isMilestone, true, a.schedule)
          }
          if (a.finish <
            a.start) {
            a.finish = a.start;
            u(a, "finish", false, true)
          }
          if (a.completedFinish < a.start) {
            a.completedFinish = a.start;
            u(a, "completedFinish", false, true)
          } else if (a.completedFinish > a.finish) {
            a.completedFinish = a.finish;
            u(a, "completedFinish", false, true)
          }
        }
        if (e.isTimingInformationInitialized) {
          var g = e.items, m, o;
          if (d == "indentation" || d == "predecessors") for (m = 0; m < g.length; m++) {
            o = g[m];
            typeof o.dependsOf !== "undefined" && delete o.dependsOf
          }
          if ((d == "predecessors" || d == "start" || d == "finish") && typeof a.isDuringPropertyChangeTaskDependencyConstraintsEnsuring ===
            "undefined" && f.areTaskDependencyConstraintsEnabled && (f.areTaskDependencyConstraintsEnabledWhileDragging || typeof e.isDuringTimeDragOperation === "undefined")) {
            a.isDuringPropertyChangeTaskDependencyConstraintsEnsuring = true;
            for (o = a.parent; o != null;) {
              typeof o.predecessors !== "undefined" && o.predecessors.length > 0 && ya(o, g, f, e);
              o = o.parent
            }
            o = a;
            for (typeof o.predecessors !== "undefined" && o.predecessors.length > 0 ? ya(o, g, f, e) : cb(o, f); o != null;) {
              if (typeof o.successors === "undefined") {
                o.successors = [];
                for (m = 0; m < g.length; m++) {
                  var n =
                    g[m];
                  if (!(n == o || typeof n.predecessors === "undefined" || n.predecessors.length == 0)) for (var p = 0; p < n.predecessors.length; p++) if (n.predecessors[p].item == o) {
                    o.successors.push(n);
                    break
                  }
                }
              }
              for (m = 0; m < o.successors.length; m++) ya(o.successors[m], g, f, e);
              o = o.parent
            }
            delete a.isDuringPropertyChangeTaskDependencyConstraintsEnsuring
          }
          a.isPart && a.ganttChartItem && u(a.ganttChartItem, "parts", false, true)
        }
        f.itemPropertyChangeHandler(a, d, b, c);
        d == "isExpanded" ? typeof a.ganttChartView !== "undefined" && typeof a.ganttChartView.settings.itemExpansionChangeHandler !==
          "undefined" && a.ganttChartView.settings.itemExpansionChangeHandler(a, a.isExpanded) : d == "isSelected" && typeof a.ganttChartView !== "undefined" && typeof a.ganttChartView.settings.itemSelectionChangeHandler !== "undefined" && a.ganttChartView.settings.itemSelectionChangeHandler(a, a.isSelected, b)
      }
    }, cb = function (a, d) {
      if (typeof a.isAwaitingPreferredStartUpdates === "undefined") if (a.hasChildren && (typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled)) for (var b = 0; b < a.children.length; b++) cb(a.children[b], d); else if (typeof a.preferredStart !==
        "undefined" && a.preferredStart < a.start) {
        a.isAwaitingPreferredStartUpdates = true;
        effort = O(a.start, a.finish, d, a.schedule);
        completedEffort = O(a.start, a.completedFinish, d, a.schedule);
        a.start = a.preferredStart;
        a.finish = K(a.start, effort, d, a.schedule);
        a.completedFinish = K(a.start, completedEffort, d, a.schedule);
        u(a, "start", false, true);
        u(a, "finish", false, true);
        u(a, "completedFinish", false, true);
        setTimeout(function () {
          X(a);
          delete a.isAwaitingPreferredStartUpdates
        }, 1)
      }
    }, ya = function (a, d, b, c) {
      if (c.isBasicTimingInformationInitialized) {
        cb(a,
          b);
        for (var e = [], f, g = false, c = 0; c < a.predecessors.length; c++) {
          f = a.predecessors[c];
          typeof f.item === "undefined" || d.indexOf(f.item) < 0 || Sa(f.item, a) ? g = true : e.push(f)
        }
        a.predecessors = e;
        if (g) {
          u(a, "predecessors", false, true);
          typeof a.ganttChartView !== "undefined" && Da(a)
        }
        for (c = 0; c < a.predecessors.length; c++) {
          f = a.predecessors[c];
          Ib(a, f, d, b)
        }
      }
    }, Ib = function (a, d, b, c) {
      if (a.hasChildren && (typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled)) for (var e = 0; e < a.children.length; e++) Ib(a.children[e], d, b, c); else {
        var f =
          d.item, g, b = false;
        if (typeof d.dependencyType === "undefined" || d.dependencyType == "" || d.dependencyType == "FinishStart" || d.dependencyType == "FS") {
          f = f.finish;
          typeof d.lag !== "undefined" && d.lag != 0 && (f = K(f, d.lag, c, a.schedule));
          if (a.start < f) {
            if (!a.isMilestone && (!a.hasChildren || !(typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled))) {
              e = O(a.start, a.finish, c, a.schedule);
              g = O(a.start, a.completedFinish, c, a.schedule)
            }
            if (!a.hasChildren || !(typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled)) {
              a.start = F(ia(f,
                c), c, true, a.isMilestone, a.schedule);
              u(a, "start", false, true);
              if (a.isMilestone) {
                a.finish = a.start;
                u(a, "finish", false, true);
                a.completedFinish = a.start
              } else {
                a.finish = K(a.start, e, c, a.schedule);
                u(a, "finish", false, true);
                a.completedFinish = K(a.start, g, c, a.schedule)
              }
              u(a, "completedFinish", false, true);
              b = true
            }
          }
        } else if (d.dependencyType == "StartStart" || d.dependencyType == "SS") {
          f = f.start;
          typeof d.lag !== "undefined" && d.lag != 0 && (f = K(f, d.lag, c, a.schedule));
          if (a.start < f) {
            if (!a.isMilestone && (!a.hasChildren || !(typeof a.isSummaryEnabled ===
              "undefined" || a.isSummaryEnabled))) {
              e = O(a.start, a.finish, c, a.schedule);
              g = O(a.start, a.completedFinish, c, a.schedule)
            }
            if (!a.hasChildren || !(typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled)) {
              a.start = F(ia(f, c), c, true, a.isMilestone, a.schedule);
              u(a, "start", false, true);
              if (a.isMilestone) {
                a.finish = a.start;
                u(a, "finish", false, true);
                a.completedFinish = a.start
              } else {
                a.finish = K(a.start, e, c, a.schedule);
                u(a, "finish", false, true);
                a.completedFinish = K(a.start, g, c, a.schedule)
              }
              u(a, "completedFinish", false, true);
              b = true
            }
          }
        } else if (d.dependencyType == "FinishFinish" || d.dependencyType == "FF") {
          f = f.finish;
          typeof d.lag !== "undefined" && d.lag != 0 && (f = K(f, d.lag, c, a.schedule));
          if (a.finish > f && (!a.hasChildren || !(typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled))) {
            a.finish = F(ia(f, c), c, a.isMilestone, true, a.schedule);
            if (a.finish < a.start) a.finish = a.start;
            u(a, "finish", false, true);
            if (a.isMilestone) {
              if (a.completedFinish != a.start) {
                a.completedFinish = a.start;
                u(a, "completedFinish", false, true)
              }
            } else if (a.completedFinish > a.finish) {
              a.completedFinish =
                a.finish;
              u(a, "completedFinish", false, true)
            }
            b = true
          }
        } else if (d.dependencyType == "StartFinish" || d.dependencyType == "SF") {
          f = f.start;
          typeof d.lag !== "undefined" && d.lag != 0 && (f = K(f, d.lag, c, a.schedule));
          if (a.finish > f && (!a.hasChildren || !(typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled))) {
            a.finish = F(ia(f, c), c, a.isMilestone, true, a.schedule);
            if (a.finish < a.start) a.finish = a.start;
            u(a, "finish", false, true);
            if (a.isMilestone) {
              if (a.completedFinish != a.start) {
                a.completedFinish = a.start;
                u(a, "completedFinish", false,
                  true)
              }
            } else if (a.completedFinish > a.finish) {
              a.completedFinish = a.finish;
              u(a, "completedFinish", false, true)
            }
            b = true
          }
        }
        if (b && !(typeof a.ganttChartView === "undefined" || typeof a.isAwaitingEnsureItemDependencyConstraintsUpdates !== "undefined")) if (typeof a.ganttChartView !== "undefined" && !a.ganttChartView.isTimingInformationInitialized) X(a); else {
          a.isAwaitingEnsureItemDependencyConstraintsUpdates = true;
          setTimeout(function () {
            X(a);
            delete a.isAwaitingEnsureItemDependencyConstraintsUpdates
          }, 0)
        }
      }
    }, Sa = function (a, d) {
      if (typeof a.dependsOf !==
        "undefined" && typeof a.dependsOf[a] !== "undefined") return a.dependsOf[d];
      try {
        if (a == d) return true;
        var b = Jb(a);
        if (b.indexOf(d) >= 0) return true;
        var c = Jb(d);
        if (c.indexOf(a) >= 0) return true;
        var e = db(a), f, g;
        for (f = 0; f < e.length; f++) {
          g = e[f];
          if (g == d || g == a || b.indexOf(g) >= 0 || c.indexOf(g) >= 0 || Sa(g, d)) return true
        }
        for (e = 0; e < b.length; e++) {
          var m = db(b[e]);
          for (f = 0; f < m.length; f++) {
            g = m[f];
            if (g == d || g == a || b.indexOf(g) >= 0 || c.indexOf(g) >= 0 || Sa(g, d)) return true
          }
        }
        var o = a.children;
        for (f = 0; f < o.length; f++) {
          var n = o[f];
          if (typeof n.predecessors !==
            "undefined" && n.predecessors.length > 0 && Sa(n, d)) return true
        }
      } finally {
        if (typeof a.dependsOf === "undefined") a.dependsOf = {};
        a.dependsOf[d] = true
      }
      return a.dependsOf[d] = false
    }, Jb = function (a) {
      for (var d = []; typeof a.parent !== "undefined" && a.parent != null;) {
        (typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled) && d.push(a.parent);
        a = a.parent
      }
      return d
    }, db = function (a) {
      var d = [];
      if (typeof a.predecessors !== "undefined" && a.predecessors != null) for (var b = 0; b < a.predecessors.length; b++) typeof a.predecessors[b].item !==
      "undefined" && d.push(a.predecessors[b].item);
      return d
    }, hc = function (a, d) {
      for (var b = 0; b < a.length; b++) {
        var c = a[b], e = d == null || d(c);
        c.isHidden = !e;
        if (e) for (c = c.parent; c != null;) {
          c.isHidden = false;
          c = c.parent
        }
      }
    }, Kb = function (a, d, b) {
      return F(a, d, true, true, b)
    }, Ga = function (a, d, b) {
      return F(a, d, true, false, b)
    }, F = function (a, d, b, c, e) {
      var f = e && e.workingDayStart ? e.workingDayStart : d.visibleDayStart,
        g = e && e.workingDayFinish ? e.workingDayFinish : d.visibleDayFinish,
        m = e && e.workingWeekStart ? e.workingWeekStart : d.workingWeekStart,
        o = e && e.workingWeekFinish ? e.workingWeekFinish : d.workingWeekFinish,
        d = e && e.specialNonworkingDays ? e.specialNonworkingDays : d.specialNonworkingDays, e = W(a), a = ba(a);
      if (a < f || !b && a == f) if (b) a = f; else {
        e = Ba(e);
        a = g
      }
      if (a > g || !c && a == g) if (c) a = g; else {
        e = Y(e);
        a = f
      }
      for (c = da(e); c < m || c > o || Ab(e, d);) {
        if (b) {
          c++;
          e = Y(e);
          a = f
        } else {
          c--;
          e = Ba(e);
          a = g
        }
        for (; c < 0;) c = c + 7;
        for (; c >= 7;) c = c - 7
      }
      return new Date(e.valueOf() + a)
    }, O = function (a, d, b, c) {
      if (d.valueOf() < a.valueOf()) return -O(d, a, b, c);
      if (d.valueOf() == a.valueOf()) return 0;
      var e = c && c.workingDayStart ?
          c.workingDayStart : b.visibleDayStart, f = c && c.workingDayFinish ? c.workingDayFinish : b.visibleDayFinish,
        g = c && c.workingWeekStart ? c.workingWeekStart : b.workingWeekStart,
        m = c && c.workingWeekFinish ? c.workingWeekFinish : b.workingWeekFinish,
        c = c && c.specialNonworkingDays ? c.specialNonworkingDays : b.specialNonworkingDays, b = 0, o = W(a), a = ba(a);
      if (a < e) a = e; else if (a >= f) {
        o = Y(o);
        a = e
      }
      for (var n = W(d); o < n;) {
        var p = da(o);
        p >= g && (p <= m && !Ab(o, c)) && (b = b + (f - a));
        o = Y(o);
        a = e
      }
      d = ba(d);
      d < e ? d = e : d > f && (d = f);
      d > a && (b = b + (d - a));
      return b
    }, K = function (a,
                     d, b, c) {
      if (d < 0) return Ta(-d, a, b, c);
      a = F(a, b, true, false, c);
      if (d == 0) return a;
      var e = c && c.workingDayStart ? c.workingDayStart : b.visibleDayStart,
        f = c && c.workingDayFinish ? c.workingDayFinish : b.visibleDayFinish, g = ba(a);
      if (g + d < f) return new Date(a.valueOf() + d);
      g = f - g;
      a = new Date(a.valueOf() + g);
      for (d = d - g; d > 0;) {
        a = ba(a) > 0 ? F(Y(W(a)), b, true, false, c) : F(W(a), b, true, false, c);
        if (e + d < f) return new Date(a.valueOf() + d);
        g = f - e;
        a = new Date(a.valueOf() + g);
        d = d - g
      }
      return new Date(a.valueOf())
    }, Ta = function (a, d, b, c) {
      if (a < 0) return K(d, -a,
        b, c);
      d = F(d, b, false, true, c);
      if (a == 0) return d;
      var e = c && c.workingDayStart ? c.workingDayStart : b.visibleDayStart,
        f = c && c.workingDayFinish ? c.workingDayFinish : b.visibleDayFinish, g = ba(d);
      if (g - a > e) return new Date(d.valueOf() - a);
      g = g - e;
      d = new Date(d.valueOf() - g);
      for (a = a - g; a > 0;) {
        d = ba(d) < 864E5 ? F(W(d), b, false, true, c) : F(Ba(W(d)), b, false, true, c);
        if (f - a > e) return new Date(d.valueOf() - a);
        g = f - e;
        d = new Date(d.valueOf() - g);
        a = a - g
      }
      return new Date(d.valueOf())
    }, Lb = function (a, d, b, c, e) {
      return O(a, d, c, e) / O(a, b, c, e)
    }, Mb = function (a,
                      d, b, c, e) {
      return K(a, d * O(a, b, c, e), c, e)
    }, Ha = function (a) {
      for (var d = 0, a = ta(a), b = 0; b < a.length; b++) d = d + a[b].value;
      d == 0 && (d = 1);
      return d
    }, eb = function (a) {
      if (a.hasChildren && (typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled)) {
        for (var d = 0, a = a.children, b = 0; b < a.length; b++) d = d + eb(a[b]);
        return d
      }
      return a.ganttChartView.getItemEffort(a) * Ha(a)
    }, fb = function (a) {
      if (a.hasChildren && (typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled)) {
        for (var d = 0, a = a.children, b = 0; b < a.length; b++) d = d + fb(a[b]);
        return d
      }
      return a.ganttChartView.getItemCompletedEffort(a) *
        Ha(a)
    }, bb = function (a, d, b, c, e, f, g, m, o, n, p) {
      a.addEventListener("mousedown", function (b) {
        if (b.button == 0) {
          n.isDuringTimeDragOperation = true;
          n.draggingItem = e;
          n.dragType = "Start";
          n.style.cursor = a.style.cursor;
          n.draggingInitialX = b.clientX;
          n.draggingInitialStartPosition = f;
          n.draggingInitialFinishPosition = g;
          n.draggingInitialCompletedFinishPosition = m;
          b.preventDefault()
        }
      }, true);
      d != null && d.addEventListener("mousedown", function (b) {
        if (b.button == 0) {
          n.isDuringTimeDragOperation = true;
          n.draggingItem = e;
          n.dragType = "StartOnly";
          n.style.cursor = a.style.cursor;
          n.draggingInitialX = b.clientX;
          n.draggingInitialStartPosition = f;
          b.preventDefault()
        }
      }, true);
      b != null && b.addEventListener("mousedown", function (a) {
        if (a.button == 0) {
          n.isDuringTimeDragOperation = true;
          n.draggingItem = e;
          n.dragType = "Finish";
          n.style.cursor = b.style.cursor;
          n.draggingInitialX = a.clientX;
          n.draggingInitialFinishPosition = g;
          a.preventDefault()
        }
      }, true);
      c != null && c.addEventListener("mousedown", function (a) {
        if (a.button == 0) {
          n.isDuringTimeDragOperation = true;
          n.draggingItem = e;
          n.dragType =
            "CompletedFinish";
          n.style.cursor = c.style.cursor;
          n.draggingInitialX = a.clientX;
          n.draggingInitialCompletedFinishPosition = m;
          a.preventDefault()
        }
      }, true);
      if (typeof n.draggableItems === "undefined") n.draggableItems = [];
      for (var d = false, h = 0; h < n.draggableItems.length; h++) if (n.draggableItems[h] == e) {
        d = true;
        break
      }
      if (!d) {
        n.addEventListener("mousemove", function (a) {
          if (!(typeof n.draggingItem === "undefined" || n.draggingItem != e || n.dragType != "Start" && n.dragType != "StartOnly" && n.dragType != "Finish" && n.dragType != "CompletedFinish")) {
            var b =
              a.clientX - n.draggingInitialX;
            Nb(a.clientX, n);
            delete n.draggingItem;
            n.draggingInitialStartPosition + b < 0 && (b = -n.draggingInitialStartPosition);
            if (n.dragType == "Start" || n.dragType == "StartOnly") {
              var c;
              n.dragType != "StartOnly" && (c = O(e.start, e.finish, p, e.schedule));
              a = O(e.start, e.completedFinish, p, e.schedule);
              b = F(ia(Aa(n.draggingInitialStartPosition + b, p), p), p, true, e.isMilestone, e.schedule);
              if (n.dragType == "StartOnly" && b > e.finish) b = e.finish;
              e.start = b;
              e.preferredStart = e.start;
              u(e, "start", true, false);
              if (n.dragType !=
                "StartOnly") {
                if (e.isMilestone) {
                  e.finish = e.start;
                  u(e, "finish", false, false);
                  e.completedFinish = e.start
                } else {
                  e.finish = K(e.start, c, p, e.schedule);
                  u(e, "finish", false, false);
                  e.completedFinish = K(e.start, a, p, e.schedule)
                }
                u(e, "completedFinish", false, false)
              } else {
                if (e.finish < e.start) {
                  e.finish = e.start;
                  u(e, "finish", false, false)
                }
                if (e.completedFinish < e.start || a <= 0) {
                  e.completedFinish = e.start;
                  u(e, "completedFinish", false, false)
                }
              }
              Ia(e, o, n.chartContent, p)
            } else if (n.dragType == "Finish") {
              c = F(ia(Aa(n.draggingInitialFinishPosition +
                b, p), p), p, e.isMilestone, true, e.schedule);
              if (c < e.start) c = e.start;
              if (c.valueOf() != e.finish.valueOf()) {
                e.finish = c;
                u(e, "finish", true, false)
              }
              if (e.completedFinish > c) {
                e.completedFinish = c;
                u(e, "completedFinish", false, false)
              }
              Ia(e, o, n.chartContent, p)
            } else if (n.dragType == "CompletedFinish") {
              c = F(ia(Aa(n.draggingInitialCompletedFinishPosition + b, p), p), p, e.isMilestone, true, e.schedule);
              if (c < e.start) c = e.start;
              if (c > e.finish) c = e.finish;
              if (c.valueOf() != e.completedFinish.valueOf()) {
                e.completedFinish = c;
                u(e, "completedFinish",
                  true, false)
              }
              Ia(e, o, n.chartContent, p)
            }
            n.draggingItem = e;
            n.draggingPerformed = true
          }
        }, true);
        n.addEventListener("mouseup", function (a) {
          if (!(a.button != 0 || typeof n.draggingItem === "undefined" || n.draggingItem != e || n.dragType != "Start" && n.dragType != "StartOnly" && n.dragType != "Finish" && n.dragType != "CompletedFinish")) {
            delete n.isDuringTimeDragOperation;
            a = n.draggingItem;
            n.style.cursor = "default";
            if (n.draggingPerformed) {
              if (n.dragType == "Start" || n.dragType == "StartOnly") {
                u(a, "start", true, true);
                u(a, "finish", false, true);
                u(a,
                  "completedFinish", false, true)
              } else if (n.dragType == "Finish") {
                u(a, "finish", true, true);
                u(a, "completedFinish", false, true)
              } else n.dragType == "CompletedFinish" && u(a, "completedFinish", true, true);
              delete n.draggingPerformed
            }
            delete n.draggingItem
          }
        }, true);
        n.draggableItems.push(e)
      }
    }, Ra = function (a, d, b, c, e, f, g, m) {
      var o = b.ganttChartView.ownerDocument;
      a.addEventListener("mousedown", function (d) {
        if (d.button == 0) {
          delete g.cancelDrag;
          g.draggingItem = b;
          g.dragType = "Dependency";
          g.style.cursor = a.style.cursor;
          g.draggingInitialX =
            d.clientX;
          g.draggingInitialY = d.clientY;
          g.draggingInitialRightPosition = e;
          g.draggingInitialTopPosition = c;
          g.draggingInitialFinishPosition = e;
          g.draggingInitialThumbPosition = c;
          d.preventDefault()
        }
      }, true);
      d.addEventListener("mouseover", function () {
        if (typeof g.temporaryHoveringThumb !== "undefined") {
          var b = g.temporaryHoveringThumb;
          delete g.temporaryHoveringThumb;
          if (typeof b.originalStyle === "undefined") return;
          b.setAttribute("style", b.originalStyle);
          delete b.originalStyle
        }
        if (typeof g.temporaryDependencyLine === "undefined") {
          g.temporaryHoveringThumb =
            a;
          a.originalStyle = a.getAttribute("style");
          typeof m.dependencyPointerClass !== "undefined" && a.setAttribute("class", m.dependencyPointerClass);
          typeof m.dependencyPointerStyle !== "undefined" && a.setAttribute("style", m.dependencyPointerStyle);
          a.style.cursor = "pointer"
        }
      }, true);
      d.addEventListener("mouseout", function () {
        setTimeout(function () {
          if (typeof a.originalStyle !== "undefined") {
            a.setAttribute("style", a.originalStyle);
            delete a.originalStyle
          }
        }, 2E3)
      }, true);
      if (typeof g.draggableDependencyItems === "undefined") g.draggableDependencyItems =
        [];
      for (var n = false, p = 0; p < g.draggableDependencyItems.length; p++) if (g.draggableDependencyItems[p] == b) {
        n = true;
        break
      }
      if (!n) {
        g.addEventListener("mousemove", function (a) {
          if (!(typeof g.draggingItem === "undefined" || g.draggingItem != b || g.dragType != "Dependency")) {
            var c = a.clientX - g.draggingInitialX, e = a.clientY - g.draggingInitialY;
            Nb(a.clientX, g);
            Ob(a.clientY, g);
            delete g.draggingItem;
            g.draggingInitialFinishPosition + c < 0 && (c = -g.draggingInitialFinishPosition);
            if (typeof g.temporaryDependencyLine !== "undefined") {
              try {
                d.removeChild(g.temporaryDependencyLine)
              } catch (f) {
              }
              delete g.temporaryDependencyLine
            }
            if (g.cancelDrag) {
              delete g.cancelDrag;
              delete g.draggingItem;
              g.style.cursor = "default"
            } else {
              a = o.createElementNS("http://www.w3.org/2000/svg", "line");
              a.setAttribute("x1", g.draggingInitialRightPosition);
              a.setAttribute("y1", g.draggingInitialTopPosition);
              a.setAttribute("x2", g.draggingInitialFinishPosition + c);
              a.setAttribute("y2", g.draggingInitialThumbPosition + e);
              typeof m.temporaryDependencyLineClass !== "undefined" && a.setAttribute("class", m.temporaryDependencyLineClass);
              typeof m.temporaryDependencyLineStyle !== "undefined" && a.setAttribute("style",
                m.temporaryDependencyLineStyle);
              g.temporaryDependencyLine = a;
              d.appendChild(a);
              g.draggingItem = b
            }
          }
        }, true);
        g.addEventListener("mouseup", function (a) {
          if (!(a.button != 0 || typeof g.draggingItem === "undefined" || g.draggingItem != b || g.dragType != "Dependency")) {
            if (typeof g.temporaryDependencyLine !== "undefined") {
              try {
                d.removeChild(g.temporaryDependencyLine)
              } catch (c) {
              }
              delete g.temporaryDependencyLine
            }
            for (var e = Math.floor((b.itemTop + g.draggingInitialThumbPosition + (a.clientY - g.draggingInitialY)) / m.itemHeight), o = null, n =
              0, p = 0; p < f.length; p++) {
              var h = f[p];
              if (h.isVisible && !(typeof h.isHidden !== "undefined" && h.isHidden) && typeof h.displayRowIndex === "undefined") {
                if (n == e) {
                  o = h;
                  break
                }
                n++
              }
            }
            if (o != null) {
              a = g.draggingInitialFinishPosition + (a.clientX - g.draggingInitialX);
              e = D(o.start, m);
              n = D(o.finish, m);
              if (o.isMilestone || o.hasChildren && (typeof o.isSummaryEnabled === "undefined" || o.isSummaryEnabled)) {
                e = e - m.itemHeight / 2;
                n = n + m.itemHeight / 2
              }
              n < e + 4 && (n = e + 4);
              if (a >= e && a <= n && !(o == b || za(o, b) || za(b, o)) && !Na(o, b) && !Na(b, o)) {
                delete b.successors;
                if (typeof o.predecessors ===
                  "undefined") o.predecessors = [];
                o.predecessors.push({item: b});
                u(o, "predecessors", true, true);
                if (o.start < b.finish && !m.areTaskDependencyConstraintsEnabled) {
                  var j, k;
                  if (!o.isMilestone && (!o.hasChildren || !(typeof o.isSummaryEnabled === "undefined" || o.isSummaryEnabled))) {
                    j = O(o.start, o.finish, m, o.schedule);
                    k = O(o.start, o.completedFinish, m, o.schedule)
                  }
                  if (!o.hasChildren || !(typeof o.isSummaryEnabled === "undefined" || o.isSummaryEnabled)) {
                    o.start = F(ia(b.finish, m), m, true, o.isMilestone, b.schedule);
                    u(o, "start", false, true);
                    if (o.isMilestone) {
                      o.finish = o.start;
                      u(o, "finish", false, true);
                      o.completedFinish = o.start
                    } else {
                      o.finish = K(o.start, j, m, o.schedule);
                      u(o, "finish", false, true);
                      o.completedFinish = K(o.start, k, m, o.schedule)
                    }
                    u(o, "completedFinish", false, true)
                  }
                }
                Ia(o, f, g.chartContent, m);
                Ia(b, f, g.chartContent, m)
              }
            }
            delete g.draggingItem;
            g.style.cursor = "default"
          }
        }, true);
        g.draggableDependencyItems.push(b)
      }
    }, Nb = function (a, d) {
      if (typeof d.draggingItem !== "undefined") {
        var b = d, c = 0;
        if (b.offsetParent) {
          do {
            c = c + b.offsetLeft;
            b = b.offsetParent
          } while (b)
        }
        a = a - c;
        if (a < d.gridContentContainer.offsetWidth + 24) {
          b = d.chartContentContainer.scrollLeft;
          d.chartContentContainer.scrollLeft = d.chartContentContainer.scrollLeft - 20;
          b = b - d.chartContentContainer.scrollLeft;
          if (typeof d.draggingInitialStartPosition !== "undefined") d.draggingInitialStartPosition = d.draggingInitialStartPosition - b;
          if (typeof d.draggingInitialFinishPosition !== "undefined") d.draggingInitialFinishPosition = d.draggingInitialFinishPosition - b;
          if (typeof d.draggingInitialCompletedFinishPosition !== "undefined") d.draggingInitialCompletedFinishPosition =
            d.draggingInitialCompletedFinishPosition - b
        } else if (a >= d.gridContentContainer.offsetWidth + d.chartContentContainer.clientWidth - 24) {
          b = d.chartContentContainer.scrollLeft;
          d.chartContentContainer.scrollLeft = d.chartContentContainer.scrollLeft + 20;
          b = d.chartContentContainer.scrollLeft - b;
          if (typeof d.draggingInitialStartPosition !== "undefined") d.draggingInitialStartPosition = d.draggingInitialStartPosition + b;
          if (typeof d.draggingInitialFinishPosition !== "undefined") d.draggingInitialFinishPosition = d.draggingInitialFinishPosition +
            b;
          if (typeof d.draggingInitialCompletedFinishPosition !== "undefined") d.draggingInitialCompletedFinishPosition = d.draggingInitialCompletedFinishPosition + b
        }
      }
    }, xc = function (a) {
      var d = 0;
      if (a.offsetParent) {
        do {
          d = d + a.offsetTop;
          a = a.offsetParent
        } while (a)
      }
      return d
    }, Ob = function (a, d) {
      if (typeof d.draggingItem !== "undefined") {
        var a = a - xc(d), b, c;
        if (a < d.chartHeaderContainer.clientHeight + 24) {
          b = d.chartContentContainer.scrollTop;
          d.chartContentContainer.scrollTop = d.chartContentContainer.scrollTop - 20;
          if (typeof d.isDuringVerticalScrolling ===
            "undefined") {
            d.isDuringVerticalScrolling = true;
            setTimeout(function () {
              c = b - d.chartContentContainer.scrollTop;
              d.draggingInitialThumbPosition = d.draggingInitialThumbPosition - c;
              delete d.isDuringVerticalScrolling
            }, 0)
          }
        } else if (a >= d.chartHeaderContainer.clientHeight + d.chartContentContainer.clientHeight - 24) {
          b = d.chartContentContainer.scrollTop;
          d.chartContentContainer.scrollTop = d.chartContentContainer.scrollTop + 20;
          if (typeof d.isDuringVerticalScrolling === "undefined") {
            d.isDuringVerticalScrolling = true;
            setTimeout(function () {
              c =
                d.chartContentContainer.scrollTop - b;
              d.draggingInitialThumbPosition = d.draggingInitialThumbPosition + c;
              delete d.isDuringVerticalScrolling
            }, 0)
          }
        }
      }
    }, Ia = function (a, d, b, c) {
      $(a.chartItem, a, c);
      sa(d, a);
      setTimeout(function () {
        if (typeof a.gridItem !== "undefined") {
          if (typeof a.completedInput !== "undefined") {
            var e = a.completedInput;
            typeof e.changeEventListener !== "undefined" && e.removeEventListener("change", e.changeEventListener, true);
            delete a.completedInput
          }
          na(a.gridItem, a, d, c.columns, b, c.toggleButtonAreaWidth, c)
        }
        for (e =
               a.parent; e != null;) {
          Ma(e, false);
          a = e;
          $(a.chartItem, a, c);
          sa(d, a);
          typeof a.gridItem !== "undefined" && na(a.gridItem, a, d, c.columns, b, c.toggleButtonAreaWidth, c);
          e = a.parent
        }
      }, 0)
    }, Pb = function (a) {
      var d = a.itemTop - a.ganttChartView.chartContentContainer.scrollTop;
      if (d < 0) a.ganttChartView.chartContentContainer.scrollTop = a.itemTop; else if (d > a.ganttChartView.chartContentContainer.clientHeight - a.ganttChartView.settings.itemHeight) a.ganttChartView.chartContentContainer.scrollTop = a.itemTop - (a.ganttChartView.chartContentContainer.clientHeight -
        a.ganttChartView.settings.itemHeight)
    }, lc = function (a, d, b, c, e, f, g, m, o, n, p, h, j, k) {
      d.addEventListener("scroll", function () {
        if (g.scrollTop != d.scrollTop) g.scrollTop = d.scrollTop;
        if (c.scrollLeft != d.scrollLeft) c.scrollLeft = d.scrollLeft
      }, true);
      ua(d, b, e, k);
      f.addEventListener("resize", function () {
        ua(d, b, e, k)
      }, true);
      b.addEventListener("resize", function () {
        ua(d, b, e, k);
        pa(h, b, k)
      }, true);
      g.addEventListener("scroll", function () {
        if (d.scrollTop != g.scrollTop) d.scrollTop = g.scrollTop;
        if (m.scrollLeft != g.scrollLeft) m.scrollLeft =
          g.scrollLeft;
        la(j, g, k);
        k.displayedTime = Aa(g.scrollLeft, k);
        (typeof a.isDuringScrollToDateTime === "undefined" || !a.isDuringScrollToDateTime) && typeof k.displayedTimeChangeHandler !== "undefined" && setTimeout(function () {
          k.displayedTimeChangeHandler(k.displayedTime)
        }, 0);
        typeof a.isDuringScrollToDateTime !== "undefined" && delete a.isDuringScrollToDateTime
      }, true);
      setTimeout(function () {
        if (m.scrollLeft != g.scrollLeft) m.scrollLeft = g.scrollLeft;
        la(j, g, k)
      }, 1);
      ua(g, o, n, k);
      p.addEventListener("resize", function () {
        ua(g, o,
          n, k)
      }, true);
      o.addEventListener("resize", function () {
        Xa(p, g);
        ea(p, fa(j, k));
        ua(g, o, n, k)
      }, true);
      window.addEventListener("mousewheel", function () {
        try {
          a.cancelDrag = true
        } catch (b) {
        }
      }, true)
    }, Xa = function (a, d) {
      if (d.style.height != "auto") a.availableHeight = d.clientHeight
    }, ua = function (a, d, b, c) {
      setTimeout(function () {
        var e = d.clientWidth - a.clientWidth;
        e < 0 && (e = 0);
        b.style.width = e + "px";
        if (e > 0) {
          b.style.boxSizing = "border-box";
          b.style.MozBoxSizing = "border-box";
          b.style.border = "solid 1px " + c.border;
          b.style.borderTop = "none";
          b.style.borderRight = "none"
        } else {
          b.style.border = "";
          b.style.borderTop = "";
          b.style.borderRight = "";
          b.style.boxSizing = "";
          b.style.MozBoxSizing = ""
        }
      }, 0)
    }, pa = function (a, d, b) {
      if (b.isSplitterEnabled) {
        a.style.height = d.clientHeight + "px";
        a.style.left = Math.max(0, d.offsetWidth - 1) + "px"
      }
    }, la = function (a, d, b) {
      if (!(typeof d.isInitializing !== "undefined" && d.isInitializing) && b.isVirtualizing) for (var c = d.scrollTop - b.itemHeight, d = c + d.clientHeight + 2 * b.itemHeight, e = 0; e < a.length; e++) {
        var f = a[e];
        if (!f.isPart) if (typeof f.isVirtuallyVisible ===
          "undefined" && (typeof f.isVisible === "undefined" || f.isVisible) && !(typeof f.isHidden !== "undefined" && f.isHidden) && typeof f.itemTop !== "undefined" && f.itemTop >= c && f.itemTop < d) {
          f.isVirtuallyVisible = true;
          u(f, "isVirtuallyVisible", false, true);
          typeof f.gridItem !== "undefined" && na(f.gridItem, f, a, b.columns, f.ganttChartView.chartContent, b.toggleButtonAreaWidth, b);
          $(f.chartItem, f, b);
          f.chartItem.setAttribute("transform", "translate(0, " + f.itemTop + ")");
          ra(f, f.itemTop)
        } else typeof f.isVirtuallyVisible !== "undefined" &&
        ((typeof f.isVisible === "undefined" || f.isVisible) && !(typeof f.isHidden !== "undefined" && f.isHidden) && typeof f.itemTop !== "undefined" && (f.itemTop < c || f.itemTop >= d)) && delete f.isVirtuallyVisible
      }
    }, ic = function (a, d) {
      for (var b = a.childNodes.length; b-- > 0;) a.removeChild(a.childNodes[b]);
      a.appendChild(d)
    }, Qb = function (a, d, b, c) {
      var e = c.indexOf(a);
      if (!(e < 0 || d < 0 || d == e || d >= c.length)) {
        c.splice(e, 1);
        c.splice(d, 0, a);
        for (var f = 0, g = 0; g < c.length; g++) {
          var m = c[g];
          if (m.indentation > f) {
            m.indentation = f;
            u(m, "indentation", false,
              true)
          }
          f = m.indentation + 1
        }
        V(b);
        typeof b.settings.itemMoveHandler !== "undefined" && b.settings.itemMoveHandler(a, e, d)
      }
    }, yc = function (a, d, b, c, e, f, g, m, o, n) {
      a.addEventListener("mousedown", function (b) {
        if (b.button == 0) {
          delete c.cancelDrag;
          c.draggingItem = d;
          c.dragType = "Ordering";
          c.style.cursor = a.style.cursor;
          c.draggingInitialY = b.clientY;
          c.draggingInitialThumbPosition = 0;
          c.resetChartAreaDefinitions();
          b.preventDefault()
        }
      }, true);
      if (typeof c.draggableOrderingItems === "undefined") c.draggableOrderingItems = [];
      for (var p =
        false, h = 0; h < c.draggableOrderingItems.length; h++) if (c.draggableOrderingItems[h] == d) {
        p = true;
        break
      }
      if (!p) {
        c.addEventListener("mousemove", function (a) {
          if (!(typeof c.draggingItem === "undefined" || c.draggingItem != d || c.dragType != "Ordering")) {
            if (typeof c.temporaryHoveredGridItemSelectionContainer !== "undefined") {
              c.temporaryHoveredGridItemSelectionContainer.setAttribute("class", c.temporaryHoveredGridItemClass);
              c.temporaryHoveredGridItemSelectionContainer.setAttribute("style", c.temporaryHoveredGridItemStyle);
              delete c.temporaryHoveredGridItemSelectionContainer;
              delete c.temporaryHoveredGridItemClass;
              delete c.temporaryHoveredGridItemStyle
            }
            var p = a.clientY - c.draggingInitialY;
            Ob(a.clientY, c);
            delete c.draggingItem;
            if (c.cancelDrag) {
              t(d, e);
              delete c.cancelDrag;
              delete c.draggingItem;
              c.style.cursor = "default"
            } else {
              for (var a = Math.floor((d.itemTop + c.draggingInitialThumbPosition + p) / e.itemHeight), p = null, h = 0, j = 0; j < b.length; j++) {
                var k = b[j];
                if (k.isVisible && !(typeof k.isHidden !== "undefined" && k.isHidden) && typeof k.displayRowIndex === "undefined") {
                  if (h == a) {
                    p = k;
                    break
                  }
                  h++
                }
              }
              if (p !=
                null && p != d && p.gridItemSelectionContainer != null) {
                c.temporaryHoveredGridItemSelectionContainer = p.gridItemSelectionContainer;
                c.temporaryHoveredGridItemClass = p.gridItemSelectionContainer.getAttribute("class");
                c.temporaryHoveredGridItemStyle = p.gridItemSelectionContainer.getAttribute("style");
                typeof f === "undefined" || f(a, p) ? typeof g !== "undefined" ? p.gridItemSelectionContainer.setAttribute("class", g) : typeof m !== "undefined" && p.gridItemSelectionContainer.setAttribute("style", m) : typeof o !== "undefined" ? p.gridItemSelectionContainer.setAttribute("class",
                  o) : typeof n !== "undefined" && p.gridItemSelectionContainer.setAttribute("style", n)
              }
              c.draggingItem = d
            }
          }
        }, true);
        c.addEventListener("mouseup", function (a) {
          if (!(a.button != 0 || typeof c.draggingItem === "undefined" || c.draggingItem != d || c.dragType != "Ordering")) {
            if (typeof c.temporaryHoveredGridItemSelectionContainer !== "undefined") {
              c.temporaryHoveredGridItemSelectionContainer.setAttribute("class", c.temporaryHoveredGridItemClass);
              c.temporaryHoveredGridItemSelectionContainer.setAttribute("style", c.temporaryHoveredGridItemStyle);
              delete c.temporaryHoveredGridItemSelectionContainer;
              delete c.temporaryHoveredGridItemClass;
              delete c.temporaryHoveredGridItemStyle
            }
            for (var a = Math.floor((d.itemTop + c.draggingInitialThumbPosition + (a.clientY - c.draggingInitialY)) / e.itemHeight), m = null, o = 0, g = 0; g < b.length; g++) {
              var n = b[g];
              if (n.isVisible && !(typeof n.isHidden !== "undefined" && n.isHidden) && typeof n.displayRowIndex === "undefined") {
                if (o == a) {
                  m = n;
                  break
                }
                o++
              }
            }
            m != null && (typeof f === "undefined" || f(a, m)) && Qb(c.draggingItem, m.index, c, b);
            setTimeout(function () {
              t(d,
                e);
              Pb(d)
            }, 0);
            c.resetChartAreaDefinitions();
            delete c.draggingItem;
            c.style.cursor = "default"
          }
        }, true);
        c.draggableOrderingItems.push(d)
      }
    }, zc = function (a, d) {
      for (var b in d) b.indexOf("custom") != 0 && b.indexOf("description") != 0 || typeof a[b] === "undefined" && (a[b] = d[b])
    }, Rb = function (a, d, b, c, e, f, g, m, o, n, p, h, j, k, q, l) {
      var s, r = [], w;
      if (typeof c !== "undefined") for (s = 0; s < c.length; s++) {
        w = l.columns[c[s]];
        r.push({
          isTreeView: w.isTreeView,
          header: w.header,
          width: w.width,
          headerClass: w.headerClass,
          headerStyle: w.headerStyle,
          cellClass: w.cellClass,
          cellStyle: w.cellStyle,
          cellTemplate: typeof w.exportCellTemplate !== "undefined" ? w.exportCellTemplate : w.cellTemplate
        })
      } else for (s = 0; s < l.columns.length; s++) {
        w = l.columns[s];
        w.isSelection || r.push({
          isTreeView: w.isTreeView,
          header: w.header,
          width: w.width,
          headerClass: w.headerClass,
          headerStyle: w.headerStyle,
          cellClass: w.cellClass,
          cellStyle: w.cellStyle,
          cellTemplate: typeof w.exportCellTemplate !== "undefined" ? w.exportCellTemplate : w.cellTemplate
        })
      }
      if (typeof b === "undefined") b = l.isGridVisible;
      s = b ? Wa(r) + 1 : 0;
      if (typeof e !==
        "undefined") {
        if (typeof g === "undefined" || !g) e = new Date(e.valueOf() - e.getTimezoneOffset() * 6E4)
      } else e = l.timelineStart;
      if (typeof f !== "undefined") {
        if (typeof g === "undefined" || !g) f = new Date(f.valueOf() - f.getTimezoneOffset() * 6E4)
      } else f = l.timelineFinish;
      e = {
        isExport: true,
        isReadOnly: true,
        selectionMode: "None",
        isVirtualizing: false,
        isGridVisible: b,
        isSplitterEnabled: false,
        gridWidth: s + "px",
        columns: r,
        allowUserToResizeColumns: false,
        isGridRowClickTimeScrollingEnabled: false,
        isMouseWheelZoomEnabled: false,
        timelineStart: e,
        timelineFinish: f,
        hourWidth: typeof m !== "undefined" ? m : l.hourWidth,
        displayedTime: typeof e !== "undefined" ? e : l.timelineStart,
        currentTime: l.currentTime,
        isTaskToolTipVisible: false,
        isDependencyToolTipVisible: false,
        containerClass: l.containerClass,
        containerStyle: l.containerStyle,
        border: l.border,
        theme: l.theme,
        headerBackground: l.headerBackground,
        headerHeight: l.headerHeight,
        itemHeight: l.itemHeight,
        itemClass: l.itemClass,
        itemStyle: l.itemStyle,
        standardItemClass: l.standardItemClass,
        summaryItemClass: l.summaryItemClass,
        milestoneItemClass: l.milestoneItemClass,
        standardItemStyle: l.standardItemStyle,
        summaryItemStyle: l.summaryItemStyle,
        milestoneItemStyle: l.milestoneItemStyle,
        indentationLevelWidth: l.indentationLevelWidth,
        toggleButtonClass: l.toggleButtonClass,
        toggleButtonStyle: l.toggleButtonStyle,
        scales: [],
        visibleWeekStart: l.visibleWeekStart,
        visibleWeekFinish: l.visibleWeekFinish,
        workingWeekStart: l.workingWeekStart,
        workingWeekFinish: l.workingWeekFinish,
        visibleDayStart: l.visibleDayStart,
        visibleDayFinish: l.visibleDayFinish,
        specialNonworkingDays: l.specialNonworkingDays,
        barMargin: l.barMargin,
        barHeight: l.barHeight,
        barCornerRadius: l.barCornerRadius,
        completedBarMargin: l.completedBarMargin,
        completedBarHeight: l.completedBarHeight,
        completedBarCornerRadius: l.completedBarCornerRadius,
        standardBarClass: l.standardBarClass,
        summaryBarClass: l.summaryBarClass,
        milestoneBarClass: l.milestoneBarClass,
        standardBarStyle: l.standardBarStyle,
        summaryBarStyle: l.summaryBarStyle,
        milestoneBarStyle: l.milestoneBarStyle,
        standardCompletedBarClass: l.standardCompletedBarClass,
        standardCompletedBarStyle: l.standardCompletedBarStyle,
        dependencyLineClass: l.dependencyLineClass,
        dependencyLineStyle: l.dependencyLineStyle,
        assignmentsClass: l.assignmentsClass,
        assignmentsStyle: l.assignmentsStyle,
        areTaskAssignmentsVisible: l.areTaskAssignmentsVisible,
        isTaskCompletedEffortVisible: l.isTaskCompletedEffortVisible,
        areTaskDependenciesVisible: l.areTaskDependenciesVisible,
        isBaselineVisible: l.isBaselineVisible,
        alternativeItemClass: l.alternativeItemClass,
        alternativeChartItemClass: l.alternativeChartItemClass,
        alternativeItemStyle: l.alternativeItemStyle,
        alternativeChartItemStyle: l.alternativeChartItemStyle,
        taskInitiationCost: l.taskInitiationCost,
        defaultResourceUsageCost: l.defaultResourceUsageCost,
        specificResourceUsageCosts: l.specificResourceUsageCosts,
        defaultResourceHourCost: l.defaultResourceHourCost,
        specificResourceHourCosts: l.specificResourceHourCosts,
        target: l.target,
        months: l.months,
        daysOfWeek: l.daysOfWeek,
        weekStartDay: l.weekStartDay,
        dateFormatter: l.dateFormatter,
        dateTimeFormatter: l.dateTimeFormatter,
        isRelativeToTimezone: l.isRelativeToTimezone
      };
      e.timelineStart = ma(e.timelineStart, e.weekStartDay);
      e.timelineFinish = Za(e.timelineFinish, e.weekStartDay);
      f = D(e.timelineFinish, e);
      e.chartWidth = f + "px";
      var u = s + f + 2 + (b ? 1 : 0);
      for (s = 0; s < l.scales.length; s++) {
        b = l.scales[s];
        e.scales.push({
          scaleType: b.scaleType,
          isHeaderVisible: b.isHeaderVisible,
          headerHeight: b.headerHeight,
          headerTextFormat: b.headerTextFormat,
          headerClass: b.headerClass,
          headerStyle: b.headerStyle,
          isHighlightingVisible: b.isHighlightingVisible,
          highlightingClass: b.highlightingClass,
          highlightingStyle: b.highlightingStyle,
          isSeparatorVisible: b.isSeparatorVisible,
          separatorClass: b.separatorClass,
          separatorStyle: b.separatorStyle
        })
      }
      var t, v, x = false;
      if (p != null && typeof p.createElement !== "undefined") t = p; else {
        if (p != null && typeof p.focus !== "undefined") v = p; else {
          v = window.open("", p != null ? p : "_blank", typeof h !== "undefined" && h && (typeof k === "undefined" || k) ? "width=320,height=100,location=no,menubar=no,toolbar=no,status=no,scrollbars=yes" : "");
          x = true
        }
        t = v.document
      }
      t.title = typeof a !== "undefined" ? a : "Exported chart" +
        (typeof h !== "undefined" && h ? " (printable)" : "");
      typeof o === "undefined" && (o = 0);
      typeof n === "undefined" && (n = q.length - 1);
      a = [];
      for (s = b = 0; s < q.length; s++) {
        p = q[s];
        if (!(typeof p.displayRowIndex !== "undefined" && (p.displayRowIndex < o || p.displayRowIndex > n) || typeof p.displayRowIndex === "undefined" && (b++ < o || b > n + 1))) {
          l = {
            content: p.content,
            indentation: p.indentation,
            start: p.start,
            finish: p.finish,
            completedFinish: p.completedFinish,
            isMilestone: p.isMilestone,
            schedule: p.schedule,
            assignmentsContent: p.assignmentsContent,
            baselineStart: p.baselineStart,
            baselineFinish: p.baselineFinish,
            isBarVisible: p.isBarVisible,
            isRelativeToTimezone: p.isRelativeToTimezone,
            "class": p["class"],
            style: p.style,
            barClass: p.barClass,
            standardBarClass: p.standardBarClass,
            completedStandardBarClass: p.completedStandardBarClass,
            summaryBarClass: p.summaryBarClass,
            milestoneBarClass: p.milestoneBarClass,
            baselineBarClass: p.baselineBarClass,
            barStyle: p.barStyle,
            standardBarStyle: p.standardBarStyle,
            completedStandardBarStyle: p.completedStandardBarStyle,
            summaryBarStyle: p.summaryBarStyle,
            milestoneBarStyle: p.milestoneBarStyle,
            baselineBarStyle: p.baselineBarStyle,
            isSummaryEnabled: p.isSummaryEnabled,
            isParentSummarizationEnabled: p.isParentSummarizationEnabled,
            isHidden: p.isHidden,
            isExported: true,
            tag: p
          };
          if (typeof p.displayRowIndex !== "undefined") l.displayRowIndex = p.displayRowIndex - o;
          zc(l, p);
          a.push(l);
          p.exportItem = l
        }
      }
      for (s = 0; s < q.length; s++) {
        p = q[s];
        if (!(typeof p.displayRowIndex !== "undefined" && (p.displayRowIndex < o || p.displayRowIndex > n))) {
          l = p.exportItem;
          if (typeof p.predecessors !== "undefined") {
            l.predecessors = [];
            for (b = 0; b < p.predecessors.length; b++) {
              f =
                p.predecessors[b];
              typeof f.item.displayRowIndex !== "undefined" && (f.item.displayRowIndex < o || f.item.displayRowIndex > n) || l.predecessors.push({
                item: f.item.exportItem,
                dependencyType: f.dependencyType,
                lag: f.lag,
                dependencyLineClass: f.dependencyLineClass,
                dependencyLineStyle: f.dependencyLineStyle
              })
            }
          }
        }
      }
      var y = t.createElement("p");
      y.innerHTML = typeof d !== "undefined" ? d : "";
      t.body.appendChild(y);
      var B = t.createElement("div");
      B.setAttribute("style", "width: " + u + "px");
      try {
        DlhSoft.Controls.GanttChartView.initialize(B, a,
          e, "DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")
      } catch (J) {
      }
      setTimeout(function () {
        x && t.body.setAttribute("style", "margin: 0px");
        var a = t.createElement("div");
        a.appendChild(B);
        t.body.replaceChild(a, y);
        if (j) {
          a.setAttribute("style", "width: " + B.offsetHeight + "px; height: " + u + "px; overflow: hidden");
          a = Math.round((B.offsetWidth - B.offsetHeight) / 2);
          B.setAttribute("style", "width: " + u + "px; transform: rotate(90deg) translateX(" +
            a + "px) translateY(" + a + "px); -webkit-transform: rotate(90deg) translateX(" + a + "px) translateY(" + a + "px)")
        }
        t.close();
        if (typeof v !== void 0) {
          v.focus();
          if (typeof h !== "undefined" && h) {
            v.print();
            (typeof k === "undefined" || k) && v.close()
          }
        }
      }, 0)
    }, Sb = function (a) {
      var d = ka;
      if (typeof a === "undefined") return d;
      for (var b = 0; b < a.length; b++) {
        var c = a[b];
        if ((!c.hasChildren || !(typeof c.isSummaryEnabled === "undefined" || c.isSummaryEnabled)) && c.start < d) d = c.start
      }
      return new Date(d.valueOf())
    }, Tb = function (a) {
      var d = T;
      if (typeof a ===
        "undefined") return d;
      for (var b = 0; b < a.length; b++) {
        var c = a[b];
        if (!c.hasChildren || !(typeof c.isSummaryEnabled === "undefined" || c.isSummaryEnabled)) if (typeof c.isMilestone === "undefined" || !c.isMilestone) {
          if (c.finish > d) d = c.finish
        } else if (c.start > d) d = c.start
      }
      return new Date(d.valueOf())
    }, Ub = function (a, d) {
      for (var b = 0, c = 0; c < a.length; c++) {
        var e = a[c];
        e.parent == null && (b = b + va(e, d))
      }
      return b
    }, Vb = function (a, d) {
      for (var b = 0, c = 0; c < a.length; c++) {
        var e = a[c];
        e.parent == null && (b = b + Ua(e, d))
      }
      return b
    }, Wb = function (a, d) {
      for (var b =
        [], c = 0; c < d.length; c++) {
        var e = d[c];
        if (!(e == a || typeof e.predecessors === "undefined" || e.predecessors.length == 0)) for (var f = 0; f < e.predecessors.length; f++) if (e.predecessors[f].item == a) {
          b.push(e);
          break
        }
      }
      return b
    }, gb = function (a, d) {
      for (var b = [], c = Wb(a, d), e = 0; e < c.length; e++) {
        var f = c[e];
        if (!(typeof f.predecessors === "undefined" || f.predecessors.length == 0)) for (var g = 0; g < f.predecessors.length; g++) f.predecessors[g].item == a && b.push({
          successor: f,
          predecessor: f.predecessors[g]
        })
      }
      return b
    }, Va = function (a, d, b, c) {
      typeof d ===
      "undefined" && (d = 0);
      var e = Tb(b);
      if (a.finish >= e) return true;
      if (!a.hasChildren || !(typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled)) for (var f = gb(a, b), e = 0; e < f.length; e++) {
        var g = f[e].successor, m = f[e].predecessor;
        if (((typeof m.dependencyType === "undefined" || m.dependencyType == "" || m.dependencyType == "FinishStart" || m.dependencyType == "FS") && O(a.finish, g.start, c, a.schedule) <= d || (m.dependencyType == "StartStart" || m.dependencyType == "SS") && O(a.start, g.start, c, a.schedule) <= d) && Va(g, d, b, c)) return true
      } else {
        a =
          a.children;
        for (e = 0; e < a.length; e++) if (Va(a[e], d, b, c)) return true
      }
      return false
    }, Xb = function (a, d, b) {
      for (var c = 0; c < a.length; c++) {
        var e = a[c];
        (!e.hasChildren || !(typeof e.isSummaryEnabled === "undefined" || e.isSummaryEnabled)) && (typeof e.predecessors !== "undefined" && e.predecessors != null && e.predecessors.length > 0) && ya(e, a, d, b)
      }
    }, Yb = function (a, d) {
      for (var b = 0, c = ta(a), e = 0; e < c.length; e++) {
        var f = c[e], g = f.key, m;
        typeof d.specificResourceUsageCosts !== "undefined" && (m = Z(d.specificResourceUsageCosts, g)) >= 0 ? b = b + d.specificResourceUsageCosts[m].value *
          f.value : typeof d.defaultResourceUsageCost !== "undefined" && (b = b + d.defaultResourceUsageCost * f.value);
        if (!a.hasChildren || !(typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled)) {
          var o = va(a, d) / 36E5;
          typeof d.specificResourceHourCosts !== "undefined" && (m = Z(d.specificResourceHourCosts, g)) >= 0 ? b = b + d.specificResourceHourCosts[m].value * o * f.value : typeof d.defaultResourceHourCost !== "undefined" && (b = b + d.defaultResourceHourCost * o * f.value)
        }
      }
      return b
    }, ib = function (a, d) {
      var b = typeof d.taskInitiationCost !== "undefined" ?
        d.taskInitiationCost : 0, b = b + Yb(a, d);
      if (a.hasChildren && (typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled)) for (var c = 0; c < a.children.length; c++) b = b + hb(a.children[c], d);
      return b
    }, hb = function (a, d) {
      return (typeof a.executionCost !== "undefined" ? a.executionCost : 0) + ib(a, d)
    }, Ac = function (a) {
      for (var d = [], a = db(a), b = 0; b < a.length; b++) Zb(a[b], d);
      return d
    }, Zb = function (a, d) {
      if (!a.hasChildren || !(typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled)) d.indexOf(a) < 0 && d.push(a); else for (var b = 0; b < a.children.length; b++) Zb(a.children[b],
        d)
    }, va = function (a, d) {
      if (a.hasChildren && (typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled)) {
        for (var b = 0, c = a.children, e = 0; e < c.length; e++) b = b + va(c[e], d);
        return b
      }
      return O(a.start, a.finish, d, a.schedule)
    }, Ua = function (a, d) {
      if (a.hasChildren && (typeof a.isSummaryEnabled === "undefined" || a.isSummaryEnabled)) {
        for (var b = 0, c = a.children, e = 0; e < c.length; e++) b = b + Ua(c[e], d);
        return b
      }
      return O(a.start, a.completedFinish, d, a.schedule)
    }, $b = function (a, d) {
      for (var b = a.parent; b != null;) {
        Ma(b, d);
        a = b;
        b = a.parent
      }
    }, ac =
      function (a, d, b) {
        typeof b === "undefined" && (b = false);
        var c = a.parent, e = a.index;
        if (c == null) {
          for (c = 0; e-- > 0;) {
            a = d[e];
            a.indentation == 0 && c++
          }
          return c + (!b ? 1 : 0)
        }
        return ac(c, d) + "." + (c.children.indexOf(a) + (!b ? 1 : 0))
      }, ta = function (a) {
      var d;
      a = a.assignmentsContent;
      if (typeof a === "undefined") d = []; else {
        for (var a = a.split(","), b = [], c = 0; c < a.length; c++) {
          var e = Ja(a[c]), f = 1, g = e.indexOf("["), m = e.lastIndexOf("]");
          if (g >= 0 && m >= 0) {
            m = Ja(e.substr(g + 1, m - g - 1));
            e = Ja(e.substr(0, g));
            g = m.indexOf("%");
            g >= 0 && (m = Ja(m.substr(0, g)));
            try {
              d =
                parseFloat(m);
              f = d / 100
            } catch (o) {
              f = 1
            }
          }
          if (!(e.length <= 0)) {
            g = Z(b, e);
            g < 0 ? b.push({key: e, value: f}) : b[g].value = b[g].value + f
          }
        }
        d = b
      }
      return d
    }, bc = function (a) {
      for (var d = [], a = ta(a), b = 0; b < a.length; b++) d.push(a[b].key);
      return d
    }, wa = function (a, d) {
      if (typeof d === "undefined") return [];
      for (var b = [], c = 0; c < d.length; c++) {
        var e = d[c];
        if (!e.hasChildren || !(typeof e.isSummaryEnabled === "undefined" || e.isSummaryEnabled)) for (var f = ta(e), g = 0; g < f.length; g++) {
          var m = f[g];
          if (m.key == a) {
            b.push({key: e, value: m.value});
            break
          }
        }
      }
      return b
    }, xa =
      function (a) {
        if (typeof a === "undefined") return [];
        for (var d = [], b = 0; b < a.length; b++) {
          var c = a[b];
          if (!c.hasChildren || !(typeof c.isSummaryEnabled === "undefined" || c.isSummaryEnabled)) for (var c = bc(c), e = 0; e < c.length; e++) {
            var f = c[e];
            d.indexOf(f) < 0 && d.push(f)
          }
        }
        return d
      }, cc = function (a, d) {
      for (var b = [], c = wa(a, d), e = 0; e < c.length; e++) {
        var f = c[e], g = f.key;
        if (!g.hasChildren || !(typeof g.isSummaryEnabled === "undefined" || g.isSummaryEnabled)) for (g = [{
          start: g.start,
          finish: g.finish
        }]; g.length > 0;) {
          var m;
          m = g[0];
          g.splice(0, 1);
          if (!(m.finish <=
            m.start)) if (b.length == 0) b.push({key: m, value: f.value}); else {
            Sb(d);
            for (var o = false, n = 0; n < b.length; n++) {
              var p = b[n].key, h = b[n].value;
              if (!(m.start >= p.finish)) if (m.finish <= p.start) {
                for (o = 0; o <= n; o++) if (b[o].key.start >= m.start) {
                  b.splice(o, 0, {key: m, value: f.value});
                  break
                }
                o = true;
                break
              } else if (m.start <= p.start && m.finish >= p.finish) {
                b[n].value = h + f.value;
                m.start < p.start && g.push({start: m.start, finish: p.start});
                m.finish > p.finish && g.push({start: p.finish, finish: m.finish});
                o = true;
                break
              } else if (m.start >= p.start && m.finish <=
                p.finish) {
                b.splice(n, 1);
                m.start > p.start && b.splice(n++, 0, {key: {start: p.start, finish: m.start}, value: h});
                b.splice(n++, 0, {key: m, value: h + f.value});
                m.finish < p.finish && b.splice(n++, 0, {key: {start: m.finish, finish: p.finish}, value: h});
                o = true;
                break
              } else if (m.start >= p.start && m.finish >= p.finish) {
                b.splice(n, 1);
                m.start > p.start && b.splice(n++, 0, {key: {start: p.start, finish: m.start}, value: h});
                b.splice(n++, 0, {key: {start: m.start, finish: p.finish}, value: h + f.value});
                m.finish > p.finish && g.push({start: p.finish, finish: m.finish});
                o = true;
                break
              } else if (m.start <= p.start && m.finish <= p.finish) {
                b.splice(n, 1);
                m.start < p.start && g.push({start: m.start, finish: p.start});
                b.splice(n++, 0, {key: {start: p.start, finish: m.finish}, value: h + f.value});
                m.finish < p.finish && b.splice(n++, 0, {key: {start: m.finish, finish: p.finish}, value: h});
                o = true;
                break
              }
            }
            o || b.push({key: m, value: f.value})
          }
        }
      }
      return b
    }, jb = function (a) {
      var d = a.content;
      return a.parent == null ? d : d + " (" + jb(a.parent) + ")"
    }, kb = function (a, d) {
      return a == d ? true : a.parent == null ? false : kb(a.parent, d)
    }, Ja = function (a) {
      return a.replace(/^\s*/,
        "").replace(/\s*$/, "")
    }, Z = function (a, d) {
      for (var b = 0; b < a.length; b++) if (a[b].key == d) return b;
      return -1
    }, dc = function (a) {
      return typeof a !== "undefined" ? new Date(a.valueOf() + a.getTimezoneOffset() * 6E4) : a
    }, ec = function (a) {
      return typeof a !== "undefined" ? new Date(a.valueOf() - a.getTimezoneOffset() * 6E4) : a
    }, fc = function (a, d, b) {
      for (var c = 0; c < d.length; c++) d[c].ganttChartView = a;
      for (c = 0; c < d.length; c++) {
        var e = d[c];
        if (typeof e.parts !== "undefined") {
          if (typeof e.isGroup === "undefined") {
            e.isGroup = true;
            e.isSummaryEnabled = false
          }
          S(e.parts,
            b);
          if (e.isGroup || typeof e.isBarVisible === "undefined") e.isBarVisible = false;
          for (var f = 0; f < e.parts.length; f++) {
            var g = e.parts[f];
            g.ganttChartView = e.ganttChartView;
            g.ganttChartItem = e;
            g.isPart = true;
            g.isVirtuallyVisible = true;
            if (e.isGroup || typeof g.indentation === "undefined") g.indentation = 0;
            if (e.isGroup || typeof g.displayRowIndex === "undefined") g.displayRowIndex = -1;
            d.splice(d.length, 0, g)
          }
        }
      }
      a.items = d;
      a.settings = b;
      a.refresh = function () {
        V(a)
      };
      a.refreshItems = function () {
        Ea(d)
      };
      a.refreshGridItems = function () {
        for (var a =
          0; a < d.length; a++) Ca(d[a])
      };
      a.refreshChartItems = function () {
        for (var a = 0; a < d.length; a++) ha(d[a])
      };
      a.refreshGridItem = Ca;
      a.refreshChartItem = ha;
      a.refreshItem = ga;
      a.refreshPredecessorItems = ja;
      a.refreshItemGraph = Da;
      a.refreshItemPath = X;
      a.refreshItemNeighbourhood = function (c) {
        Fa(c, d, a, b)
      };
      a.refreshCurrentTimeLine = function () {
        var c = a.chartHeader, e = a.chartContent, f = e.chartArea, g, h = [];
        for (g = f.childNodes.length; g-- > 1;) {
          var j = f.childNodes[g];
          j.tag != "Scale-Highlighting-CurrentTime" && j.tag != "Scale-Separator-CurrentTime" &&
          h.push(j);
          f.removeChild(j)
        }
        Ya(c, f, b.scales, b, true);
        for (g = h.length; g-- > 0;) f.appendChild(h[g]);
        ea(e, fa(d, b))
      };
      a.setCurrentTime = function (c) {
        b.currentTime = c;
        a.refreshCurrentTimeLine()
      };
      a.updateCurrentTime = function () {
        var b = new Date, b = new Date(b.valueOf() - b.getTimezoneOffset() * 6E4);
        a.setCurrentTime(b)
      };
      a.getCurrentItem = function () {
        return a.currentItem
      };
      a.getSelectedItem = function () {
        return a.selectedItem
      };
      a.getSelectedItems = function () {
        return a.selectedItems
      };
      a.selectItem = function (a) {
        w(a, true, b.selectionMode)
      };
      a.unselectItem = function (a) {
        w(a, false, b.selectionMode)
      };
      a.expandItem = function (a) {
        aa(a, true, true)
      };
      a.collapseItem = function (a) {
        aa(a, false, true)
      };
      a.scrollToItem = Pb;
      a.scrollToBottom = function () {
        a.chartContentContainer.scrollTop = a.chartContent.clientHeight
      };
      a.scrollToDateTime = function (b) {
        a.isDuringScrollToDateTime = true;
        a.chartContentContainer.scrollLeft = D(b, a.settings)
      };
      a.increaseTimelinePage = function (c) {
        b.timelineStart = new Date(b.timelineStart.valueOf() + c);
        b.timelineFinish = new Date(b.timelineFinish.valueOf() +
          c);
        V(a)
      };
      a.decreaseTimelinePage = function (c) {
        b.timelineStart = new Date(b.timelineStart.valueOf() - c);
        b.timelineFinish = new Date(b.timelineFinish.valueOf() - c);
        V(a)
      };
      a.setSplitterPosition = function (c) {
        var d = a.gridContainer, e = a.chartContainer, f = a.splitter, c = Math.floor(c * 1E6 / a.offsetWidth) / 1E4;
        typeof d.percent !== "undefined" && delete d.percent;
        d.style.width = c + "%";
        e.style.width = 100 - c + "%";
        pa(f, d, b)
      };
      a.getChartPosition = function (a) {
        return D(a, b)
      };
      a.getChartWidth = function () {
        return D(b.timelineFinish, b)
      };
      a.getDateTime =
        function (a) {
          return Aa(a, b)
        };
      a.getWorkingTime = function (a) {
        return Kb(a, b)
      };
      a.getStartWorkingTime = function (a) {
        return Ga(a, b)
      };
      a.getFinishWorkingTime = function (a) {
        return F(a, b, false, true, void 0)
      };
      a.getEffort = function (a, c) {
        return O(a, c, b)
      };
      a.getFinish = function (a, c) {
        return K(a, c, b)
      };
      a.getStart = function (a, c) {
        return Ta(a, c, b)
      };
      a.getCompletion = function (a, c, d) {
        return Lb(a, c, d, b)
      };
      a.getCompletedFinish = function (a, c, d) {
        return Mb(a, c, d, b)
      };
      a.getItemsHeight = function () {
        return fa(d, b)
      };
      a.getItemTop = function (a) {
        return qa(a,
          d, b)
      };
      a.onItemPropertyChanged = u;
      a.initializeTaskDraggingThumbs = function (b, c, d, e, f, g, h, j) {
        bb(b, c, d, e, f, g, h, j, a.items, a, a.settings)
      };
      a.initializeDependencyDraggingThumb = function (b, c, d, e, f) {
        Ra(b, c, d, e, f, a.items, a, a.settings)
      };
      a.insertItem = function (c, e) {
        Hb(c, e, a, d, b)
      };
      a.addItem = function (b) {
        a.insertItem(d.length, b)
      };
      a.insertItems = function (b, c) {
        for (var d = 0; d < c.length; d++) a.insertItem(b++, c[d])
      };
      a.addItems = function (b) {
        for (var c = 0; c < b.length; c++) a.addItem(b[c])
      };
      a.removeItem = function (c) {
        var e = c.index, f = c.itemTop,
          g = null, h = false;
        if (e > 0) {
          for (g = d[e - 1]; g.parent != null;) g = g.parent;
          h = g.isExpanded;
          c.hasChildren && aa(g, c.isExpanded, false, true);
          g.indentation >= c.indentation && (g = null)
        } else d[0].isExpanded || aa(d[0], true, false, true);
        var j = e + 1 < d.length ? d[e + 1] : null;
        j != null && (!j.isExpanded && j.indentation > c.indentation) && aa(j, true, false, true);
        var k = j != null ? j.indentation : null, l, q, s;
        for (q = 0; q < a.items.length; q++) {
          l = a.items[q];
          if (l.predecessors != null) for (s = l.predecessors.length; s-- > 0;) if (l.predecessors[s].item == c) {
            l.predecessors.splice(s,
              1);
            u(l, "predecessors", false, true);
            ga(l);
            ja(l)
          }
        }
        d.splice(e, 1);
        Ka(d, a);
        La(d, b, a);
        b.isGridVisible && typeof c.displayRowIndex === "undefined" && typeof c.gridItemContainer !== "undefined" && a.gridContent.removeChild(c.gridItemContainer);
        q = a.chartContent.chartArea;
        typeof c.chartItem !== "undefined" && q.removeChild(c.chartItem);
        j = e < d.length ? d[e] : null;
        if (j != null && j.indentation < k) {
          u(j, "indentation", false, true);
          j.predecessors = [];
          u(j, "predecessors", false, true);
          for (q = 0; q < d.length; q++) {
            l = d[q];
            if (!(l == j || typeof l.predecessors ===
              "undefined" || l.predecessors.length == 0)) for (s = 0; s < l.predecessors.length; s++) if (l.predecessors[s].item == j) {
              l.predecessors.splice(s--, 1);
              u(l, "predecessors", false, true);
              ga(l);
              ja(l)
            }
          }
        }
        g != null && aa(g, h, false, true);
        for (q = e; q < d.length; q++) {
          c = d[q];
          actualItemTop = f;
          typeof c.displayRowIndex !== "undefined" && (actualItemTop = c.displayRowIndex * b.itemHeight);
          c.isVisible && !(typeof c.isHidden !== "undefined" && c.isHidden) && (f = Math.max(f, actualItemTop + b.itemHeight));
          c.itemTop = actualItemTop;
          ga(c)
        }
        ea(a.chartContent, fa(d, b));
        Pa(d, a.chartContent, b);
        Qa(d, b) && Ea(d);
        e >= d.length && (e = d.length - 1);
        if (e >= 0) {
          for (q = 0; q < e; q++) ha(d[q]);
          Fa(d[e], d, a, b)
        }
        la(d, a.chartContentContainer, b)
      };
      a.removeItems = function (b) {
        for (var c = 0; c < b.length; c++) a.removeItem(b[c])
      };
      a.increaseItemIndentation = function (c) {
        var e = c.index > 0 ? a.items[c.index - 1] : null;
        if (!(e == null || c.indentation > e.indentation)) {
          aa(c, true, false, true);
          c.indentation++;
          u(c, "indentation", true, true);
          c.predecessors = [];
          u(c, "predecessors", false, true);
          for (e = 0; e < d.length; e++) {
            var f = d[e];
            if (!(f ==
              c || typeof f.predecessors === "undefined" || f.predecessors.length == 0)) for (var g = 0; g < f.predecessors.length; g++) if (f.predecessors[g].item == c) {
              f.predecessors.splice(g--, 1);
              u(f, "predecessors", false, true);
              ga(f);
              ja(f)
            }
          }
          Qa(d, b) && Ea(d);
          for (Fa(c, d, a, b); c != null;) {
            c.isExpanded || aa(c, true, false);
            c = c.parent
          }
        }
      };
      a.decreaseItemIndentation = function (c) {
        var e = c.index < a.items.length - 1 ? a.items[c.index + 1] : null;
        if (!(c.indentation <= 0 || e != null && c.indentation < e.indentation)) {
          c.indentation--;
          u(c, "indentation", true, true);
          c.predecessors =
            [];
          u(c, "predecessors", false, true);
          for (e = 0; e < d.length; e++) {
            var f = d[e];
            if (!(f == c || typeof f.predecessors === "undefined" || f.predecessors.length == 0)) for (var g = 0; g < f.predecessors.length; g++) if (f.predecessors[g].item == c) {
              f.predecessors.splice(g--, 1);
              u(f, "predecessors", false, true);
              ga(f);
              ja(f)
            }
          }
          Qa(d, b) && Ea(d);
          for (Fa(c, d, a, b); c != null;) {
            c.isExpanded || aa(c, true, false);
            c = c.parent
          }
        }
      };
      a.setItemContent = function (a, b) {
        a.content = b;
        u(a, "content", true, true)
      };
      a.setItemStart = function (a, c) {
        a.start = Ga(c, b, a.schedule);
        a.preferredStart =
          a.start;
        u(a, "start", true, true);
        if (a.completedFinish < a.start) {
          a.completedFinish = a.start;
          u(a, "completedFinish", false, true)
        }
      };
      a.setItemFinish = function (a, c) {
        a.finish = F(c, b, false, true, a.schedule);
        u(a, "finish", true, true);
        if (a.completedFinish > a.finish) {
          a.completedFinish = a.finish;
          u(a, "completedFinish", false, true)
        }
      };
      a.setItemIsMilestone = function (a, b) {
        a.isMilestone = b;
        u(a, "isMilestone", true, true)
      };
      a.getItemEffort = function (a) {
        return va(a, b)
      };
      a.setItemEffort = function (a, c) {
        a.finish = K(a.start, c, b, a.schedule);
        u(a,
          "finish", true, true);
        if (a.completedFinish > a.finish) {
          a.completedFinish = a.finish;
          u(a, "completedFinish", false, true)
        }
      };
      a.getItemTotalEffort = function (a) {
        return eb(a)
      };
      a.setItemTotalEffort = function (a, b) {
        a.ganttChartView.setItemEffort(a, b / Ha(a))
      };
      a.getItemDuration = function (a) {
        return O(a.start, a.finish, b, a.schedule)
      };
      a.setItemDuration = a.setItemEffort;
      a.getItemCompletedEffort = function (a) {
        return Ua(a, b)
      };
      a.setItemCompletedEffort = function (a, c) {
        a.completedFinish = K(a.start, c, b, a.schedule);
        if (a.completedFinish >
          a.finish) a.completedFinish = a.finish;
        u(a, "completedFinish", true, true)
      };
      a.getItemTotalCompletedEffort = function (a) {
        return fb(a)
      };
      a.setItemTotalCompletedEffort = function (a, b) {
        a.ganttChartView.setItemCompletedEffort(a, b / Ha(a))
      };
      a.getItemCompletion = function (b) {
        return a.getItemCompletedEffort(b) / a.getItemEffort(b)
      };
      a.setItemCompletion = function (b, c) {
        a.setItemCompletedEffort(b, c * a.getItemEffort(b))
      };
      a.isItemCompleted = function (b) {
        return a.getItemCompletion(b) >= 1 || (b.isMilestone || b.finish.valueOf() <= b.start.valueOf()) &&
          typeof b.isSetAsCompleted !== "undefined" && b.isSetAsCompleted
      };
      a.setItemAsCompleted = function (b) {
        if (b.isMilestone || b.finish.valueOf() <= b.start.valueOf()) b.isSetAsCompleted = true;
        a.setItemCompletion(b, 1)
      };
      a.hasItemStarted = function (a) {
        return a.completedFinish > a.start
      };
      a.setItemAsNotStarted = function (b) {
        if (b.isMilestone || b.finish.valueOf() <= b.start.valueOf()) b.isSetAsCompleted = false;
        a.setItemCompletion(b, 0)
      };
      a.isItemOnSchedule = function (a) {
        var b = new Date, b = new Date(b.valueOf() - b.getTimezoneOffset() * 6E4);
        return a.completedFinish >=
          b
      };
      a.setItemAssignmentsContent = function (a, b) {
        a.assignmentsContent = b;
        u(a, "assignmentsContent", true, true)
      };
      a.getItemPredecessorsString = function (a, b) {
        var c = b;
        typeof c === "undefined" && (c = false);
        var e = "";
        if (!(typeof a.predecessors === "undefined" || a.predecessors.length == 0)) for (var f = 0; f < a.predecessors.length; f++) {
          var g = a.predecessors[f], h = d.indexOf(g.item);
          if (!(h < 0)) {
            e.length > 0 && (e = e + ", ");
            e = e + (h + (!c ? 1 : 0));
            if (typeof g.dependencyType !== "undefined" && g.dependencyType != "" && g.dependencyType != "FinishStart" && g.dependencyType !=
              "FS") if (g.dependencyType == "StartStart" || g.dependencyType == "SS") e = e + "SS"; else if (g.dependencyType == "FinishFinish" || g.dependencyType == "FF") e = e + "FF"; else if (g.dependencyType == "StartFinish" || g.dependencyType == "SF") e = e + "SF";
            if (typeof g.lag !== "undefined" && g.lag != 0) {
              g.lag > 0 && (e = e + "+");
              e = e + g.lag / 36E5
            }
          }
        }
        return e
      };
      a.setItemPredecessorsString = function (a, b, c) {
        typeof c === "undefined" && (c = false);
        var e = [];
        a.predecessors = e;
        for (var b = b.split(","), f = 0; f < b.length; f++) {
          var g = Ja(b[f]);
          if (!(g.length <= 0)) {
            for (var h = 0; h <
            g.length && g.charCodeAt(h) >= 48 && g.charCodeAt(h) <= 57;) h++;
            var j = g.substr(0, h), j = parseInt(j) - (!c ? 1 : 0);
            if (!isNaN(j) && !(j < 0 || j > d.length)) {
              j = d[j];
              if (!(a == j || za(a, j) || za(j, a)) && !Na(a, j) && !Na(j, a)) {
                var g = g.substr(h), h = g.indexOf("+"), k = g.indexOf("-"), l = h >= 0 ? h : k >= 0 ? k : -1, k = 0;
                if (l >= 0) {
                  var q = parseFloat(g.substr(l + 1));
                  isNaN(q) || (k = q * (h >= 0 ? 1 : -1) * 36E5)
                }
                g = (l < 0 ? g : g.substr(0, l)).toUpperCase();
                e.push({item: j, dependencyType: g, lag: k})
              }
            }
          }
        }
        u(a, "predecessors", true, true)
      };
      a.getItemIndexString = function (a, b) {
        typeof b === "undefined" &&
        (b = false);
        return typeof a.index !== "undefined" ? (a.index + (!b ? 1 : 0)).toString() : ""
      };
      a.getItemWbsIndexString = function (a, b) {
        return ac(a, d, b).toString()
      };
      a.moveItem = function (b, c) {
        Qb(b, c, a, d)
      };
      a.exportContent = function (a, c) {
        typeof a === "undefined" && (a = {});
        Rb(a.title, a.preparingMessage, a.isGridVisible, a.columnIndexes, a.timelineStart, a.timelineFinish, a.isRelativeToTimezone, a.hourWidth, a.startRowIndex, a.endRowIndex, c, false, a.rotate, false, d, b)
      };
      a.print = function (a) {
        typeof a === "undefined" && (a = {});
        Rb(a.title, a.preparingMessage,
          a.isGridVisible, a.columnIndexes, a.timelineStart, a.timelineFinish, a.isRelativeToTimezone, a.hourWidth, a.startRowIndex, a.endRowIndex, null, true, a.rotate, a.autoClose, d, b)
      };
      a.getRootItems = function () {
        for (var a = [], b = 0; b < d.length; b++) {
          var c = d[b];
          c.parent == null && a.push(c)
        }
        return a
      };
      a.getLeaveItems = function () {
        for (var a = [], b = 0; b < d.length; b++) {
          var c = d[b];
          c.parent != null && a.push(c)
        }
        return a
      };
      a.getProjectStart = function () {
        return Sb(d)
      };
      a.getProjectFinish = function () {
        return Tb(d)
      };
      a.getProjectEffort = function () {
        return Ub(d,
          b)
      };
      a.getProjectTotalEffort = function () {
        for (var a = 0, b = 0; b < d.length; b++) {
          var c = d[b];
          c.parent == null && (a = a + eb(c))
        }
        return a
      };
      a.getProjectCompletedEffort = function () {
        return Vb(d, b)
      };
      a.getProjectTotalCompletedEffort = function () {
        for (var a = 0, b = 0; b < d.length; b++) {
          var c = d[b];
          c.parent == null && (a = a + fb(c))
        }
        return a
      };
      a.getProjectCompletion = function () {
        return Vb(d, b) / Ub(d, b)
      };
      a.isItemCritical = function (a, c) {
        return Va(a, c, d, b)
      };
      a.getCriticalItems = function (a) {
        typeof a === "undefined" && (a = 0);
        if (typeof d === "undefined") a = void 0;
        else {
          for (var c = [], e = 0; e < d.length; e++) {
            var f = d[e];
            (!f.hasChildren || !(typeof f.isSummaryEnabled === "undefined" || f.isSummaryEnabled)) && Va(f, a, d, b) && c.push(f)
          }
          a = c
        }
        return a
      };
      a.ensureDependencyConstraints = function () {
        Xb(d, b, a)
      };
      a.setupBaseline = function () {
        for (var a = 0; a < d.length; a++) {
          var b = d[a];
          if (!b.hasChildren || !(typeof b.isSummaryEnabled === "undefined" || b.isSummaryEnabled)) {
            b.baselineStart = b.start;
            b.isMilestone ? delete b.baselineFinish : b.baselineFinish = b.finish
          } else {
            delete b.baselineFinish;
            delete b.baselineStart
          }
          ga(b)
        }
      };
      a.splitRemainingWork = function (c, e, f) {
        if (typeof d === "undefined" || c.hasChildren || c.isMilestone || !(c.completedFinish > c.start) || c.completedFinish >= c.finish) c = null; else {
          var g = d.indexOf(c);
          if (g < 0) c = null; else {
            e = {
              content: typeof e === "undefined" ? c.content : c.content + e,
              indentation: c.indentation,
              isExpanded: c.isExpanded,
              start: c.completedFinish,
              finish: c.finish,
              assignmentsContent: c.assignmentsContent,
              isReadOnly: c.isReadOnly,
              isHidden: c.isHidden,
              isBarVisible: c.isBarVisible,
              isBarReadOnly: c.isBarReadOnly,
              isSummaryEnabled: c.isSummaryEnabled,
              isParentSummarizationEnabled: c.isParentSummarizationEnabled,
              displayRowIndex: c.displayRowIndex,
              "class": c["class"],
              style: c.style,
              barClass: c.barClass,
              standardBarClass: c.standardBarClass,
              summaryBarClass: c.summaryBarClass,
              milestoneBarClass: c.milestoneBarClass,
              baselineBarClass: c.baselineBarClass,
              barStyle: c.barStyle,
              standardBarStyle: c.standardBarStyle,
              summaryBarStyle: c.summaryBarStyle,
              milestoneBarStyle: c.milestoneBarStyle,
              baselineBarStyle: c.baselineBarStyle,
              taskTemplate: c.taskTemplate,
              template: c.template,
              tag: c.tag
            };
            if (typeof f !== "undefined") c.content = c.content + f;
            c.finish = c.completedFinish;
            Hb(g + 1, e, a, d, b);
            f = gb(c, d);
            for (g = 0; g < f.length; g++) {
              var h = f[g].predecessor;
              if (typeof h.dependencyType === "undefined" || h.dependencyType == "" || h.dependencyType == "FinishStart" || h.dependencyType == "FS" || h.dependencyType == "FinishFinish" || h.dependencyType == "FF") h.item = e
            }
            e.predecessors = [{item: c}];
            ja(c);
            ja(e);
            c = e
          }
        }
        return c
      };
      a.levelResources = function (c, e) {
        var f;
        var g = c, h = e;
        if (typeof d === "undefined") f = void 0; else {
          typeof g === "undefined" &&
          (g = false);
          typeof h === "undefined" && (h = new Date);
          Xb(d, b, a);
          var j = [], k = [], l, q, s, w = [];
          for (q = 0; q < d.length; q++) {
            l = d[q];
            if (!l.hasChildren || !(typeof l.isSummaryEnabled === "undefined" || l.isSummaryEnabled)) {
              j.push({key: l, value: Ac(l)});
              var r = ta(l), t = [];
              for (s = 0; s < r.length; s++) {
                var v = r[s];
                v.value > 0 && t.push(v)
              }
              k.push({key: l, value: t});
              w.push(l)
            }
          }
          r = [];
          for (t = j.length; t > 0;) {
            v = [];
            for (q = 0; q < j.length; q++) {
              l = j[q].key;
              var x = true, y = j[q].value;
              for (s = 0; s < y.length; s++) {
                var J = y[s];
                if (Z(j, J) >= 0 && v.indexOf(J) < 0) {
                  x = false;
                  break
                }
              }
              if (x) {
                s =
                  l;
                x = h;
                y = b;
                if (typeof s.minStart !== "undefined" && x < s.minStart) x = s.minStart;
                if (g || !(s.completedFinish > s.start)) for (; s != null;) {
                  if (typeof s.predecessors !== "undefined") for (J = 0; J < s.predecessors.length; J++) {
                    var B = s.predecessors[J];
                    if (typeof B !== "undefined") {
                      var z = B.dependencyType;
                      typeof z === "undefined" && (z = "FinishStart");
                      switch (z) {
                        case "":
                        case "FinishStart":
                        case "FS":
                          B = K(B.item.finish, typeof B.lag === "undefined" ? 0 : B.lag, y, B.item.schedule);
                          B > x && (x = B);
                          break;
                        case "StartStart":
                        case "SS":
                          B = K(B.item.start, typeof B.lag ===
                          "undefined" ? 0 : B.lag, y, B.item.schedule);
                          B > x && (x = B)
                      }
                    }
                  }
                  for (s = s.parent; s != null && typeof s.isSummaryEnabled !== "undefined" && !s.isSummaryEnabled;) s = s.parent
                }
                var y = Z(k, l), y = k[y].value, G, D, E;
                for (s = 0; s < y.length; s++) {
                  D = y[s].key;
                  B = y[s].value;
                  z = Z(r, D);
                  if (z >= 0) {
                    J = 1;
                    if (typeof b.resourceQuantities !== "undefined") {
                      D = Z(b.resourceQuantities, D);
                      if (D >= 0) J = b.resourceQuantities[D].value
                    }
                    previousAllocations = r[z].value;
                    for (E = 0; E < previousAllocations.length; E++) {
                      G = previousAllocations[E].key;
                      if (!(G + B <= J)) {
                        z = previousAllocations[E].value;
                        z > x && (x = z)
                      }
                    }
                  }
                }
                if ((g || !(l.completedFinish > l.start)) && (x = Ga(x, b, l.schedule)) != l.start) {
                  J = va(l, b);
                  s = Ua(l, b);
                  B = l;
                  z = x;
                  B.start = z;
                  B.preferredStart = z;
                  u(B, "start", false, false);
                  $b(B, false);
                  B = l;
                  J = K(l.start, J, b, l.schedule);
                  B.finish = J;
                  u(B, "finish", false, false);
                  $b(B, false);
                  J = l;
                  J.completedFinish = K(J.start, s, b, J.schedule);
                  u(J, "completedFinish", false, false)
                }
                J = l.finish;
                for (s = 0; s < y.length; s++) {
                  D = y[s].key;
                  B = y[s].value;
                  z = Z(r, D);
                  if (z < 0) {
                    z = [];
                    r.push({key: D, value: z})
                  } else z = r[z].value;
                  D = [{key: B, value: J}];
                  for (E = 0; E < z.length; E++) {
                    G =
                      z[E].key;
                    var F = z[E].value;
                    F > x && (F < J ? D.push({key: G + B, value: F}) : D.push({key: G + B, value: J}))
                  }
                  for (B = 0; B < D.length; B++) {
                    E = D[B].key;
                    G = D[B].value;
                    F = Z(z, E);
                    if (F < 0) z.push({key: E, value: G}); else if (G > z[F].value) z[F].value = G
                  }
                }
                v.push(l)
              }
            }
            for (q = 0; q < v.length; q++) j.splice(j.indexOf(v[q]), 1);
            if (j.length == t) break;
            t = j.length
          }
          for (q = 0; q < w.length; q++) {
            l = w[q];
            u(l, "start", true, true);
            u(l, "finish", true, true);
            u(l, "completedFinish", true, true);
            X(l)
          }
        }
        return f
      };
      a.getItemSuccessors = function (a) {
        return Wb(a, d)
      };
      a.getItemSuccessorPredecessorItems =
        function (a) {
          return gb(a, d)
        };
      a.getItemAllocationUnits = Ha;
      a.getItemAssignments = ta;
      a.getItemAssignedResources = bc;
      a.getResourceAssignments = function (a) {
        return wa(a, d)
      };
      a.getResourceAssignedItems = function (a) {
        for (var b = [], a = wa(a, d), c = 0; c < a.length; c++) b.push(a[c].key);
        return b
      };
      a.getAssignedResources = function () {
        return xa(d)
      };
      a.getItemAssignmentsCost = function (a) {
        return Yb(a, b)
      };
      a.getItemExtraCost = function (a) {
        return ib(a, b)
      };
      a.getItemCost = function (a) {
        return hb(a, b)
      };
      a.setItemCost = function (a, c) {
        a.executionCost =
          c - ib(a, b);
        u(a, "executionCost", true, true)
      };
      a.getResourceCost = function (a) {
        for (var c = 0, a = wa(a, d), e = 0; e < a.length; e++) {
          var f = a[e], g;
          typeof b.specificResourceUsageCosts !== "undefined" && (g = Z(b.specificResourceUsageCosts, resource)) >= 0 ? c = c + b.specificResourceUsageCosts[g].value * f.value : typeof b.defaultResourceUsageCost !== "undefined" && (c = c + b.defaultResourceUsageCost * f.value);
          var h = f.key;
          if (!h.hasChildren || !(typeof h.isSummaryEnabled === "undefined" || h.isSummaryEnabled)) {
            h = va(h, b) / 36E5;
            typeof b.specificResourceHourCosts !==
            "undefined" && (g = Z(b.specificResourceHourCosts, resource)) >= 0 ? c = c + b.specificResourceHourCosts[g].value * h * f.value : typeof b.defaultResourceHourCost !== "undefined" && (c = c + b.defaultResourceHourCost * h * f.value)
          }
        }
        return c
      };
      a.getProjectCost = function () {
        for (var a = 0, c = 0; c < d.length; c++) {
          var e = d[c];
          e.parent == null && (a = a + hb(e, b))
        }
        return a
      };
      a.getScheduleChartItems = function (a) {
        var c = [],
          a = typeof a !== "undefined" ? typeof a === "array" ? a : [a] : typeof b.assignableResources !== "undefined" ? b.assignableResources : [],
          e, f = xa(d), g;
        for (g =
               0; g < f.length; g++) {
          e = f[g];
          a.indexOf(e) < 0 && a.push(e)
        }
        for (g = 0; g < a.length; g++) {
          e = a[g];
          f = {tag: e, content: e, ganttChartItems: []};
          e = wa(e, d);
          for (var h = 0; h < e.length; h++) {
            var j = e[h], k = j.key, j = {
              tag: k,
              content: k.content,
              start: k.start,
              finish: k.finish,
              completedFinish: k.completedFinish,
              isMilestone: k.isMilestone,
              schedule: k.schedule,
              assignmentsContent: j.value != 1 ? Math.round(j.value * 1E4) / 100 + "%" : "",
              minStart: k.minStart,
              maxStart: k.maxStart,
              minFinish: k.minFinish,
              maxFinish: k.maxFinish,
              isHidden: k.isHidden,
              isBarVisible: k.isBarVisible,
              isBarReadOnly: k.isBarReadOnly,
              isReadOnly: k.isReadOnly,
              isRelativeToTimezone: k.isRelativeToTimezone
            };
            f.ganttChartItems.push(j)
          }
          c.push(f)
        }
        return c
      };
      a.getAllocations = function (a) {
        return cc(a, d)
      };
      a.getLoadChartItems = function (a) {
        var c = [];
        typeof a === "undefined" ? a = xa(d) : typeof a !== "array" && (a = [a]);
        for (var e = 0; e < a.length; e++) {
          for (var f = a[e], g = {tag: f, content: f, ganttChartItems: []}, h = cc(f, d), j = 0; j < h.length; j++) {
            var k = h[j], l = 1;
            if (typeof b.resourceQuantities !== "undefined") {
              var q = Z(b.resourceQuantities, f);
              if (q >=
                0) l = b.resourceQuantities[q].value
            }
            q = b.maxLoadChartDisplayedResourceQuantity;
            typeof q === "undefined" && (q = 100);
            l > q && (l = q);
            g.ganttChartItems.push({
              start: k.key.start,
              finish: k.key.finish,
              units: k.value / l,
              content: Math.round(k.value * 1E4) / 100 + "%",
              isRelativeToTimezone: false
            })
          }
          c.push(g)
        }
        return c
      };
      a.getFilteredGanttChartItems = function (a) {
        var b = [];
        typeof a === "undefined" ? a = xa(d) : typeof a !== "array" && (a = [a]);
        for (var c = [], e = 0; e < a.length; e++) for (var f = wa(a[e], d), g = 0; g < f.length; g++) {
          var h = f[g].key;
          if ((!h.hasChildren ||
            !(typeof h.isSummaryEnabled === "undefined" || h.isSummaryEnabled)) && !(c.indexOf(h) >= 0)) {
            b.push({
              tag: h,
              content: h.content,
              start: h.start,
              finish: h.finish,
              completedFinish: h.completedFinish,
              isMilestone: h.isMilestone,
              assignmentsContent: a.length > 1 ? h.assignmentsContent : f[g].value != 1 ? Math.round(f[g].value * 1E4) / 100 + "%" : "",
              minStart: h.minStart,
              maxStart: h.maxStart,
              minFinish: h.minFinish,
              maxFinish: h.maxFinish,
              isHidden: h.isHidden,
              isBarVisible: h.isBarVisible,
              isBarReadOnly: h.isBarReadOnly,
              isReadOnly: true,
              isRelativeToTimezone: h.isRelativeToTimezone
            });
            c.push(h)
          }
        }
        return b
      };
      a.copyCommonSettings = function (a) {
        if (typeof a !== "undefined") {
          a.target = b.target;
          a.theme = b.theme;
          a.border = b.border;
          a.containerClass = b.containerClass;
          a.containerStyle = b.containerStyle;
          a.isGridVisible = b.isGridVisible;
          a.gridWidth = b.gridWidth;
          a.chartWidth = b.chartWidth;
          a.isSplitterEnabled = b.isSplitterEnabled;
          a.splitterWidth = b.splitterWidth;
          a.splitterBackground = b.splitterBackground;
          a.minGridWidth = b.minGridWidth;
          a.minChartWidth = b.minChartWidth;
          a.headerBackground = b.headerBackground;
          a.headerHeight =
            b.headerHeight;
          a.indentationLevelWidth = b.indentationLevelWidth;
          a.displayedTime = b.displayedTime;
          a.currentTime = b.currentTime;
          a.timelineStart = b.timelineStart;
          a.timelineFinish = b.timelineFinish;
          a.scales = b.scales;
          a.updateScale = b.updateScale;
          a.hourWidth = b.hourWidth;
          a.workingWeekStart = b.workingWeekStart;
          a.workingWeekFinish = b.workingWeekFinish;
          a.visibleDayStart = b.visibleDayStart;
          a.visibleDayFinish = b.visibleDayFinish;
          a.visibleWeekStart = b.visibleWeekStart;
          a.visibleWeekFinish = b.visibleWeekFinish;
          a.specialNonworkingDays =
            b.specialNonworkingDays;
          a.months = b.months;
          a.daysOfWeek = b.daysOfWeek;
          a.weekStartDay = b.weekStartDay;
          a.dateFormatter = b.dateFormatter;
          a.dateTimeFormatter = b.dateTimeFormatter;
          a.dateTimeParser = b.dateTimeParser;
          a.isRelativeToTimezone = b.isRelativeToTimezone
        }
      };
      a.getNetworkDiagramItems = function (a, c, e) {
        var f = a, g = c, h = e;
        if (typeof f === "undefined" || f < 0) f = Number.MAX_VALUE;
        typeof g === "undefined" && (g = "Start");
        typeof h === "undefined" && (h = "Finish");
        var e = new Date(1900, 0, 1), c = new Date((new Date(1E4, 0, 1)).valueOf() - 1),
          a = [], j, k, l, q, s, w, r, u, t = [];
        for (j = 0; j < d.length; j++) {
          k = d[j];
          k.indentation <= f && (!k.hasChildren || !(typeof k.isSummaryEnabled === "undefined" || k.isSummaryEnabled || typeof k.isBarVisible !== "undefined" && !k.isBarVisible) || k.indentation == f) && t.push({
            key: k,
            value: []
          })
        }
        for (j = 0; j < t.length; j++) {
          k = t[j].key;
          w = [k];
          if (k.indentation == f && k.hasChildren && (typeof k.isSummaryEnabled === "undefined" || k.isSummaryEnabled || typeof k.isBarVisible !== "undefined" && !k.isBarVisible)) for (l = 0; l < d.length; l++) {
            q = d[l];
            kb(q, k) && w.push(q)
          }
          r = t[j].value;
          for (l = 0; l < w.length; l++) for (var v = w[l]; v != null;) {
            if (typeof v.predecessors !== "undefined") for (s = 0; s < v.predecessors.length; s++) if (!(typeof v.predecessors[s].item === "undefined" || typeof v.predecessors[s].dependencyType !== "undefined" && v.predecessors[s].dependencyType != "" && v.predecessors[s].dependencyType != "FinishStart" && v.predecessors[s].dependencyType != "FS")) {
              for (q = u = v.predecessors[s].item; q != null && Z(t, q) < 0;) q = q.parent;
              if (q != k) {
                var x = [];
                if (q != null) x.push(q); else for (var y = 0; y < t.length; y++) {
                  q = t[y].key;
                  kb(q,
                    u) && x.push(q)
                }
                for (u = 0; u < x.length; u++) {
                  q = x[u];
                  r.indexOf(q) < 0 && r.push(q)
                }
              }
            }
            v = v.parent
          }
        }
        u = l = null;
        for (j = 0; j < d.length; j++) {
          k = d[j];
          if (l == null || k.start < l) l = k.start;
          if (u == null || k.finish > u) u = k.finish
        }
        l == null && (l = c);
        u == null && (u = e);
        g = {
          content: g,
          displayedText: g,
          earlyStart: l,
          earlyFinish: l,
          lateStart: c,
          lateFinish: c,
          isMilestone: true,
          effort: 0,
          displayedRowIndex: 0,
          displayedColumnIndex: 0
        };
        a.push(g);
        f = [g];
        l = [];
        for (j = 0; j < t.length; j++) t[j].value.length == 0 && l.push(t[j].key);
        if (l.length > 0) {
          f = [];
          for (j = 0; j < l.length; j++) {
            k =
              l[j];
            s = {
              content: jb(k),
              displayedText: k.content,
              earlyStart: e,
              earlyFinish: e,
              lateStart: c,
              lateFinish: c,
              effort: O(k.start, k.finish, b, k.schedule),
              isMilestone: k.isMilestone,
              predecessors: [],
              tag: k
            };
            f.push(s);
            a.push(s);
            s.earlyStart = Ga(g.earlyFinish, b);
            s.earlyFinish = K(s.earlyStart, s.effort, b);
            s.predecessors.push({item: g, tag: k})
          }
          do {
            v = [];
            for (j = 0; j < f.length; j++) v.push(f[j]);
            s = false;
            for (j = 0; j < f.length; j++) {
              w = f[j];
              k = w.tag;
              x = [];
              for (l = 0; l < t.length; l++) t[l].value.indexOf(k) >= 0 && x.push(t[l].key);
              if (x.length > 0) {
                v.splice(v.indexOf(w),
                  1);
                for (l = 0; l < x.length; l++) {
                  k = x[l];
                  r = null;
                  for (s = 0; s < a.length; s++) if (a[s].tag == k) {
                    r = a[s];
                    break
                  }
                  if (r == null) {
                    r = {
                      content: jb(k),
                      displayedText: k.content,
                      earlyStart: e,
                      earlyFinish: e,
                      lateStart: c,
                      lateFinish: c,
                      effort: O(k.start, k.finish, b, k.schedule),
                      isMilestone: k.isMilestone,
                      predecessors: [],
                      tag: k
                    };
                    v.push(r);
                    a.push(r)
                  }
                  s = Ga(w.earlyFinish, b);
                  if (s > r.earlyStart) {
                    r.earlyStart = s;
                    r.earlyFinish = K(r.earlyStart, r.effort, b)
                  }
                  r.predecessors.push({item: w, tag: k})
                }
                s = true
              }
            }
            f = v
          } while (s)
        }
        h = {
          content: h,
          displayedText: h,
          earlyStart: e,
          earlyFinish: e,
          lateStart: u,
          lateFinish: u,
          isMilestone: true,
          effort: 0,
          predecessors: [],
          displayedRowIndex: 0
        };
        a.push(h);
        l = h.predecessors;
        for (j = 0; j < f.length; j++) {
          t = f[j];
          s = t.earlyFinish;
          if (s > h.earlyStart) {
            h.earlyStart = s;
            h.earlyFinish = h.earlyStart
          }
          l.push({item: t})
        }
        for (f = [h]; f.length > 0;) {
          t = [];
          for (j = 0; j < f.length; j++) {
            w = f[j];
            if (typeof w.predecessors !== "undefined") for (l = 0; l < w.predecessors.length; l++) {
              u = w.predecessors[l];
              r = u.item;
              t.push(r);
              k = w.lateStart;
              if (k < r.lateFinish) {
                r.lateFinish = r.effort > 0 ? F(k, b, false, true,
                  void 0) : k;
                r.lateStart = Ta(r.effort, r.lateFinish, b)
              }
            }
          }
          f = t
        }
        if (a.length > 2) for (j = 0; j < a.length; j++) {
          k = a[j];
          k.slack = O(k.earlyStart, k.lateStart, b)
        } else {
          g.earlyStart = e;
          g.earlyFinish = e;
          g.lateStart = e;
          g.lateFinish = e;
          h.earlyStart = c;
          h.earlyFinish = c;
          h.lateStart = c;
          h.lateFinish = c
        }
        for (j = 0; j < a.length; j++) a[j].isRelativeToTimezone = false;
        return a
      };
      a.getOutputDate = dc;
      a.getInputDate = ec
    };
  return {
    initialize: ca,
    initializeItems: S,
    refresh: V,
    getDefaultColumns: j,
    getDefaultCollapsedToggleButtonTemplate: lb,
    getDefaultExpandedToggleButtonTemplate: mb,
    getDefaultScales: nb,
    getDefaultStyleDefinitionTemplate: ob,
    getDefaultStandardTaskTemplate: pb,
    getDefaultSummaryTaskTemplate: qb,
    getDefaultMilestoneTaskTemplate: rb,
    getDefaultItemTemplate: sb,
    getDefaultAssignmentsTemplate: tb,
    getDefaultDependencyLineTemplate: ub,
    getDefaultPredecessorItemTemplate: vb,
    initializeTaskDraggingThumbs: function (a, d, b, c, e, f, g, h) {
      e.ganttChartView.initializeTaskDraggingThumbs(a, d, b, c, e, f, g, h)
    },
    initializeDependencyDraggingThumb: function (a, d, b, c, e) {
      b.ganttChartView.initializeDependencyDraggingThumb(a,
        d, b, c, e)
    },
    getWorkingTime: Kb,
    getEffort: O,
    getFinish: K,
    getStart: Ta,
    getCompletion: Lb,
    getCompletedFinish: Mb,
    getWeekStart: function (a, d) {
      return ma(a, d)
    },
    getWeekFinish: Za,
    defaultDateTimeFormatter: function (a) {
      return oa(h(a))
    },
    defaultDateFormatter: function (a) {
      return U(h(a))
    },
    defaultDateTimeParser: function (a) {
      return k(l(a))
    },
    textColumnTemplateBase: function (a, d, b) {
      d = d();
      if (typeof d === "undefined" || typeof b !== "undefined" && !b()) d = "";
      return a.createTextNode(d)
    },
    textInputColumnTemplateBase: function (a, d, b, c, e, f, g) {
      var h =
        a.createElement("input");
      h.setAttribute("type", "text");
      a = b();
      typeof a === "undefined" && (a = "");
      h.setAttribute("value", a);
      a = "";
      typeof f !== "undefined" && !f() && (a = "; display: none");
      f = "";
      typeof g !== "undefined" && g() && (f = "; font-weight: bold");
      h.setAttribute("style", "background-color: Transparent; width: " + d + "px; border-width: 0px; padding: 0px" + a + f);
      typeof e !== "undefined" && !e() && h.setAttribute("disabled", "true");
      h.addEventListener("change", function () {
        c(h.value)
      }, true);
      h.addEventListener("keypress", function (a) {
        if (a.keyCode ==
          13) {
          a.preventDefault();
          a.stopPropagation();
          c(h.value)
        }
      }, true);
      h.addEventListener("focus", function () {
        h.style.backgroundColor = "White"
      }, true);
      h.addEventListener("blur", function () {
        h.style.backgroundColor = "Transparent"
      }, true);
      return h
    },
    optionSelectColumnTemplateBase: function (a, d, b, c, e, f, g, h) {
      var j = a.createElement("select"), k = function (b, c) {
        var d = a.createElement("option");
        d.appendChild(a.createTextNode(b));
        b == c && d.setAttribute("selected", true);
        j.appendChild(d)
      }, c = c();
      typeof c === "undefined" && (c = "");
      k("",
        c);
      for (var b = b(), l = 0; l < b.length; l++) k(b[l], c);
      k = "";
      typeof g !== "undefined" && !g() && (k = "; display: none");
      g = "";
      typeof h !== "undefined" && h() && (g = "; font-weight: bold");
      j.setAttribute("style", "background-color: Transparent; width: " + d + "px; border-width: 0px; padding: 0px" + k + g);
      typeof f !== "undefined" && !f() && j.setAttribute("disabled", "true");
      j.addEventListener("change", function () {
        e(j.value)
      }, true);
      j.addEventListener("keypress", function (a) {
          if (a.keyCode == 13) {
            a.preventDefault();
            a.stopPropagation();
            e(j.value)
          }
        },
        true);
      j.addEventListener("focus", function () {
        j.style.backgroundColor = "White"
      }, true);
      j.addEventListener("blur", function () {
        j.style.backgroundColor = "Transparent"
      }, true);
      return j
    },
    numberInputColumnTemplateBase: function (a, d, b, c, e, f, g) {
      return DlhSoft.Controls.GanttChartView.textInputColumnTemplateBase(a, d, function () {
        var a = b();
        return !isNaN(a) ? a : ""
      }, function (a) {
        a = parseFloat(a);
        isNaN(a) && (a = 0);
        c(a)
      }, e, f, g)
    },
    percentInputColumnTemplateBase: function (a, d, b, c, e, f, g) {
      return DlhSoft.Controls.GanttChartView.numberInputColumnTemplateBase(a,
        d, b, function (a) {
          a < 0 && (a = 0);
          a > 100 && (a = 100);
          c(a)
        }, e, f, g)
    },
    timeSpanInputColumnTemplateBase: function (a, d, b, c, e, f, g, h) {
      typeof e === "undefined" && (e = 1);
      return DlhSoft.Controls.GanttChartView.numberInputColumnTemplateBase(a, d, function () {
        var a = b() / (36E5 * e);
        return Math.round(a * 100) / 100
      }, function (a) {
        a = parseFloat(a);
        a < 0 && (a = 0);
        c(a * 36E5 * e)
      }, f, g, h)
    },
    datePickerInputColumnTemplateBase: function (a, d, b, c, e, f, g, h) {
      var j = a.createElement("input");
      j.setAttribute("type", "text");
      a = b();
      typeof a === "undefined" ? a = "" : a != null &&
        (a = DlhSoft.Controls.GanttChartView.defaultDateTimeFormatter(a));
      j.setAttribute("value", a);
      DlhSoft.Controls.DatePicker && j.addEventListener("focus", function () {
        var a = DlhSoft.Controls.DatePicker.get(j);
        if (!a || !a.isOpen) {
          var b = 0, c = 0;
          try {
            b = j.selectionStart;
            c = j.selectionEnd
          } catch (d) {
          }
          a = DlhSoft.Controls.DatePicker.initialize(j, void 0, {
            defaultTimeOfDay: h,
            isDropDownButtonVisible: false,
            popupStyle: "margin-top: 1px; background-color: White; border: 1px solid #e0e0e0"
          }, "DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.");
          a.openDropDown();
          setTimeout(function () {
            try {
              j.selectionStart = b;
              j.selectionEnd = c;
              j.focus()
            } catch (a) {
            }
          }, 100)
        }
      }, true);
      a = "";
      typeof f !== "undefined" && !f() && (a = "; display: none");
      f = "";
      typeof g !== "undefined" && g() && (f = "; font-weight: bold");
      j.setAttribute("style", "background-color: Transparent; width: " + d + "px; border-width: 0px; padding: 0px" + a + f);
      typeof e !== "undefined" && !e() && j.setAttribute("disabled", "true");
      var k = function () {
        var a = j.value, a = a != "" ? DlhSoft.Controls.GanttChartView.defaultDateTimeParser(a) : null;
        c(a)
      };
      j.addEventListener("change", function () {
        k()
      }, true);
      j.addEventListener("keypress", function (a) {
        if (a.keyCode == 13) {
          a.preventDefault();
          a.stopPropagation();
          k()
        }
      }, true);
      j.addEventListener("focus", function () {
        j.style.backgroundColor = "White"
      }, true);
      j.addEventListener("blur", function () {
        j.style.backgroundColor = "Transparent"
      }, true);
      return j
    },
    multiSelectorComboBoxInputColumnTemplateBase: function (a, d, b, c, e, f, g, h) {
      var j = a.createElement("input");
      j.setAttribute("type", "text");
      a = c();
      typeof a === "undefined" && (a =
        "");
      j.setAttribute("value", a);
      DlhSoft.Controls.MultiSelectorComboBox && j.addEventListener("focus", function () {
        var a = DlhSoft.Controls.MultiSelectorComboBox.get(j);
        if (!a || !a.isOpen && a.availableChoices.length > 0) {
          var a = b(), c = 0, d = 0;
          try {
            c = j.selectionStart;
            d = j.selectionEnd
          } catch (e) {
          }
          a = DlhSoft.Controls.MultiSelectorComboBox.initialize(j, a, void 0, {
              autoAppendAvailableChoices: false,
              isDropDownButtonVisible: false,
              popupStyle: "margin-top: 1px; background-color: White; border: 1px solid #e0e0e0; color: Black; font-size: small; max-height: 188px; overflow-y: auto"
            },
            "DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.");
          a.openDropDown();
          setTimeout(function () {
            try {
              j.selectionStart = c;
              j.selectionEnd = d;
              j.focus()
            } catch (a) {
            }
          }, 100)
        }
      }, true);
      a = "";
      typeof g !== "undefined" && !g() && (a = "; display: none");
      g = "";
      typeof h !== "undefined" && h() && (g = "; font-weight: bold");
      j.setAttribute("style", "background-color: Transparent; width: " + d + "px; border-width: 0px; padding: 0px" + a + g);
      typeof f !== "undefined" &&
      !f() && j.setAttribute("disabled", "true");
      j.addEventListener("change", function () {
        e(j.value)
      }, true);
      j.addEventListener("keypress", function (a) {
        if (a.keyCode == 13) {
          a.preventDefault();
          a.stopPropagation();
          e(j.value)
        }
      }, true);
      j.addEventListener("focus", function () {
        j.style.backgroundColor = "White"
      }, true);
      j.addEventListener("blur", function () {
        j.style.backgroundColor = "Transparent"
      }, true);
      return j
    },
    dateTimeInputColumnTemplateBase: function (a, d, b, c, e, f, g) {
      return DlhSoft.Controls.GanttChartView.textInputColumnTemplateBase(a,
        d, function () {
          var a = b();
          return a != null ? DlhSoft.Controls.GanttChartView.defaultDateTimeFormatter(a) : ""
        }, function (a) {
          a = a != "" ? DlhSoft.Controls.GanttChartView.defaultDateTimeParser(a) : null;
          c(a)
        }, e, f, g)
    },
    getIndexColumnTemplate: function () {
      return function (a) {
        var d = a.ganttChartView;
        return DlhSoft.Controls.GanttChartView.textColumnTemplateBase(d.ownerDocument, function () {
          return d.getItemIndexString(a)
        })
      }
    },
    getWbsColumnTemplate: function (a) {
      return function (d) {
        var b = d.ganttChartView;
        return DlhSoft.Controls.GanttChartView.textColumnTemplateBase(b.ownerDocument,
          function () {
            return b.getItemWbsIndexString(d, a)
          })
      }
    },
    getEffortColumnTemplate: function (a, d, b) {
      typeof d === "undefined" && (d = 1);
      return function (c) {
        var e = c.ganttChartView;
        return DlhSoft.Controls.GanttChartView.timeSpanInputColumnTemplateBase(e.ownerDocument, a, function () {
          return e.getItemEffort(c)
        }, function (a) {
          e.setItemEffort(c, a);
          e.refreshItemPath(c)
        }, d, function () {
          return !(c.isReadOnly || b || typeof c.ganttChartView !== "undefined" && typeof c.ganttChartView.settings !== "undefined" && (c.ganttChartView.settings.isReadOnly ||
            c.ganttChartView.settings.isGridReadOnly)) && !(c.hasChildren && (typeof c.isSummaryEnabled === "undefined" || c.isSummaryEnabled))
        }, function () {
          return !(c.isMilestone || typeof c.isBarVisible !== "undefined" && !c.isBarVisible)
        }, function () {
          return c.hasChildren && (typeof c.isSummaryEnabled === "undefined" || c.isSummaryEnabled)
        })
      }
    },
    getDurationColumnTemplate: function (a, d, b) {
      typeof d === "undefined" && (d = 1);
      return function (c) {
        var e = c.ganttChartView;
        return DlhSoft.Controls.GanttChartView.timeSpanInputColumnTemplateBase(e.ownerDocument,
          a, function () {
            return e.getItemDuration(c)
          }, function (a) {
            e.setItemDuration(c, a);
            e.refreshItemPath(c)
          }, d, function () {
            return !(c.isReadOnly || b || typeof c.ganttChartView !== "undefined" && typeof c.ganttChartView.settings !== "undefined" && (c.ganttChartView.settings.isReadOnly || c.ganttChartView.settings.isGridReadOnly)) && !(c.hasChildren && (typeof c.isSummaryEnabled === "undefined" || c.isSummaryEnabled))
          }, function () {
            return !(c.isMilestone || typeof c.isBarVisible !== "undefined" && !c.isBarVisible)
          }, function () {
            return c.hasChildren &&
              (typeof c.isSummaryEnabled === "undefined" || c.isSummaryEnabled)
          })
      }
    },
    getTotalEffortColumnTemplate: function (a, d, b) {
      typeof d === "undefined" && (d = 1);
      return function (c) {
        var e = c.ganttChartView;
        return DlhSoft.Controls.GanttChartView.timeSpanInputColumnTemplateBase(e.ownerDocument, a, function () {
          return e.getItemTotalEffort(c)
        }, function (a) {
          e.setItemTotalEffort(c, a);
          e.refreshItemPath(c)
        }, d, function () {
          return !(c.isReadOnly || b || typeof c.ganttChartView !== "undefined" && typeof c.ganttChartView.settings !== "undefined" && (c.ganttChartView.settings.isReadOnly ||
            c.ganttChartView.settings.isGridReadOnly)) && !(c.hasChildren && (typeof c.isSummaryEnabled === "undefined" || c.isSummaryEnabled))
        }, function () {
          return !(c.isMilestone || typeof c.isBarVisible !== "undefined" && !c.isBarVisible)
        }, function () {
          return c.hasChildren && (typeof c.isSummaryEnabled === "undefined" || c.isSummaryEnabled)
        })
      }
    },
    getCompletedEffortColumnTemplate: function (a, d, b) {
      typeof d === "undefined" && (d = 1);
      return function (c) {
        var e = c.ganttChartView;
        return DlhSoft.Controls.GanttChartView.timeSpanInputColumnTemplateBase(e.ownerDocument,
          a, function () {
            return e.getItemCompletedEffort(c)
          }, function (a) {
            e.setItemCompletedEffort(c, a);
            e.refreshItemPath(c)
          }, d, function () {
            return !(c.isReadOnly || b || typeof c.ganttChartView !== "undefined" && typeof c.ganttChartView.settings !== "undefined" && (c.ganttChartView.settings.isReadOnly || c.ganttChartView.settings.isGridReadOnly)) && !(c.hasChildren && (typeof c.isSummaryEnabled === "undefined" || c.isSummaryEnabled))
          }, function () {
            return !(c.isMilestone || typeof c.isBarVisible !== "undefined" && !c.isBarVisible)
          }, function () {
            return c.hasChildren &&
              (typeof c.isSummaryEnabled === "undefined" || c.isSummaryEnabled)
          })
      }
    },
    getTotalCompletedEffortColumnTemplate: function (a, d, b) {
      typeof d === "undefined" && (d = 1);
      return function (c) {
        var e = c.ganttChartView;
        return DlhSoft.Controls.GanttChartView.timeSpanInputColumnTemplateBase(e.ownerDocument, a, function () {
          return e.getItemTotalCompletedEffort(c)
        }, function (a) {
          e.setItemTotalCompletedEffort(c, a);
          e.refreshItemPath(c)
        }, d, function () {
          return !(c.isReadOnly || b || typeof c.ganttChartView !== "undefined" && typeof c.ganttChartView.settings !==
            "undefined" && (c.ganttChartView.settings.isReadOnly || c.ganttChartView.settings.isGridReadOnly)) && !(c.hasChildren && (typeof c.isSummaryEnabled === "undefined" || c.isSummaryEnabled))
        }, function () {
          return !(c.isMilestone || typeof c.isBarVisible !== "undefined" && !c.isBarVisible)
        }, function () {
          return c.hasChildren && (typeof c.isSummaryEnabled === "undefined" || c.isSummaryEnabled)
        })
      }
    },
    getCompletionColumnTemplate: function (a, d) {
      return function (b) {
        var c = b.ganttChartView;
        return DlhSoft.Controls.GanttChartView.percentInputColumnTemplateBase(c.ownerDocument,
          a, function () {
            var a = c.getItemCompletion(b) * 100;
            return Math.round(a * 100) / 100
          }, function (a) {
            a = parseFloat(a) / 100;
            c.setItemCompletion(b, a);
            c.refreshItemPath(b)
          }, function () {
            return !(b.isReadOnly || d || typeof b.ganttChartView !== "undefined" && typeof b.ganttChartView.settings !== "undefined" && (b.ganttChartView.settings.isReadOnly || b.ganttChartView.settings.isGridReadOnly)) && !(b.hasChildren && (typeof b.isSummaryEnabled === "undefined" || b.isSummaryEnabled))
          }, function () {
            return !(b.isMilestone || typeof b.isBarVisible !== "undefined" &&
              !b.isBarVisible)
          }, function () {
            return b.hasChildren && (typeof b.isSummaryEnabled === "undefined" || b.isSummaryEnabled)
          })
      }
    },
    getCostColumnTemplate: function (a, d) {
      return function (b) {
        var c = b.ganttChartView;
        return DlhSoft.Controls.GanttChartView.numberInputColumnTemplateBase(c.ownerDocument, a, function () {
          return c.getItemCost(b)
        }, function (a) {
          c.setItemCost(b, a);
          c.refreshItemPath(b)
        }, function () {
          return !(b.isReadOnly || d || typeof b.ganttChartView !== "undefined" && typeof b.ganttChartView.settings !== "undefined" && (b.ganttChartView.settings.isReadOnly ||
            b.ganttChartView.settings.isGridReadOnly))
        }, void 0, function () {
          return b.hasChildren && (typeof b.isSummaryEnabled === "undefined" || b.isSummaryEnabled)
        })
      }
    },
    getPredecessorsColumnTemplate: function (a, d, b) {
      return function (c) {
        var e = c.ganttChartView;
        return DlhSoft.Controls.GanttChartView.textInputColumnTemplateBase(e.ownerDocument, a, function () {
          return e.getItemPredecessorsString(c, b)
        }, function (a) {
          e.setItemPredecessorsString(c, a, b);
          e.refreshItemGraph(c)
        }, function () {
          return !(c.isReadOnly || d || typeof c.ganttChartView !==
            "undefined" && typeof c.ganttChartView.settings !== "undefined" && (c.ganttChartView.settings.isReadOnly || c.ganttChartView.settings.isGridReadOnly))
        }, function () {
          return !(typeof c.isBarVisible !== "undefined" && !c.isBarVisible)
        }, function () {
          return c.hasChildren && (typeof c.isSummaryEnabled === "undefined" || c.isSummaryEnabled)
        })
      }
    },
    getStandardSelectorColumnTemplate: function (a, d, b) {
      return function (c) {
        var e = c.ganttChartView;
        return DlhSoft.Controls.GanttChartView.optionSelectColumnTemplateBase(e.ownerDocument, a, function () {
          return typeof d === "array" ? d : d(c)
        }, function () {
          return c.assignmentsContent
        }, function (a) {
          c.assignmentsContent = a;
          e.onItemPropertyChanged(c, "assignmentsContent", true, true);
          e.refreshItem(c)
        }, function () {
          return !(c.isReadOnly || b || typeof c.ganttChartView !== "undefined" && typeof c.ganttChartView.settings !== "undefined" && (c.ganttChartView.settings.isReadOnly || c.ganttChartView.settings.isGridReadOnly))
        }, function () {
          return !(typeof c.isBarVisible !== "undefined" && !c.isBarVisible)
        }, function () {
          return c.hasChildren && (typeof c.isSummaryEnabled === "undefined" || c.isSummaryEnabled)
        })
      }
    },
    getAssignmentSelectorColumnTemplate: function (a, d, b) {
      console.log("SHUST: Script has been updated!");
      return function (c) {
        var e = c.ganttChartView;
        return DlhSoft.Controls.GanttChartView.optionSelectColumnTemplateBase(e.ownerDocument, a, function () {
          return typeof d === "array" ? d : d(c)
        }, function () {
          return c.assignmentsContent
        }, function (a) {
          c.assignmentsContent = a;
          e.onItemPropertyChanged(c, "assignmentsContent", true, true);
          e.refreshItem(c)
        }, function () {
          return !(c.isReadOnly || b || typeof c.ganttChartView !== "undefined" && typeof c.ganttChartView.settings !== "undefined" && (c.ganttChartView.settings.isReadOnly || c.ganttChartView.settings.isGridReadOnly))
        }, function () {
          return !(typeof c.isBarVisible !== "undefined" && !c.isBarVisible)
        }, function () {
          return c.hasChildren && (typeof c.isSummaryEnabled === "undefined" || c.isSummaryEnabled)
        })
      }
    },
    getBaselineStartColumnTemplate: function (a, d, b, c) {
      typeof d === "undefined" && (d = true);
      return function (e) {
        var f = e.ganttChartView;
        return (d ? DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase : DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(f.ownerDocument, a, function () {
          return e.baselineStart
        }, function (a) {
          a != null ? e.baselineStart = a : delete e.baselineStart;
          f.onItemPropertyChanged(e, "baselineStart", true, true);
          f.refreshItem(e)
        }, function () {
          return !(e.isReadOnly ||
            c || typeof e.ganttChartView !== "undefined" && typeof e.ganttChartView.settings !== "undefined" && (e.ganttChartView.settings.isReadOnly || e.ganttChartView.settings.isGridReadOnly))
        }, function () {
          return !(typeof e.isBarVisible !== "undefined" && !e.isBarVisible)
        }, function () {
          return e.hasChildren && (typeof e.isSummaryEnabled === "undefined" || e.isSummaryEnabled)
        }, b)
      }
    },
    getBaselineFinishColumnTemplate: function (a, d, b, c) {
      typeof d === "undefined" && (d = true);
      return function (e) {
        var f = e.ganttChartView;
        return (d ? DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase :
          DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(f.ownerDocument, a, function () {
          return e.baselineFinish
        }, function (a) {
          a != null ? e.baselineFinish = a : delete e.baselineFinish;
          f.onItemPropertyChanged(e, "baselineFinish", true, true);
          f.refreshItem(e)
        }, function () {
          return !(e.isReadOnly || c || typeof e.ganttChartView !== "undefined" && typeof e.ganttChartView.settings !== "undefined" && (e.ganttChartView.settings.isReadOnly || e.ganttChartView.settings.isGridReadOnly))
        }, function () {
          return !(e.isMilestone || typeof e.isBarVisible !==
            "undefined" && !e.isBarVisible)
        }, function () {
          return e.hasChildren && (typeof e.isSummaryEnabled === "undefined" || e.isSummaryEnabled)
        }, b ? b : 864E5)
      }
    },
    getMinStartColumnTemplate: function (a, d, b, c) {
      typeof d === "undefined" && (d = true);
      return function (e) {
        var f = e.ganttChartView;
        return (d ? DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase : DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(f.ownerDocument, a, function () {
          return e.minStart
        }, function (a) {
          a != null ? e.minStart = a : delete e.minStart;
          f.onItemPropertyChanged(e,
            "minStart", true, true);
          f.refreshItem(e)
        }, function () {
          return !(e.isReadOnly || c || typeof e.ganttChartView !== "undefined" && typeof e.ganttChartView.settings !== "undefined" && (e.ganttChartView.settings.isReadOnly || e.ganttChartView.settings.isGridReadOnly)) && !(e.hasChildren && (typeof e.isSummaryEnabled === "undefined" || e.isSummaryEnabled))
        }, function () {
          return !(typeof e.isBarVisible !== "undefined" && !e.isBarVisible)
        }, function () {
          return e.hasChildren && (typeof e.isSummaryEnabled === "undefined" || e.isSummaryEnabled)
        }, b)
      }
    },
    getMaxStartColumnTemplate: function (a, d, b, c) {
      typeof d === "undefined" && (d = true);
      return function (e) {
        var f = e.ganttChartView;
        return (d ? DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase : DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(f.ownerDocument, a, function () {
          return e.maxStart
        }, function (a) {
          a != null ? e.maxStart = a : delete e.maxStart;
          f.onItemPropertyChanged(e, "maxStart", true, true);
          f.refreshItem(e)
        }, function () {
          return !(e.isReadOnly || c || typeof e.ganttChartView !== "undefined" && typeof e.ganttChartView.settings !==
            "undefined" && (e.ganttChartView.settings.isReadOnly || e.ganttChartView.settings.isGridReadOnly)) && !(e.hasChildren && (typeof e.isSummaryEnabled === "undefined" || e.isSummaryEnabled))
        }, function () {
          return !(typeof e.isBarVisible !== "undefined" && !e.isBarVisible)
        }, function () {
          return e.hasChildren && (typeof e.isSummaryEnabled === "undefined" || e.isSummaryEnabled)
        }, b ? b : 864E5)
      }
    },
    getMinFinishColumnTemplate: function (a, d, b, c) {
      typeof d === "undefined" && (d = true);
      return function (e) {
        var f = e.ganttChartView;
        return (d ? DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase :
          DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(f.ownerDocument, a, function () {
            return e.minFinish
          }, function (a) {
            a != null ? e.minFinish = a : delete e.minFinish;
            f.onItemPropertyChanged(e, "minFinish", true, true);
            f.refreshItem(e)
          }, function () {
            return !(e.isReadOnly || c || typeof e.ganttChartView !== "undefined" && typeof e.ganttChartView.settings !== "undefined" && (e.ganttChartView.settings.isReadOnly || e.ganttChartView.settings.isGridReadOnly)) && !(e.hasChildren && (typeof e.isSummaryEnabled === "undefined" || e.isSummaryEnabled))
          },
          function () {
            return !(e.isMilestone || typeof e.isBarVisible !== "undefined" && !e.isBarVisible)
          }, function () {
            return e.hasChildren && (typeof e.isSummaryEnabled === "undefined" || e.isSummaryEnabled)
          }, b)
      }
    },
    getMaxFinishColumnTemplate: function (a, d, b, c) {
      typeof d === "undefined" && (d = true);
      return function (e) {
        var f = e.ganttChartView;
        return (d ? DlhSoft.Controls.GanttChartView.datePickerInputColumnTemplateBase : DlhSoft.Controls.GanttChartView.dateTimeInputColumnTemplateBase)(f.ownerDocument, a, function () {
          return e.maxFinish
        }, function (a) {
          a !=
          null ? e.maxFinish = a : delete e.maxFinish;
          f.onItemPropertyChanged(e, "maxFinish", true, true);
          f.refreshItem(e)
        }, function () {
          return !(e.isReadOnly || c || typeof e.ganttChartView !== "undefined" && typeof e.ganttChartView.settings !== "undefined" && (e.ganttChartView.settings.isReadOnly || e.ganttChartView.settings.isGridReadOnly)) && !(e.hasChildren && (typeof e.isSummaryEnabled === "undefined" || e.isSummaryEnabled))
        }, function () {
          return !(e.isMilestone || typeof e.isBarVisible !== "undefined" && !e.isBarVisible)
        }, function () {
          return e.hasChildren &&
            (typeof e.isSummaryEnabled === "undefined" || e.isSummaryEnabled)
        }, b ? b : 864E5)
      }
    },
    getIconColumnTemplate: function (a, d, b, c, e, f, g, h, j) {
      if (typeof a === "string") var k = a, a = function () {
        return k
      };
      typeof c === "undefined" || c == false ? c = function () {
        return false
      } : c == true && (c = function () {
        return true
      });
      return function (k) {
        var l = k.ganttChartView, n = l.ownerDocument.createElement("img");
        n.setAttribute("src", a(k));
        typeof d !== "undefined" && n.setAttribute("class", d);
        typeof b !== "undefined" && n.setAttribute("style", b);
        if (!l.settings.isReadOnly &&
          !l.settings.isGridReadOnly && c(k)) {
          n.style.cursor = "move";
          yc(n, k, l.items, l, l.settings, e, f, g, h, j)
        }
        return n
      }
    },
    getOutputDate: dc,
    getInputDate: ec
  }
}());
void 0 == DlhSoft.Controls.ScheduleChartView && (DlhSoft.Controls.ScheduleChartView = function () {
  var I = function (h, l, k, r) {
    var j = ["DlhSoft.Controls", "ScheduleChartView", "DlhSoft.ProjectData.GanttChart.HTML.Controls", "5", "validate", "Licensing"];
    DlhSoft[j[5]][j[4]](h, j[0], j[1], j[2], j[3], r, k);
    h.isScheduleChartInitializing = true;
    for (var r = l, l = [], s = j = 0; s < r.length; s++) {
      var q = r[s];
      if (!(typeof q.scheduleChartItem !== "undefined" && q.scheduleChartItem != q)) {
        q.scheduleChartIndex = j++;
        q.isBarVisible = false;
        l.push(q);
        if (typeof q.ganttChartItems !==
          "undefined") for (var w = 0; w < q.ganttChartItems.length; w++) {
          var t = q.ganttChartItems[w];
          t.scheduleChartItem = q;
          t.displayRowIndex = q.scheduleChartIndex;
          l.push(t)
        }
      }
    }
    typeof k !== "object" && (k = {});
    DlhSoft.Controls.GanttChartView.initializeItems(l, k);
    j = k;
    s = l;
    P(j);
    if (typeof j.gridWidth === "undefined") j.gridWidth = "15%";
    if (typeof j.chartWidth === "undefined") j.chartWidth = j.isGridVisible ? "85%" : "100%";
    if (typeof j.columns === "undefined") j.columns = T(s, j);
    if (typeof j.areTaskDependenciesVisible === "undefined") j.areTaskDependenciesVisible =
      false;
    if (typeof j.isBaselineVisible === "undefined") j.isBaselineVisible = false;
    if (typeof j.areAssignmentsReadOnly === "undefined") j.areAssignmentsReadOnly = false;
    if (typeof j.assignmentThumbStyle === "undefined") switch (j.theme) {
      default:
        j.assignmentThumbStyle = "fill: none; stroke: #3b87d9; stroke-width: 0.65px; stroke-dasharray: 2, 2";
        break;
      case "Aero":
        j.assignmentThumbStyle = "fill: none; stroke: Blue; stroke-dasharray: 2, 2"
    }
    if (typeof j.temporaryAssignmentThumbStyle === "undefined") switch (j.theme) {
      default:
        j.temporaryAssignmentThumbStyle =
          "fill: none; stroke: #3b87d9; stroke-width: 0.65px; stroke-dasharray: 2, 2";
        break;
      case "Aero":
        j.temporaryAssignmentThumbStyle = "fill: none; stroke: Blue; stroke-width: 0.65px; stroke-dasharray: 2, 2"
    }
    if (typeof j.assignmentThumbTemplate === "undefined") j.assignmentThumbTemplate = M(s, h, j);
    j.internalExtraTaskTemplate = j.assignmentThumbTemplate;
    U(h, l, r, k);
    DlhSoft.Controls.GanttChartView.initialize(h, l, k, "DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.");
    oa(h, l);
    h.isScheduleChartInitializing = false;
    h.isScheduleChartInitialized = true;
    return h
  }, L = function (h) {
    I(h, h.scheduleChartItems, h.settings, h.license)
  }, P = function (h) {
    if (typeof h.target === "undefined") h.target = "Standard";
    if (typeof h.theme === "undefined") h.theme = "Modern";
    if (typeof h.isGridVisible === "undefined") switch (h.target) {
      default:
        h.isGridVisible = true;
        break;
      case "Phone":
        h.isGridVisible = false
    }
    if (typeof h.isReadOnly === "undefined") h.isReadOnly = false;
    if (typeof h.isGridReadOnly === "undefined") h.isGridReadOnly =
      false;
    if (typeof h.isContentReadOnly === "undefined") h.isContentReadOnly = false;
    if (typeof h.selectionMode === "undefined") h.selectionMode = "Focus";
    if (typeof h.isVirtualizing === "undefined") h.isVirtualizing = true;
    if (h.target == "Phone" && typeof h.areTaskAssignmentsVisible === "undefined") h.areTaskAssignmentsVisible = false
  }, T = function (h, l) {
    typeof l !== "object" && (l = {});
    P(l);
    var k = [{header: "", width: 32, isSelection: true}, {header: "Resource", width: 100}];
    k[0].cellTemplate = ka(l, k[0], h);
    k[1].cellTemplate = H(l, k[1]);
    k[1].exportCellTemplate =
      H(l, k[1], false);
    l.selectionMode != "Single" && (l.selectionMode != "Extended" && l.selectionMode != "ExtendedFocus") && k.splice(0, 1);
    return k
  }, ka = function (h, l) {
    return function (h) {
      return !l.isReadOnly ? ca(h) : getBooleanNode(h.ganttChartView.ownerDocument, h.isSelected)
    }
  }, ca = function (h) {
    var l = h.ganttChartView.ownerDocument, k;
    if (typeof h.selectionInput === "undefined") {
      k = l.createElement("input");
      h.selectionInput = k;
      k.type = "checkbox";
      k.setAttribute("style", "margin: 0px")
    } else k = h.selectionInput;
    if (h.isSelected) k.setAttribute("checked",
      true); else if (k.checked) k.checked = false;
    var r = function () {
      k.checked ? V(h) : typeof h.scheduleChartView !== "undefined" && h.scheduleChartView.unselectItem(h)
    };
    typeof k.changeEventListener !== "undefined" && k.removeEventListener("change", k.changeEventListener, true);
    k.addEventListener("change", r, true);
    k.changeEventListener = r;
    l = function (h) {
      if (h.keyCode == 13) {
        h.preventDefault();
        h.stopPropagation();
        r(h)
      }
    };
    typeof k.keyPressEventListener !== "undefined" && k.removeEventListener("keypress", k.keyPressEventListener, true);
    k.addEventListener("keypress", l, true);
    k.keyPressEventListener = l;
    return k
  }, V = function (h) {
    typeof h.scheduleChartView !== "undefined" && h.scheduleChartView.selectItem(h)
  }, R = function (h, l) {
    if (typeof h.scheduleChartView != null) h.scheduleChartView.currentItem = h;
    (l.selectionMode == "Focus" || l.selectionMode == "ExtendedFocus") && !h.isSelected && V(h)
  }, H = function (h, l, k) {
    var r = function (h) {
      var k = h.content, h = h.ganttChartView.ownerDocument.createElement("span");
      h.innerHTML = k;
      return h
    };
    return (typeof k === "undefined" || k) && !h.isReadOnly &&
    !h.isGridReadOnly && !h.isContentReadOnly ? function (j) {
      return !l.isReadOnly && (typeof j.isReadOnly === "undefined" || !j.isReadOnly) ? S(j, Math.max(0, l.width - 2), h) : r(j)
    } : r
  }, S = function (h, l, k) {
    var r = h.ganttChartView.ownerDocument, j;
    if (typeof h.contentInput === "undefined") {
      j = r.createElement("input");
      h.contentInput = j;
      j.type = "text";
      j.addEventListener("focus", function () {
        R(h, k)
      }, false);
      var s = function () {
        h.content = j.value;
        h.scheduleChartView.onItemPropertyChanged(h, "content", true, true);
        h.scheduleChartView.refreshItem(h)
      };
      typeof j.changeEventListener !== "undefined" && j.removeEventListener("change", j.changeEventListener, true);
      j.addEventListener("change", s, true);
      j.changeEventListener = s;
      r = function (h) {
        if (h.keyCode == 13) {
          h.preventDefault();
          h.stopPropagation();
          s(h)
        }
      };
      typeof j.keyPressEventListener !== "undefined" && j.removeEventListener("keypress", j.keyPressEventListener, true);
      j.addEventListener("keypress", r, true);
      j.keyPressEventListener = r;
      j.addEventListener("focus", function () {
        j.style.backgroundColor = "White"
      }, false);
      j.addEventListener("blur",
        function () {
          j.style.backgroundColor = "Transparent"
        }, false)
    } else j = h.contentInput;
    j.value = h.content;
    j.setAttribute("style", "background-color: Transparent; width: " + l + "px; border-width: 0px; padding: 0px");
    return j
  }, M = function (h, l, k) {
    return function (r) {
      var j = r.ganttChartView.ownerDocument, s = j.createElementNS("http://www.w3.org/2000/svg", "g");
      if (!k.isReadOnly && !k.isChartReadOnly && (typeof r.isReadOnly === "undefined" || !r.isReadOnly) && !k.areAssignmentsReadOnly) {
        var q = l.getChartPosition(r.start, k), w = Math.max(l.getChartPosition(r.finish,
          k), q + 4), t = j.createElementNS("http://www.w3.org/2000/svg", "line");
        t.setAttribute("x1", q);
        t.setAttribute("y1", k.barMargin + k.barHeight + 2);
        t.setAttribute("x2", w - 1);
        t.setAttribute("y2", k.barMargin + k.barHeight + 2);
        var x = k.assignmentThumbClass;
        typeof x !== "undefined" && t.setAttribute("class", x);
        t.setAttribute("style", k.assignmentThumbStyle);
        t.style.visibility = "hidden";
        s.appendChild(t);
        j = j.createElementNS("http://www.w3.org/2000/svg", "rect");
        j.setAttribute("x", q);
        j.setAttribute("y", k.barMargin + k.barHeight - 2);
        j.setAttribute("width", Math.max(0, w - q - 1));
        j.setAttribute("height", 7);
        j.setAttribute("style", "fill: White; fill-opacity: 0; cursor: move");
        j.addEventListener("mouseover", function () {
          if (typeof l.draggingItem === "undefined") t.style.visibility = "visible"
        }, true);
        j.addEventListener("mouseout", function () {
          t.style.visibility = "hidden"
        }, true);
        s.appendChild(j);
        E(j, s, r, q, w, h, l, k)
      }
      return s
    }
  }, z = function (h) {
    var l = h.scheduleChartView;
    h.itemTop = h.scheduleChartIndex * settings.itemHeight;
    l.refreshGridItem(h);
    if (typeof h.ganttChartItems !==
      "undefined") for (var k = 0; k < h.ganttChartItems.length; k++) {
      var r = h.ganttChartItems[k];
      r.itemTop = h.itemTop;
      l.refreshChartItem(r)
    }
  }, E = function (h, l, k, r, j, s, q, w) {
    var t = k.ganttChartView.ownerDocument;
    h.addEventListener("mousedown", function (s) {
      if (s.button == 0) {
        delete q.cancelDrag;
        q.draggingItem = k;
        q.dragType = "Assignment";
        q.style.cursor = h.style.cursor;
        q.draggingInitialY = s.clientY;
        q.draggingInitialThumbPosition = w.barMargin;
        s.preventDefault();
        l.itemLeft = r;
        l.itemRight = j;
        k.assignmentThumb = l
      }
    }, true);
    if (typeof q.draggableAssignmentItems ===
      "undefined") q.draggableAssignmentItems = [];
    for (var x = false, y = 0; y < q.draggableAssignmentItems.length; y++) if (q.draggableAssignmentItems[y] == k) {
      x = true;
      break
    }
    if (!x) {
      q.addEventListener("mousemove", function (h) {
        if (!(typeof q.draggingItem === "undefined" || q.draggingItem != k || q.dragType != "Assignment")) {
          var s = Math.ceil((h.clientY - q.draggingInitialY) / w.itemHeight) * w.itemHeight;
          N(h.clientY, q);
          delete q.draggingItem;
          l = k.assignmentThumb;
          r = l.itemLeft;
          j = l.itemRight;
          if (typeof q.temporaryAssignmentThumb !== "undefined") {
            try {
              l.removeChild(q.temporaryAssignmentThumb)
            } catch (x) {
            }
            delete q.temporaryAssignmentThumb
          }
          if (q.cancelDrag) {
            delete q.cancelDrag;
            delete q.draggingItem;
            q.style.cursor = "default"
          } else {
            h = t.createElementNS("http://www.w3.org/2000/svg", "rect");
            h.setAttribute("x", r);
            h.setAttribute("y", q.draggingInitialThumbPosition + s);
            h.setAttribute("width", Math.max(4, j - r - 1));
            h.setAttribute("height", w.barHeight);
            typeof w.temporaryAssignmentThumbClass !== "undefined" && h.setAttribute("class", w.temporaryAssignmentThumbClass);
            h.setAttribute("style", w.temporaryAssignmentThumbStyle);
            q.temporaryAssignmentThumb = h;
            l.appendChild(h);
            q.draggingItem = k
          }
        }
      }, true);
      q.addEventListener("mouseup", function (h) {
        if (!(h.button != 0 || typeof q.draggingItem === "undefined" || q.draggingItem != k || q.dragType != "Assignment")) {
          l = k.assignmentThumb;
          if (typeof q.temporaryAssignmentThumb !== "undefined") {
            try {
              l.removeChild(q.temporaryAssignmentThumb)
            } catch (j) {
            }
            delete q.temporaryAssignmentThumb
          }
          var h = Math.ceil((h.clientY - q.draggingInitialY) / w.itemHeight) * w.itemHeight,
            h = Math.floor((k.itemTop + q.draggingInitialThumbPosition + h) / w.itemHeight), r = null, t = 0, v;
          for (v = 0; v < s.length; v++) {
            var x = s[v];
            if (x.isVisible &&
              !(typeof x.isHidden !== "undefined" && x.isHidden) && typeof x.displayRowIndex === "undefined") {
              if (t == h) {
                r = x;
                break
              }
              t++
            }
          }
          if (r != null) {
            var t = k.scheduleChartItem, x = t.ganttChartItems, y = [];
            for (v = 0; v < x.length; v++) x[v] != k && y.push(x[v]);
            t.ganttChartItems = y;
            q.onItemPropertyChanged(t, "ganttChartItems", false, true);
            if (typeof r.ganttChartItems === "undefined") r.ganttChartItems = [];
            r.ganttChartItems.push(k);
            q.onItemPropertyChanged(r, "ganttChartItems", true, true);
            k.scheduleChartItem = r;
            k.displayRowIndex = h;
            q.refreshChartItem(k);
            R(r, w)
          }
          delete q.draggingItem;
          q.style.cursor = "default"
        }
      }, true);
      q.draggableAssignmentItems.push(k)
    }
  }, N = function (h, l) {
    if (typeof l.draggingItem !== "undefined") {
      h = h - l.offsetTop;
      if (!(h < l.chartHeaderContainer.clientHeight)) {
        var k, r;
        if (h < l.chartHeaderContainer.clientHeight + 24) {
          k = l.chartContentContainer.scrollTop;
          l.chartContentContainer.scrollTop = l.chartContentContainer.scrollTop - 20;
          if (typeof l.isDuringVerticalScrolling === "undefined") {
            l.isDuringVerticalScrolling = true;
            setTimeout(function () {
              r = k - l.chartContentContainer.scrollTop;
              l.draggingInitialThumbPosition = l.draggingInitialThumbPosition - r;
              delete l.isDuringVerticalScrolling
            }, 0)
          }
        } else if (h >= l.chartHeaderContainer.clientHeight + l.chartContentContainer.clientHeight - 24) {
          k = l.chartContentContainer.scrollTop;
          l.chartContentContainer.scrollTop = l.chartContentContainer.scrollTop + 20;
          if (typeof l.isDuringVerticalScrolling === "undefined") {
            l.isDuringVerticalScrolling = true;
            setTimeout(function () {
              r = l.chartContentContainer.scrollTop - k;
              l.draggingInitialThumbPosition = l.draggingInitialThumbPosition +
                r;
              delete l.isDuringVerticalScrolling
            }, 0)
          }
        }
      }
    }
  }, U = function (h, l, k, r) {
    for (var j = 0; j < l.length; j++) l[j].scheduleChartView = h;
    h.scheduleChartItems = k;
    h.settings = r;
    h.refreshScheduleChartItem = z;
    h.initializeAssignmentDraggingThumb = function (j, k, l, r, x) {
      E(j, k, l, r, x, h.items, h, h.settings)
    };
    h.insertScheduleChartItem = function (j, q) {
      var r = j;
      q.scheduleChartView = h;
      q.isVirtuallyVisible = true;
      q.scheduleChartIndex = r;
      q.isBarVisible = false;
      r = r < k.length ? k[r].index : l.length;
      k.splice(q.scheduleChartIndex, 0, q);
      h.insertItem(r++, q);
      if (typeof q.ganttChartItems !== "undefined") for (var t = 0; t < q.ganttChartItems.length; t++) {
        var x = q.ganttChartItems[t];
        x.scheduleChartView = h;
        x.scheduleChartItem = q;
        x.displayRowIndex = q.scheduleChartIndex;
        h.insertItem(r++, x)
      }
      for (r = q.scheduleChartIndex + 1; r < k.length; r++) {
        t = k[r];
        t.scheduleChartIndex = r;
        if (typeof t.ganttChartItems !== "undefined") for (x = 0; x < t.ganttChartItems.length; x++) t.ganttChartItems[x].displayRowIndex = t.scheduleChartIndex;
        z(t)
      }
    };
    h.addScheduleChartItem = function (j) {
      h.insertScheduleChartItem(k.length,
        j)
    };
    h.insertScheduleChartItems = function (j, k) {
      for (var l = 0; l < k.length; l++) h.insertScheduleChartItem(j++, k[l])
    };
    h.addScheduleChartItems = function (j) {
      for (var k = 0; k < j.length; k++) h.addScheduleChartItem(j[k])
    };
    h.removeScheduleChartItem = function (j) {
      if (typeof j.ganttChartItems !== "undefined") for (var l = 0; l < j.ganttChartItems.length; l++) h.removeItem(j.ganttChartItems[l]);
      k.splice(j.scheduleChartIndex, 1);
      for (l = j.scheduleChartIndex; l < k.length; l++) {
        var r = k[l];
        r.scheduleChartIndex = l;
        if (typeof r.ganttChartItems !== "undefined") for (var t =
          0; t < r.ganttChartItems.length; t++) r.ganttChartItems[t].displayRowIndex = r.scheduleChartIndex;
        z(r)
      }
      h.removeItem(j)
    };
    h.removeScheduleChartItems = function (j) {
      for (var k = 0; k < j.length; k++) h.removeScheduleChartItem(j[k])
    };
    h.moveScheduleChartItem = function (j, l) {
      var r = k.indexOf(j);
      if (!(r < 0 || l < 0 || l == r || l >= k.length)) {
        k.splice(r, 1);
        k.splice(l, 0, j);
        L(h);
        typeof h.settings.itemMoveHandler !== "undefined" && h.settings.itemMoveHandler(j, r, l)
      }
    }
  }, oa = function (h, l) {
    h.items = l;
    h.refresh = function () {
      L(h)
    }
  };
  return {
    initialize: I,
    refresh: L,
    getDefaultColumns: T,
    getDefaultScales: DlhSoft.Controls.GanttChartView.getDefaultScales,
    getDefaultStyleDefinitionTemplate: DlhSoft.Controls.GanttChartView.getDefaultStyleDefinitionTemplate,
    getDefaultStandardTaskTemplate: DlhSoft.Controls.GanttChartView.getDefaultStandardTaskTemplate,
    getDefaultMilestoneTaskTemplate: DlhSoft.Controls.GanttChartView.getDefaultMilestoneTaskTemplate,
    getDefaultItemTemplate: DlhSoft.Controls.GanttChartView.getDefaultItemTemplate,
    getDefaultAssignmentsTemplate: DlhSoft.Controls.GanttChartView.getDefaultAssignmentsTemplate,
    initializeTaskDraggingThumbs: DlhSoft.Controls.GanttChartView.initializeTaskDraggingThumbs,
    initializeDependencyDraggingThumb: DlhSoft.Controls.GanttChartView.initializeDependencyDraggingThumb,
    initializeAssignmentDraggingThumb: function (h, l, k, r, j) {
      k.scheduleChartView.initializeAssignmentDraggingThumb(h, l, k, r, j)
    },
    getWorkingTime: DlhSoft.Controls.GanttChartView.getWorkingTime,
    getEffort: DlhSoft.Controls.GanttChartView.getEffort,
    getFinish: DlhSoft.Controls.GanttChartView.getFinish,
    getStart: DlhSoft.Controls.GanttChartView.getStart,
    getCompletion: DlhSoft.Controls.GanttChartView.getCompletion,
    getCompletedFinish: DlhSoft.Controls.GanttChartView.getCompletedFinish,
    textColumnTemplateBase: DlhSoft.Controls.GanttChartView.textColumnTemplateBase,
    textInputColumnTemplateBase: DlhSoft.Controls.GanttChartView.textInputColumnTemplateBase,
    getOutputDate: DlhSoft.Controls.GanttChartView.getOutputDate,
    getInputDate: DlhSoft.Controls.GanttChartView.getInputDate
  }
}());
void 0 == DlhSoft.Controls.LoadChartView && (DlhSoft.Controls.LoadChartView = function () {
  var I = function (h, l, k, r) {
      var j = ["DlhSoft.Controls", "LoadChartView", "DlhSoft.ProjectData.GanttChart.HTML.Controls", "5", "validate", "Licensing"];
      DlhSoft[j[5]][j[4]](h, j[0], j[1], j[2], j[3], r, k);
      h.isLoadChartInitializing = true;
      for (var r = l, l = [], s = j = 0; s < r.length; s++) {
        var q = r[s];
        if (typeof q.isExported !== "undefined" && q.isExported) l.push(q); else if (!(typeof q.loadChartItem !== "undefined" && q.loadChartItem != q)) {
          q.loadChartIndex = q.scheduleChartIndex =
            j++;
          q.isBarVisible = false;
          l.push(q);
          if (typeof q.ganttChartItems !== "undefined") for (var w = 0; w < q.ganttChartItems.length; w++) {
            var t = q.ganttChartItems[w];
            t.loadChartItem = t.scheduleChartItem = q;
            t.displayRowIndex = q.loadChartIndex;
            l.push(t)
          }
        }
      }
      typeof k !== "object" && (k = {});
      DlhSoft.Controls.GanttChartView.initializeItems(l, k);
      j = k;
      s = l;
      P(j);
      if (typeof j.gridWidth === "undefined") j.gridWidth = "15%";
      if (typeof j.chartWidth === "undefined") j.chartWidth = j.isGridVisible ? "85%" : "100%";
      if (typeof j.columns === "undefined") j.columns =
        T(s, j);
      if (typeof j.normalAllocationBarStyle === "undefined" && j.normalAllocationBarClass == null) switch (j.theme) {
        default:
          j.normalAllocationBarStyle = "fill: Blue; fill-opacity: 0.8; stroke: Blue; stroke-width: 0.65px";
          break;
        case "Aero":
          j.normalAllocationBarStyle = "fill: Blue; stroke: Blue"
      }
      if (typeof j.underAllocationBarStyle === "undefined" && j.underAllocationBarClass == null) switch (j.theme) {
        default:
          j.underAllocationBarStyle = "fill: Blue; fill-opacity: 0.8; stroke: Blue; stroke-width: 0.65px";
          break;
        case "Aero":
          j.underAllocationBarStyle =
            "fill: Blue; stroke: Blue"
      }
      if (typeof j.overAllocationBarStyle === "undefined" && j.overAllocationBarClass == null) switch (j.theme) {
        default:
          j.overAllocationBarStyle = "fill: Red; fill-opacity: 0.8; stroke: Red; stroke-width: 0.65px";
          break;
        case "Aero":
          j.overAllocationBarStyle = "fill: Red; stroke: Red"
      }
      if (typeof j.maxDisplayedUnits === "undefined") j.maxDisplayedUnits = 1.5;
      if (typeof j.allocationTemplate === "undefined") j.allocationTemplate = z(s, h, j);
      j.standardTaskTemplate = j.allocationTemplate;
      j.milestoneTaskTemplate =
        j.allocationTemplate;
      j.areTaskDependenciesVisible = false;
      j.isBaselineVisible = false;
      j.isTaskCompletedEffortVisible = false;
      j.areTaskAssignmentsVisible = false;
      U(h, l, r, k);
      DlhSoft.Controls.GanttChartView.initialize(h, l, k, "DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.");
      oa(h, l);
      h.isLoadChartInitializing = false;
      h.isLoadChartInitialized = true;
      return h
    }, L = function (h) {
      I(h, h.loadChartItems, h.settings, h.license)
    }, P = function (h) {
      if (typeof h.target ===
        "undefined") h.target = "Standard";
      if (typeof h.theme === "undefined") h.theme = "Modern";
      if (typeof h.isGridVisible === "undefined") switch (h.target) {
        default:
          h.isGridVisible = true;
          break;
        case "Phone":
          h.isGridVisible = false
      }
      if (typeof h.isReadOnly === "undefined") h.isReadOnly = true;
      if (typeof h.selectionMode === "undefined") h.selectionMode = "Focus";
      if (typeof h.isVirtualizing === "undefined") h.isVirtualizing = true
    }, T = function (h, l) {
      typeof l !== "object" && (l = {});
      P(l);
      var k = [{header: "", width: 32, isSelection: true}, {
        header: "Resource",
        width: 100
      }];
      k[0].cellTemplate = ka(l, k[0], h);
      k[1].cellTemplate = R(l, k[1]);
      k[1].exportCellTemplate = R(l, k[1], false);
      l.selectionMode != "Single" && (l.selectionMode != "Extended" && l.selectionMode != "ExtendedFocus") && k.splice(0, 1);
      return k
    }, ka = function (h, l) {
      return function (h) {
        return !l.isReadOnly ? ca(h) : getBooleanNode(h.ganttChartView.ownerDocument, h.isSelected)
      }
    }, ca = function (h) {
      var l = h.ganttChartView.ownerDocument, k;
      if (typeof h.selectionInput === "undefined") {
        k = l.createElement("input");
        h.selectionInput = k;
        k.type = "checkbox";
        k.setAttribute("style", "margin: 0px")
      } else k = h.selectionInput;
      if (h.isSelected) k.setAttribute("checked", true); else if (k.checked) k.checked = false;
      var r = function () {
        k.checked ? V(h) : typeof h.loadChartView !== "undefined" && h.loadChartView.unselectItem(h)
      };
      typeof k.changeEventListener !== "undefined" && k.removeEventListener("change", k.changeEventListener, true);
      k.addEventListener("change", r, true);
      k.changeEventListener = r;
      l = function (h) {
        if (h.keyCode == 13) {
          h.preventDefault();
          h.stopPropagation();
          r(h)
        }
      };
      typeof k.keyPressEventListener !==
      "undefined" && k.removeEventListener("keypress", k.keyPressEventListener, true);
      k.addEventListener("keypress", l, true);
      k.keyPressEventListener = l;
      return k
    }, V = function (h) {
      typeof h.loadChartView !== "undefined" && h.loadChartView.selectItem(h)
    }, R = function (h, l, k) {
      var r = function (h) {
        var k = h.content, h = h.ganttChartView.ownerDocument.createElement("span");
        h.innerHTML = k;
        return h
      };
      return (typeof k === "undefined" || k) && !h.isReadOnly && !h.isGridReadOnly && !h.isContentReadOnly ? function (j) {
        return !l.isReadOnly && (typeof j.isReadOnly ===
          "undefined" || !j.isReadOnly) ? H(j, Math.max(0, l.width - 2), h) : r(j)
      } : r
    }, H = function (h, l, k) {
      var r = h.ganttChartView.ownerDocument, j;
      if (typeof h.contentInput === "undefined") {
        j = r.createElement("input");
        h.contentInput = j;
        j.type = "text";
        j.addEventListener("focus", function () {
          if (typeof h.loadChartView != null) h.loadChartView.currentItem = h;
          (k.selectionMode == "Focus" || k.selectionMode == "ExtendedFocus") && !h.isSelected && V(h)
        }, false);
        var s = function () {
          h.content = j.value;
          h.loadChartView.onItemPropertyChanged(h, "content", true,
            true);
          h.loadChartView.refreshItem(h)
        };
        typeof j.changeEventListener !== "undefined" && j.removeEventListener("change", j.changeEventListener, true);
        j.addEventListener("change", s, true);
        j.changeEventListener = s;
        r = function (h) {
          if (h.keyCode == 13) {
            h.preventDefault();
            h.stopPropagation();
            s(h)
          }
        };
        typeof j.keyPressEventListener !== "undefined" && j.removeEventListener("keypress", j.keyPressEventListener, true);
        j.addEventListener("keypress", r, true);
        j.keyPressEventListener = r;
        j.addEventListener("focus", function () {
          j.style.backgroundColor =
            "White"
        }, false);
        j.addEventListener("blur", function () {
          j.style.backgroundColor = "Transparent"
        }, false)
      } else j = h.contentInput;
      j.value = h.content;
      j.setAttribute("style", "background-color: Transparent; width: " + l + "px; border-width: 0px; padding: 0px");
      return j
    }, S = function (h) {
      for (var l = 0, k = 0; k < h.length; k++) l = l + h[k].width;
      return l
    }, M = function (h) {
      var l = h.loadChartView;
      l.refreshGridItem(h);
      if (typeof h.ganttChartItems !== "undefined") for (var k = 0; k < h.ganttChartItems.length; k++) l.refreshChartItem(h.ganttChartItems[k])
    },
    z = function (h, l, k) {
      return function (h) {
        var j = l.ownerDocument, s;
        s = l.ownerDocument;
        if (typeof h.chartItemArea === "undefined") h.chartItemArea = s.createElementNS("http://www.w3.org/2000/svg", "g");
        for (s = h.chartItemArea.childNodes.length; s-- > 0;) h.chartItemArea.removeChild(h.chartItemArea.childNodes[s]);
        s = h.chartItemArea;
        var q = l.getChartPosition(h.start, k), w = Math.max(l.getChartPosition(h.finish, k), q + 4),
          j = j.createElementNS("http://www.w3.org/2000/svg", "rect"), t = typeof h.units !== "undefined" ? h.units : 1,
          x = Math.min(t,
            k.maxDisplayedUnits) / k.maxDisplayedUnits * k.barHeight;
        j.setAttribute("x", q);
        j.setAttribute("y", k.barMargin + (k.barHeight - x));
        j.setAttribute("width", Math.max(0, w - q - 1));
        j.setAttribute("height", x);
        q = t == 1 ? k.normalAllocationBarClass : t < 1 ? k.underAllocationBarClass : k.overAllocationBarClass;
        if (typeof h.allocationBarClass !== "undefined") q = h.allocationBarClass;
        if (typeof q !== "undefined") j.setAttribute("class", q); else {
          q = t == 1 ? k.normalAllocationBarStyle : t < 1 ? k.underAllocationBarStyle : k.overAllocationBarStyle;
          if (typeof h.allocationBarStyle !==
            "undefined") q = h.allocationBarStyle;
          typeof q !== "undefined" && j.setAttribute("style", q)
        }
        s.appendChild(j);
        return s
      }
    }, E = function (h, l) {
      for (var k in l) k.indexOf("custom") != 0 && k.indexOf("description") != 0 || typeof h[k] === "undefined" && (h[k] = l[k])
    }, N = function (h, l, k, r, j, s, q, w, t, x, y, z, H, L, M, v) {
      var G, N = [], Q;
      if (typeof r !== "undefined") for (G = 0; G < r.length; G++) {
        Q = v.columns[r[G]];
        N.push({
          header: Q.header,
          width: Q.width,
          headerClass: Q.headerClass,
          headerStyle: Q.headerStyle,
          cellClass: Q.cellClass,
          cellStyle: Q.cellStyle,
          cellTemplate: typeof Q.exportCellTemplate !==
          "undefined" ? Q.exportCellTemplate : Q.cellTemplate
        })
      } else for (G = 0; G < v.columns.length; G++) {
        Q = v.columns[G];
        Q.isSelection || N.push({
          header: Q.header,
          width: Q.width,
          headerClass: Q.headerClass,
          headerStyle: Q.headerStyle,
          cellClass: Q.cellClass,
          cellStyle: Q.cellStyle,
          cellTemplate: typeof Q.exportCellTemplate !== "undefined" ? Q.exportCellTemplate : Q.cellTemplate
        })
      }
      if (typeof k === "undefined") k = v.isGridVisible;
      G = k ? S(N) + 1 : 0;
      if (typeof j !== "undefined") {
        if (typeof q === "undefined" || !q) j = new Date(j.valueOf() - j.getTimezoneOffset() *
          6E4)
      } else j = v.timelineStart;
      if (typeof s !== "undefined") {
        if (typeof q === "undefined" || !q) s = new Date(s.valueOf() - s.getTimezoneOffset() * 6E4)
      } else s = v.timelineFinish;
      j = {
        isExport: true,
        isReadOnly: true,
        selectionMode: "None",
        isVirtualizing: false,
        isGridVisible: k,
        isSplitterEnabled: false,
        gridWidth: G + "px",
        columns: N,
        allowUserToResizeColumns: false,
        isGridRowClickTimeScrollingEnabled: false,
        isMouseWheelZoomEnabled: false,
        timelineStart: j,
        timelineFinish: s,
        hourWidth: typeof w !== "undefined" ? w : v.hourWidth,
        displayedTime: typeof j !==
        "undefined" ? j : v.timelineStart,
        currentTime: v.currentTime,
        isTaskToolTipVisible: false,
        isDependencyToolTipVisible: false,
        areTaskDependenciesVisible: false,
        isBaselineVisible: false,
        isTaskCompletedEffortVisible: false,
        areTaskAssignmentsVisible: false,
        containerClass: v.containerClass,
        containerStyle: v.containerStyle,
        border: v.border,
        theme: v.theme,
        headerBackground: v.headerBackground,
        headerHeight: v.headerHeight,
        itemHeight: v.itemHeight,
        itemClass: v.itemClass,
        itemStyle: v.itemStyle,
        scales: [],
        visibleWeekStart: v.visibleWeekStart,
        visibleWeekFinish: v.visibleWeekFinish,
        workingWeekStart: v.workingWeekStart,
        workingWeekFinish: v.workingWeekFinish,
        visibleDayStart: v.visibleDayStart,
        visibleDayFinish: v.visibleDayFinish,
        specialNonworkingDays: v.specialNonworkingDays,
        barMargin: v.barMargin,
        barHeight: v.barHeight,
        normalAllocationBarClass: v.normalAllocationBarClass,
        underAllocationBarClass: v.underAllocationBarClass,
        overAllocationBarClass: v.overAllocationBarClass,
        normalAllocationBarStyle: v.normalAllocationBarStyle,
        underAllocationBarStyle: v.underAllocationBarStyle,
        overAllocationBarStyle: v.overAllocationBarStyle,
        alternativeItemClass: v.alternativeItemClass,
        alternativeChartItemClass: v.alternativeChartItemClass,
        alternativeItemStyle: v.alternativeItemStyle,
        alternativeChartItemStyle: v.alternativeChartItemStyle,
        target: v.target,
        months: v.months,
        daysOfWeek: v.daysOfWeek,
        weekStartDay: v.weekStartDay,
        dateFormatter: v.dateFormatter,
        dateTimeFormatter: v.dateTimeFormatter,
        isRelativeToTimezone: v.isRelativeToTimezone
      };
      j.timelineStart = DlhSoft.Controls.GanttChartView.getWeekStart(j.timelineStart,
        j.weekStartDay);
      j.timelineFinish = DlhSoft.Controls.GanttChartView.getWeekFinish(j.timelineFinish, j.weekStartDay);
      L = L.getChartPosition(j.timelineFinish, j);
      j.chartWidth = L + "px";
      var R = G + L + 2 + (k ? 1 : 0);
      for (G = 0; G < v.scales.length; G++) {
        k = v.scales[G];
        j.scales.push({
          scaleType: k.scaleType,
          isHeaderVisible: k.isHeaderVisible,
          headerHeight: k.headerHeight,
          headerTextFormat: k.headerTextFormat,
          headerClass: k.headerClass,
          headerStyle: k.headerStyle,
          isHighlightingVisible: k.isHighlightingVisible,
          highlightingClass: k.highlightingClass,
          highlightingStyle: k.highlightingStyle,
          isSeparatorVisible: k.isSeparatorVisible,
          separatorClass: k.separatorClass,
          separatorStyle: k.separatorStyle
        })
      }
      var I, P, U = false;
      if (y != null && typeof y.createElement !== "undefined") I = y; else {
        if (y != null && typeof y.focus !== "undefined") P = y; else {
          P = window.open("", y != null ? y : "_blank", typeof z !== "undefined" && z && (typeof H === "undefined" || H) ? "width=320,height=100,location=no,menubar=no,toolbar=no,status=no,scrollbars=yes" : "");
          U = true
        }
        I = P.document
      }
      I.title = typeof h !== "undefined" ? h : "Exported chart" +
        (typeof z !== "undefined" && z ? " (printable)" : "");
      typeof t === "undefined" && (t = 0);
      typeof x === "undefined" && (x = M.length - 1);
      h = [];
      for (G = k = 0; G < M.length; G++) {
        y = M[G];
        if (!(typeof y.displayRowIndex !== "undefined" && (y.displayRowIndex < t || y.displayRowIndex > x) || typeof y.displayRowIndex === "undefined" && (k++ < t || k > x + 1))) {
          v = {
            content: y.content,
            start: y.start,
            finish: y.finish,
            units: y.units,
            isBarVisible: y.isBarVisible,
            isRelativeToTimezone: y.isRelativeToTimezone,
            "class": y["class"],
            style: y.style,
            barClass: y.barClass,
            barStyle: y.barStyle,
            isSummaryEnabled: y.isSummaryEnabled,
            isParentSummarizationEnabled: y.isParentSummarizationEnabled,
            isHidden: y.isHidden,
            isExported: true,
            tag: y
          };
          if (typeof y.displayRowIndex !== "undefined") v.displayRowIndex = y.displayRowIndex - t;
          E(v, y);
          h.push(v);
          y.exportItem = v
        }
      }
      var V = I.createElement("p");
      V.innerHTML = typeof l !== "undefined" ? l : "";
      I.body.appendChild(V);
      var T = I.createElement("div");
      T.setAttribute("style", "width: " + R + "px");
      try {
        DlhSoft.Controls.LoadChartView.initialize(T, h, j, "DlhSoft.Controls: DlhSoft internal usage only. Customers may purchase standard product usage licenses from http://DlhSoft.com/Purchase.")
      } catch (ca) {
      }
      setTimeout(function () {
        U &&
        I.body.setAttribute("style", "margin: 0px");
        var h = I.createElement("div");
        h.appendChild(T);
        I.body.replaceChild(h, V);
        if (rotate) {
          h.setAttribute("style", "width: " + T.offsetHeight + "px; height: " + R + "px; overflow: hidden");
          h = Math.round((T.offsetWidth - T.offsetHeight) / 2);
          T.setAttribute("style", "width: " + R + "px; transform: rotate(90deg) translateX(" + h + "px) translateY(" + h + "px); -webkit-transform: rotate(90deg) translateX(" + h + "px) translateY(" + h + "px)")
        }
        I.close();
        if (typeof P !== void 0) {
          P.focus();
          if (typeof z !== "undefined" &&
            z) {
            P.print();
            (typeof H === "undefined" || H) && P.close()
          }
        }
      }, 0)
    }, U = function (h, l, k, r) {
      for (var j = 0; j < l.length; j++) l[j].loadChartView = l[j].scheduleChartView = h;
      h.loadChartItems = h.scheduleChartItems = k;
      h.settings = r;
      h.refreshLoadChartItem = M;
      h.insertLoadChartItem = function (j, q) {
        var r = j;
        q.loadChartView = q.scheduleChartView = h;
        q.isVirtuallyVisible = true;
        q.loadChartIndex = q.scheduleChartIndex = r;
        q.isBarVisible = false;
        r = r < k.length ? k[r].index : l.length;
        k.splice(q.loadChartIndex, 0, q);
        h.insertItem(r++, q);
        if (typeof q.ganttChartItems !==
          "undefined") for (var t = 0; t < q.ganttChartItems.length; t++) {
          var x = q.ganttChartItems[t];
          x.loadChartView = x.scheduleChartView = h;
          x.loadChartItem = x.scheduleChartItem = q;
          x.displayRowIndex = q.loadChartIndex;
          h.insertItem(r++, x)
        }
        for (r = q.loadChartIndex + 1; r < k.length; r++) {
          t = k[r];
          t.loadChartIndex = t.scheduleChartIndex = r;
          if (typeof t.ganttChartItems !== "undefined") for (x = 0; x < t.ganttChartItems.length; x++) t.ganttChartItems[x].displayRowIndex = t.loadChartIndex;
          M(t)
        }
      };
      h.addLoadChartItem = function (j) {
        h.insertLoadChartItem(k.length,
          j)
      };
      h.insertLoadChartItems = function (j, k) {
        for (var l = 0; l < k.length; l++) h.insertLoadChartItem(j++, k[l])
      };
      h.addLoadChartItems = function (j) {
        for (var k = 0; k < j.length; k++) h.addLoadChartItem(j[k])
      };
      h.removeLoadChartItem = function (j) {
        if (typeof j.ganttChartItems !== "undefined") for (var l = 0; l < j.ganttChartItems.length; l++) h.removeItem(j.ganttChartItems[l]);
        h.removeItem(j);
        k.splice(j.loadChartIndex, 1);
        for (j = j.loadChartIndex; j < k.length; j++) {
          l = k[j];
          l.loadChartIndex = l.scheduleChartIndex = j;
          if (typeof l.ganttChartItems !==
            "undefined") for (var r = 0; r < l.ganttChartItems.length; r++) l.ganttChartItems[r].displayRowIndex = l.loadChartIndex;
          M(l)
        }
      };
      h.removeLoadChartItems = function (j) {
        for (var k = 0; k < j.length; k++) h.removeLoadChartItem(j[k])
      };
      h.moveLoadChartItem = function (j, l) {
        var r = k.indexOf(j);
        if (!(r < 0 || l < 0 || l == r || l >= k.length)) {
          k.splice(r, 1);
          k.splice(l, 0, j);
          L(h);
          typeof h.settings.itemMoveHandler !== "undefined" && h.settings.itemMoveHandler(j, r, l)
        }
      };
      h.exportContent = function (j, k) {
        typeof j === "undefined" && (j = {});
        N(j.title, j.preparingMessage,
          j.isGridVisible, j.columnIndexes, j.timelineStart, j.timelineFinish, j.isRelativeToTimezone, j.hourWidth, j.startRowIndex, j.endRowIndex, k, false, j.rotate, false, h, l, r)
      };
      h.print = function (j) {
        typeof j === "undefined" && (j = {});
        N(j.title, j.preparingMessage, j.isGridVisible, j.columnIndexes, j.timelineStart, j.timelineFinish, j.isRelativeToTimezone, j.hourWidth, j.startRowIndex, j.endRowIndex, null, true, j.rotate, j.autoClose, h, l, r)
      }
    }, oa = function (h, l) {
      h.items = l;
      h.refresh = function () {
        L(h)
      }
    };
  return {
    initialize: I,
    refresh: L,
    getDefaultColumns: T,
    getDefaultScales: DlhSoft.Controls.GanttChartView.getDefaultScales,
    getdefaultAllocationtemplate: z,
    getDefaultItemTemplate: DlhSoft.Controls.GanttChartView.getDefaultItemTemplate,
    getWorkingTime: DlhSoft.Controls.GanttChartView.getWorkingTime,
    textColumnTemplateBase: DlhSoft.Controls.GanttChartView.textColumnTemplateBase,
    textInputColumnTemplateBase: DlhSoft.Controls.GanttChartView.textInputColumnTemplateBase,
    getOutputDate: DlhSoft.Controls.GanttChartView.getOutputDate,
    getInputDate: DlhSoft.Controls.GanttChartView.getInputDate
  }
}());
